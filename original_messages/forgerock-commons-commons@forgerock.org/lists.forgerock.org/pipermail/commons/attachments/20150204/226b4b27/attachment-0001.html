<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;XHTML&nbsp;1.1//EN&quot;<br>
&quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;&gt;<br>
&lt;html&nbsp;xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;<br>
&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;/&gt;<br>
&lt;title&gt;[2898]&nbsp;forgerock-http-framework/trunk:&nbsp;Initial&nbsp;commit&nbsp;of&nbsp;commons&nbsp;HTTP&nbsp;framework&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
<br>
&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--<br>
#msg&nbsp;dl.meta&nbsp;{&nbsp;border:&nbsp;1px&nbsp;#006&nbsp;solid;&nbsp;background:&nbsp;#369;&nbsp;padding:&nbsp;6px;&nbsp;color:&nbsp;#fff;&nbsp;}<br>
#msg&nbsp;dl.meta&nbsp;dt&nbsp;{&nbsp;float:&nbsp;left;&nbsp;width:&nbsp;6em;&nbsp;font-weight:&nbsp;bold;&nbsp;}<br>
#msg&nbsp;dt:after&nbsp;{&nbsp;content:':';}<br>
#msg&nbsp;dl,&nbsp;#msg&nbsp;dt,&nbsp;#msg&nbsp;ul,&nbsp;#msg&nbsp;li,&nbsp;#header,&nbsp;#footer,&nbsp;#logmsg&nbsp;{&nbsp;font-family:&nbsp;verdana,arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;10pt;&nbsp;&nbsp;}<br>
#msg&nbsp;dl&nbsp;a&nbsp;{&nbsp;font-weight:&nbsp;bold}<br>
#msg&nbsp;dl&nbsp;a:link&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;color:#fc3;&nbsp;}<br>
#msg&nbsp;dl&nbsp;a:active&nbsp;&nbsp;{&nbsp;color:#ff0;&nbsp;}<br>
#msg&nbsp;dl&nbsp;a:visited&nbsp;{&nbsp;color:#cc6;&nbsp;}<br>
h3&nbsp;{&nbsp;font-family:&nbsp;verdana,arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;10pt;&nbsp;font-weight:&nbsp;bold;&nbsp;}<br>
#msg&nbsp;pre&nbsp;{&nbsp;overflow:&nbsp;auto;&nbsp;background:&nbsp;#ffc;&nbsp;border:&nbsp;1px&nbsp;#fa0&nbsp;solid;&nbsp;padding:&nbsp;6px;&nbsp;}<br>
#logmsg&nbsp;{&nbsp;background:&nbsp;#ffc;&nbsp;border:&nbsp;1px&nbsp;#fa0&nbsp;solid;&nbsp;padding:&nbsp;1em&nbsp;1em&nbsp;0&nbsp;1em;&nbsp;}<br>
#logmsg&nbsp;p,&nbsp;#logmsg&nbsp;pre,&nbsp;#logmsg&nbsp;blockquote&nbsp;{&nbsp;margin:&nbsp;0&nbsp;0&nbsp;1em&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;p,&nbsp;#logmsg&nbsp;li,&nbsp;#logmsg&nbsp;dt,&nbsp;#logmsg&nbsp;dd&nbsp;{&nbsp;line-height:&nbsp;14pt;&nbsp;}<br>
#logmsg&nbsp;h1,&nbsp;#logmsg&nbsp;h2,&nbsp;#logmsg&nbsp;h3,&nbsp;#logmsg&nbsp;h4,&nbsp;#logmsg&nbsp;h5,&nbsp;#logmsg&nbsp;h6&nbsp;{&nbsp;margin:&nbsp;.5em&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;h1:first-child,&nbsp;#logmsg&nbsp;h2:first-child,&nbsp;#logmsg&nbsp;h3:first-child,&nbsp;#logmsg&nbsp;h4:first-child,&nbsp;#logmsg&nbsp;h5:first-child,&nbsp;#logmsg&nbsp;h6:first-child&nbsp;{&nbsp;margin-top:&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;ul,&nbsp;#logmsg&nbsp;ol&nbsp;{&nbsp;padding:&nbsp;0;&nbsp;list-style-position:&nbsp;inside;&nbsp;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;1em;&nbsp;}<br>
#logmsg&nbsp;ul&nbsp;{&nbsp;text-indent:&nbsp;-1em;&nbsp;padding-left:&nbsp;1em;&nbsp;}#logmsg&nbsp;ol&nbsp;{&nbsp;text-indent:&nbsp;-1.5em;&nbsp;padding-left:&nbsp;1.5em;&nbsp;}<br>
#logmsg&nbsp;&gt;&nbsp;ul,&nbsp;#logmsg&nbsp;&gt;&nbsp;ol&nbsp;{&nbsp;margin:&nbsp;0&nbsp;0&nbsp;1em&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;pre&nbsp;{&nbsp;background:&nbsp;#eee;&nbsp;padding:&nbsp;1em;&nbsp;}<br>
#logmsg&nbsp;blockquote&nbsp;{&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;#fa0;&nbsp;border-left-width:&nbsp;10px;&nbsp;padding:&nbsp;1em&nbsp;1em&nbsp;0&nbsp;1em;&nbsp;background:&nbsp;white;}<br>
#logmsg&nbsp;dl&nbsp;{&nbsp;margin:&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;dt&nbsp;{&nbsp;font-weight:&nbsp;bold;&nbsp;}<br>
#logmsg&nbsp;dd&nbsp;{&nbsp;margin:&nbsp;0;&nbsp;padding:&nbsp;0&nbsp;0&nbsp;0.5em&nbsp;0;&nbsp;}<br>
#logmsg&nbsp;dd:before&nbsp;{&nbsp;content:'\00bb';}<br>
#logmsg&nbsp;table&nbsp;{&nbsp;border-spacing:&nbsp;0px;&nbsp;border-collapse:&nbsp;collapse;&nbsp;border-top:&nbsp;4px&nbsp;solid&nbsp;#fa0;&nbsp;border-bottom:&nbsp;1px&nbsp;solid&nbsp;#fa0;&nbsp;background:&nbsp;#fff;&nbsp;}<br>
#logmsg&nbsp;table&nbsp;th&nbsp;{&nbsp;text-align:&nbsp;left;&nbsp;font-weight:&nbsp;normal;&nbsp;padding:&nbsp;0.2em&nbsp;0.5em;&nbsp;border-top:&nbsp;1px&nbsp;dotted&nbsp;#fa0;&nbsp;}<br>
#logmsg&nbsp;table&nbsp;td&nbsp;{&nbsp;text-align:&nbsp;right;&nbsp;border-top:&nbsp;1px&nbsp;dotted&nbsp;#fa0;&nbsp;padding:&nbsp;0.2em&nbsp;0.5em;&nbsp;}<br>
#logmsg&nbsp;table&nbsp;thead&nbsp;th&nbsp;{&nbsp;text-align:&nbsp;center;&nbsp;border-bottom:&nbsp;1px&nbsp;solid&nbsp;#fa0;&nbsp;}<br>
#logmsg&nbsp;table&nbsp;th.Corner&nbsp;{&nbsp;text-align:&nbsp;left;&nbsp;}<br>
#logmsg&nbsp;hr&nbsp;{&nbsp;border:&nbsp;none&nbsp;0;&nbsp;border-top:&nbsp;2px&nbsp;dashed&nbsp;#fa0;&nbsp;height:&nbsp;1px;&nbsp;}<br>
#header,&nbsp;#footer&nbsp;{&nbsp;color:&nbsp;#fff;&nbsp;background:&nbsp;#636;&nbsp;border:&nbsp;1px&nbsp;#300&nbsp;solid;&nbsp;padding:&nbsp;6px;&nbsp;}<br>
#patch&nbsp;{&nbsp;width:&nbsp;100%;&nbsp;}<br>
#patch&nbsp;h4&nbsp;{font-family:&nbsp;verdana,arial,helvetica,sans-serif;font-size:10pt;padding:8px;background:#369;color:#fff;margin:0;}<br>
#patch&nbsp;.propset&nbsp;h4,&nbsp;#patch&nbsp;.binary&nbsp;h4&nbsp;{margin:0;}<br>
#patch&nbsp;pre&nbsp;{padding:0;line-height:1.2em;margin:0;}<br>
#patch&nbsp;.diff&nbsp;{width:100%;background:#eee;padding:&nbsp;0&nbsp;0&nbsp;10px&nbsp;0;overflow:auto;}<br>
#patch&nbsp;.propset&nbsp;.diff,&nbsp;#patch&nbsp;.binary&nbsp;.diff&nbsp;&nbsp;{padding:10px&nbsp;0;}<br>
#patch&nbsp;span&nbsp;{display:block;padding:0&nbsp;10px;}<br>
#patch&nbsp;.modfile,&nbsp;#patch&nbsp;.addfile,&nbsp;#patch&nbsp;.delfile,&nbsp;#patch&nbsp;.propset,&nbsp;#patch&nbsp;.binary,&nbsp;#patch&nbsp;.copfile&nbsp;{border:1px&nbsp;solid&nbsp;#ccc;margin:10px&nbsp;0;}<br>
#patch&nbsp;ins&nbsp;{background:#dfd;text-decoration:none;display:block;padding:0&nbsp;10px;}<br>
#patch&nbsp;del&nbsp;{background:#fdd;text-decoration:none;display:block;padding:0&nbsp;10px;}<br>
#patch&nbsp;.lines,&nbsp;.info&nbsp;{color:#888;background:#fff;}<br>
--&gt;&lt;/style&gt;<br>
&lt;div&nbsp;id=&quot;msg&quot;&gt;<br>
&lt;dl&nbsp;class=&quot;meta&quot;&gt;<br>
&lt;dt&gt;Revision&lt;/dt&gt;&nbsp;&lt;dd&gt;&lt;a&nbsp;href=&quot;http://sources.forgerock.org/changelog/commons/?cs=2898&quot;&gt;2898&lt;/a&gt;&lt;/dd&gt;<br>
&lt;dt&gt;Author&lt;/dt&gt;&nbsp;&lt;dd&gt;matthew&lt;/dd&gt;<br>
&lt;dt&gt;Date&lt;/dt&gt;&nbsp;&lt;dd&gt;2015-02-04&nbsp;17:48:07&nbsp;+0000&nbsp;(Wed,&nbsp;04&nbsp;Feb&nbsp;2015)&lt;/dd&gt;<br>
&lt;/dl&gt;<br>
<br>
&lt;h3&gt;Log&nbsp;Message&lt;/h3&gt;<br>
&lt;pre&gt;Initial&nbsp;commit&nbsp;of&nbsp;commons&nbsp;HTTP&nbsp;framework&lt;/pre&gt;<br>
<br>
&lt;h3&gt;Added&nbsp;Paths&lt;/h3&gt;<br>
&lt;ul&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcorepomxml&quot;&gt;forgerock-http-framework/trunk/http-core/pom.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Client.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientInfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfo.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientInfoContextjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfoContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientOptionsjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientOptions.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpCookiejava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Cookie.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpEntityjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Entity.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpFilterjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Filter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpFormjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Form.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHandlerjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Handler.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Header.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHeadersjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Headers.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Http.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpApplicationjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplication.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpApplicationExceptionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplicationException.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpContextjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMessagejava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Message.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMessageImpljava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MessageImpl.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMutableUrijava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MutableUri.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpNotFoundExceptionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/NotFoundException.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpRequestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Request.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpRequestCookiesjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/RequestCookies.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpResponsejava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Response.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpResponseExceptionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ResponseException.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Session.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionFilterjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionFilter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionManagerjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionManager.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpURIUtiljava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/URIUtil.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderDecoderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/Decoder.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderDeflateDecoderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/DeflateDecoder.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderGzipDecoderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/GzipDecoder.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderpackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderConnectionHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ConnectionHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentEncodingHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentEncodingHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentLengthHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentLengthHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentTypeHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentTypeHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderCookieHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/CookieHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderGenericHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/GenericHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderHeaderUtiljava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/HeaderUtil.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderLocationHeaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/LocationHeader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderpackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBranchingInputStreamjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingInputStream.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBranchingStreamWrapperjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingStreamWrapper.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBufferjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/Buffer.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioByteArrayBranchingStreamjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/ByteArrayBranchingStream.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioFileBufferjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/FileBuffer.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioIOjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/IO.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioMemoryBufferjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/MemoryBuffer.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioOverflowExceptionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/OverflowException.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioTemporaryBufferjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/TemporaryBuffer.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpiopackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttppackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttproutingUriRouterjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/UriRouter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspiClientImpljava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/ClientImpl.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspiTransportProviderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/TransportProvider.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspipackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilCaseInsensitiveMapjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveMap.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilCaseInsensitiveSetjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveSet.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilIndexedjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Indexed.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilJsonjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Json.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilLoaderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Loader.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilMultiValueMapjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/MultiValueMap.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilSetDecoratorjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/SetDecorator.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilStandardCharsetsjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/StandardCharsets.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilUnmodifiableCollectionjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/UnmodifiableCollection.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilpackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/javadoc/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainjavadocoverviewhtml&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/javadoc/overview.html&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/resources/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/services/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrcmainresourcesMETAINFservicesorgforgerockhttpdecoderDecoder&quot;&gt;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/services/org.forgerock.http.decoder.Decoder&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpEntityTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/EntityTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpFormTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/FormTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpHandlersTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/HandlersTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpRequestTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/RequestTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpResponseTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/ResponseTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderConnectionHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ConnectionHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentEncodingHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentEncodingHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentLengthHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentLengthHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentTypeHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentTypeHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderCookieHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/CookieHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderHeaderUtilTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/HeaderUtilTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderLocationHeaderTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/LocationHeaderTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderStaticProviderjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/StaticProvider.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpioBranchingStreamWrapperTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/BranchingStreamWrapperTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilCaseInsensitiveMapTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveMapTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilCaseInsensitiveSetTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveSetTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilJsonTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/JsonTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilMultiValuedMapTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MultiValuedMapTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilMutableUriTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MutableUriTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilURIUtilTestjava&quot;&gt;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/URIUtilTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-core/src/test/resources/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletpomxml&quot;&gt;forgerock-http-framework/trunk/http-servlet/pom.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletDefaultRouteHandlerjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/DefaultRouteHandler.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletHttpFrameworkServletjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/HttpFrameworkServlet.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServlet2Adapterjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet2Adapter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServlet3Adapterjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet3Adapter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletHttpApplicationjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplication.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletHttpApplicationWrapperjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplicationWrapper.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletSessionjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSession.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletSynchronizerjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSynchronizer.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletVersionAdapterjava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletVersionAdapter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletpackageinfojava&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/package-info.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/resources/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainresourcesMETAINFwebfragmentxml&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/web-fragment.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/webapp/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFglassfishwebxml&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/glassfish-web.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFsunwebxml&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/sun-web.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFwebxml&quot;&gt;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/web.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/webapp/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-servlet/src/webapp/WEB-INF/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttptestpomxml&quot;&gt;forgerock-http-framework/trunk/http-test/pom.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkhttptestsrcmainjavaorgforgerockhttptestHttpTestjava&quot;&gt;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/HttpTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/legal/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunklegalCCBYNCNDtxt&quot;&gt;forgerock-http-framework/trunk/legal/CC-BY-NC-ND.txt&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunklegalCDDLv10txt&quot;&gt;forgerock-http-framework/trunk/legal/CDDLv1.0.txt&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkpomxml&quot;&gt;forgerock-http-framework/trunk/pom.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecorepomxml&quot;&gt;forgerock-http-framework/trunk/resource-core/pom.xml&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreAbstractContextjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/AbstractContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreContextjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/Context.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreResourceNamejava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ResourceName.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreRootContextjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/RootContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreServerContextjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ServerContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingAbstractUriRouterjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/AbstractUriRouter.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouteMatcherjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteMatcher.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouteNotFoundExceptionjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteNotFoundException.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouterContextjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouterContext.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRoutingModejava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RoutingMode.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingUriRoutejava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/UriRoute.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/&lt;/li&gt;<br>
&lt;li&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/&lt;/li&gt;<br>
&lt;li&gt;&lt;a&nbsp;href=&quot;#forgerockhttpframeworktrunkresourcecoresrctestjavaorgforgerockresourcecoreroutingUriRouteTestjava&quot;&gt;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/UriRouteTest.java&lt;/a&gt;&lt;/li&gt;<br>
&lt;/ul&gt;<br>
<br>
&lt;/div&gt;<br>
&lt;div&nbsp;id=&quot;patch&quot;&gt;<br>
&lt;h3&gt;Diff&lt;/h3&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;propset&quot;&gt;&lt;h4&gt;Property&nbsp;changes:&nbsp;forgerock-http-framework/trunk/http-core&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svnignore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:ignore&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcorepomxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/pom.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,72&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;project&nbsp;xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;parent&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-http-framework&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/parent&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;http-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;packaging&amp;gt;bundle&amp;lt;/packaging&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;name&amp;gt;HTTP&nbsp;Core&nbsp;library&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;dependencies&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;resource-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;${project.version}&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.commons&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-util&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;com.fasterxml.jackson.core&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;jackson-databind&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.slf4j&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;slf4j-api&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.assertj&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;assertj-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.mockito&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;mockito-all&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.testng&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;testng&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/dependencies&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;build&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugins&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;extensions&amp;gt;true&amp;lt;/extensions&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugins&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/build&amp;gt;<br>
+&amp;lt;/project&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/pom.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Client.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Client.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Client.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,127&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.Closeable;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.http.spi.ClientImpl;<br>
+import&nbsp;org.forgerock.http.spi.TransportProvider;<br>
+import&nbsp;org.forgerock.http.util.CaseInsensitiveMap;<br>
+import&nbsp;org.forgerock.http.util.Loader;<br>
+import&nbsp;org.forgerock.util.Reject;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;HTTP&nbsp;client&nbsp;for&nbsp;sending&nbsp;requests&nbsp;to&nbsp;remote&nbsp;servers.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Client&nbsp;implements&nbsp;Closeable&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Mapping&nbsp;of&nbsp;supported&nbsp;codings&nbsp;to&nbsp;associated&nbsp;providers.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;TransportProvider&amp;gt;&nbsp;PROVIDERS&nbsp;=&nbsp;Collections<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.unmodifiableMap(new&nbsp;CaseInsensitiveMap&amp;lt;TransportProvider&amp;gt;(Loader.loadMap(String.class,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TransportProvider.class)));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;client&nbsp;implementation.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;ClientImpl&nbsp;impl;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;HTTP&nbsp;client&nbsp;using&nbsp;default&nbsp;client&nbsp;options.&nbsp;The&nbsp;returned<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;client&nbsp;must&nbsp;be&nbsp;closed&nbsp;when&nbsp;it&nbsp;is&nbsp;no&nbsp;longer&nbsp;needed&nbsp;by&nbsp;the&nbsp;application.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HttpApplicationException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;no&nbsp;transport&nbsp;provider&nbsp;could&nbsp;be&nbsp;found.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Client()&nbsp;throws&nbsp;HttpApplicationException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;ClientOptions());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;HTTP&nbsp;client&nbsp;using&nbsp;the&nbsp;provided&nbsp;client&nbsp;options.&nbsp;The&nbsp;returned<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;client&nbsp;must&nbsp;be&nbsp;closed&nbsp;when&nbsp;it&nbsp;is&nbsp;no&nbsp;longer&nbsp;needed&nbsp;by&nbsp;the&nbsp;application.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;options<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;options&nbsp;which&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;configure&nbsp;the&nbsp;client.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HttpApplicationException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;no&nbsp;transport&nbsp;provider&nbsp;could&nbsp;be&nbsp;found,&nbsp;or&nbsp;if&nbsp;the&nbsp;client<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;could&nbsp;not&nbsp;be&nbsp;configured&nbsp;using&nbsp;the&nbsp;provided&nbsp;set&nbsp;of&nbsp;options.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;{@code&nbsp;options}&nbsp;was&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Client(final&nbsp;ClientOptions&nbsp;options)&nbsp;throws&nbsp;HttpApplicationException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reject.ifNull(options);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.impl&nbsp;=&nbsp;getTransportProvider(options.getTransportProvider()).newClientImpl(options);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Completes&nbsp;all&nbsp;pending&nbsp;requests&nbsp;and&nbsp;release&nbsp;resources&nbsp;associated&nbsp;with<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;underlying&nbsp;implementation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;impl.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;a&nbsp;remote&nbsp;server&nbsp;and&nbsp;returns&nbsp;the&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;send.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;HTTP&nbsp;response&nbsp;if&nbsp;the&nbsp;response&nbsp;has&nbsp;a&nbsp;2xx&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ResponseException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;error&nbsp;response&nbsp;if&nbsp;the&nbsp;response&nbsp;did&nbsp;not&nbsp;have&nbsp;a&nbsp;2xx<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;send(final&nbsp;Request&nbsp;request)&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sendAsync(request).getOrThrow();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;InterruptedException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;FIXME:&nbsp;is&nbsp;a&nbsp;408&nbsp;time&nbsp;out&nbsp;the&nbsp;best&nbsp;status&nbsp;code?<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ResponseException(408);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;a&nbsp;remote&nbsp;server&nbsp;and&nbsp;returns&nbsp;a&nbsp;{@code&nbsp;Promise}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;representing&nbsp;the&nbsp;asynchronous&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;send.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;promise&nbsp;representing&nbsp;the&nbsp;pending&nbsp;HTTP&nbsp;response.&nbsp;The&nbsp;promise<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;yield&nbsp;a&nbsp;{@code&nbsp;ResponseException}&nbsp;when&nbsp;a&nbsp;non-2xx&nbsp;HTTP&nbsp;status<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;sendAsync(final&nbsp;Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;impl.sendAsync(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;TransportProvider&nbsp;getTransportProvider(final&nbsp;String&nbsp;name)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;HttpApplicationException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(PROVIDERS.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;HttpApplicationException(&amp;quot;No&nbsp;transport&nbsp;providers&nbsp;found&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(name&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;PROVIDERS.values().iterator().next();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(PROVIDERS.containsKey(name))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;PROVIDERS.get(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;HttpApplicationException(&amp;quot;The&nbsp;transport&nbsp;provider&nbsp;'&amp;quot;&nbsp;+&nbsp;name&nbsp;+&nbsp;&amp;quot;'&nbsp;was&nbsp;not&nbsp;found&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Client.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientInfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfo.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfo.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfo.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,77&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.security.cert.X509Certificate;<br>
+import&nbsp;java.util.List;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;ClientInfo&nbsp;gives&nbsp;easy&nbsp;access&nbsp;to&nbsp;client-related&nbsp;information&nbsp;that&nbsp;are&nbsp;available&nbsp;into&nbsp;the&nbsp;request.<br>
+&nbsp;*&nbsp;Supported&nbsp;data&nbsp;includes:<br>
+&nbsp;*&nbsp;&amp;lt;ul&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Remote&nbsp;IP&nbsp;address&nbsp;or&nbsp;hostname&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Remote&nbsp;port&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Username&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Client&nbsp;provided&nbsp;X509&nbsp;certificates&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;User-Agent&nbsp;information&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;/ul&amp;gt;<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;ClientInfo&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;login&nbsp;of&nbsp;the&nbsp;user&nbsp;making&nbsp;this&nbsp;request&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;not&nbsp;known.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;login&nbsp;of&nbsp;the&nbsp;user&nbsp;making&nbsp;this&nbsp;request&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;not&nbsp;known.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getRemoteUser();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getRemoteAddress();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getRemoteHost();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;source&nbsp;port&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;source&nbsp;port&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;getRemotePort();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;list&nbsp;(possibly&nbsp;empty)&nbsp;of&nbsp;X509&nbsp;certificate(s)&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;no&nbsp;certificates&nbsp;are&nbsp;available,&nbsp;an&nbsp;empty&nbsp;list&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;list&nbsp;(possibly&nbsp;empty)&nbsp;of&nbsp;X509&nbsp;certificate(s)&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;X509Certificate&amp;gt;&nbsp;getCertificates();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;{@literal&nbsp;User-Agent}&nbsp;HTTP&nbsp;Header&nbsp;(if&nbsp;any,&nbsp;returns&nbsp;{@code&nbsp;null}&nbsp;otherwise).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;{@literal&nbsp;User-Agent}&nbsp;HTTP&nbsp;Header&nbsp;(if&nbsp;any,&nbsp;returns&nbsp;{@code&nbsp;null}&nbsp;otherwise).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getUserAgent();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfo.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientInfoContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfoContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfoContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfoContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,187&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;java.util.Arrays.asList;<br>
+<br>
+import&nbsp;java.security.cert.X509Certificate;<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.ServerContext;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;ClientInfo&nbsp;gives&nbsp;easy&nbsp;access&nbsp;to&nbsp;client-related&nbsp;information&nbsp;that&nbsp;are&nbsp;available&nbsp;into&nbsp;the&nbsp;request.<br>
+&nbsp;*&nbsp;Supported&nbsp;data&nbsp;includes:<br>
+&nbsp;*&nbsp;&amp;lt;ul&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Remote&nbsp;IP&nbsp;address&nbsp;or&nbsp;hostname&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Remote&nbsp;port&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Username&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;Client&nbsp;provided&nbsp;X509&nbsp;certificates&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;li&amp;gt;User-Agent&nbsp;information&amp;lt;/li&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;/ul&amp;gt;<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ClientInfoContext&nbsp;extends&nbsp;ServerContext&nbsp;implements&nbsp;ClientInfo&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;remoteUser;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;remoteAddress;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;remoteHost;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;remotePort;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;X509Certificate&amp;gt;&nbsp;certificates;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;userAgent;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ClientInfoContext(Context&nbsp;parent,&nbsp;String&nbsp;remoteUser,&nbsp;String&nbsp;remoteAddress,&nbsp;String&nbsp;remoteHost,&nbsp;int&nbsp;remotePort,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;X509Certificate&amp;gt;&nbsp;certificates,&nbsp;String&nbsp;userAgent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(parent,&nbsp;&amp;quot;clientInfo&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteUser&nbsp;=&nbsp;remoteUser;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteAddress&nbsp;=&nbsp;remoteAddress;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteHost&nbsp;=&nbsp;remoteHost;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remotePort&nbsp;=&nbsp;remotePort;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.certificates&nbsp;=&nbsp;Collections.unmodifiableList(certificates);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.userAgent&nbsp;=&nbsp;userAgent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;static&nbsp;class&nbsp;ClientInfoContextBuilder&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Context&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;remoteUser;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;remoteAddress;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;remoteHost;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;remotePort;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;List&amp;lt;X509Certificate&amp;gt;&nbsp;certificates;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;userAgent;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ClientInfoContextBuilder(Context&nbsp;parent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.parent&nbsp;=&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;remoteUser(String&nbsp;remoteUser)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteUser&nbsp;=&nbsp;remoteUser;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;remoteAddress(String&nbsp;remoteAddress)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteAddress&nbsp;=&nbsp;remoteAddress;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;remoteHost(String&nbsp;remoteHost)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remoteHost&nbsp;=&nbsp;remoteHost;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;remotePort(int&nbsp;remotePort)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remotePort&nbsp;=&nbsp;remotePort;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;certificates(X509Certificate...&nbsp;certificates)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(certificates&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;certificates(asList(certificates));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;certificates(Collections.&amp;lt;X509Certificate&amp;gt;emptyList());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;certificates(List&amp;lt;X509Certificate&amp;gt;&nbsp;certificates)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.certificates&nbsp;=&nbsp;certificates;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContextBuilder&nbsp;userAgent(String&nbsp;userAgent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.userAgent&nbsp;=&nbsp;userAgent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ClientInfoContext&nbsp;build()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ClientInfoContext(parent,&nbsp;remoteUser,&nbsp;remoteAddress,&nbsp;remoteHost,&nbsp;remotePort,&nbsp;certificates,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userAgent);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;{@code&nbsp;ClientInfoContextBuilder}&nbsp;for&nbsp;creating&nbsp;{@code&nbsp;ClientInfoContext}&nbsp;instances.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;builder&nbsp;for&nbsp;a&nbsp;{@code&nbsp;ClientInfoContext}&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ClientInfoContextBuilder&nbsp;builder(Context&nbsp;parent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ClientInfoContextBuilder(parent);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;login&nbsp;of&nbsp;the&nbsp;user&nbsp;making&nbsp;this&nbsp;request&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;not&nbsp;known.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;login&nbsp;of&nbsp;the&nbsp;user&nbsp;making&nbsp;this&nbsp;request&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;not&nbsp;known.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRemoteUser()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remoteUser;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRemoteAddress()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remoteAddress;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRemoteHost()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remoteHost;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;source&nbsp;port&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;source&nbsp;port&nbsp;of&nbsp;the&nbsp;client&nbsp;(or&nbsp;last&nbsp;proxy)&nbsp;that&nbsp;sent&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;getRemotePort()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remotePort;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;list&nbsp;(possibly&nbsp;empty)&nbsp;of&nbsp;X509&nbsp;certificate(s)&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;no&nbsp;certificates&nbsp;are&nbsp;available,&nbsp;an&nbsp;empty&nbsp;list&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;list&nbsp;(possibly&nbsp;empty)&nbsp;of&nbsp;X509&nbsp;certificate(s)&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;X509Certificate&amp;gt;&nbsp;getCertificates()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;certificates;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;{@literal&nbsp;User-Agent}&nbsp;HTTP&nbsp;Header&nbsp;(if&nbsp;any,&nbsp;returns&nbsp;{@code&nbsp;null}&nbsp;otherwise).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;{@literal&nbsp;User-Agent}&nbsp;HTTP&nbsp;Header&nbsp;(if&nbsp;any,&nbsp;returns&nbsp;{@code&nbsp;null}&nbsp;otherwise).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getUserAgent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;userAgent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientInfoContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpClientOptionsjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientOptions.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientOptions.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientOptions.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,27&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Common&nbsp;options&nbsp;for&nbsp;HTTP&nbsp;{@link&nbsp;Client&nbsp;clients}.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;ClientOptions&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getTransportProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ClientOptions.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpCookiejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Cookie.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Cookie.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Cookie.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,475&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Date;<br>
+import&nbsp;java.util.List;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;HTTP&nbsp;cookie.&nbsp;For&nbsp;more&nbsp;information,&nbsp;see&nbsp;the&nbsp;original&nbsp;&amp;lt;a&nbsp;href=<br>
+&nbsp;*&nbsp;&amp;quot;http://web.archive.org/web/20070805052634/http://wp.netscape.com/newsref/std/cookie_spec.html&amp;quot;<br>
+&nbsp;*&nbsp;&amp;gt;&nbsp;Netscape&nbsp;specification&amp;lt;/a&amp;gt;,&nbsp;&amp;lt;a<br>
+&nbsp;*&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2109.txt&amp;quot;&amp;gt;RFC&nbsp;2109&amp;lt;/a&amp;gt;&nbsp;and&nbsp;&amp;lt;a<br>
+&nbsp;*&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2965.txt&amp;quot;&amp;gt;RFC&nbsp;2965&amp;lt;/a&amp;gt;.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;Cookie&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;cookie.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;name;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;cookie.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;value;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;comment;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;URL&nbsp;identifying&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;commentURL;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Directs&nbsp;the&nbsp;user&nbsp;agent&nbsp;to&nbsp;discard&nbsp;the&nbsp;cookie&nbsp;unconditionally&nbsp;when&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;terminates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Boolean&nbsp;discard;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;domain&nbsp;for&nbsp;which&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;domain;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;as&nbsp;the&nbsp;date&nbsp;and&nbsp;time&nbsp;of&nbsp;expiration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Date&nbsp;expires;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Directs&nbsp;the&nbsp;user&nbsp;agent&nbsp;to&nbsp;make&nbsp;the&nbsp;cookie&nbsp;inaccessible&nbsp;to&nbsp;client&nbsp;side<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;script.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Boolean&nbsp;httpOnly;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;in&nbsp;seconds.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Integer&nbsp;maxAge;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;subset&nbsp;of&nbsp;URLs&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie&nbsp;applies.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;path;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Restricts&nbsp;the&nbsp;port(s)&nbsp;to&nbsp;which&nbsp;a&nbsp;cookie&nbsp;may&nbsp;be&nbsp;returned.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;Integer&amp;gt;&nbsp;port&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;Integer&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Directs&nbsp;the&nbsp;user&nbsp;agent&nbsp;to&nbsp;use&nbsp;only&nbsp;secure&nbsp;means&nbsp;to&nbsp;send&nbsp;back&nbsp;this&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Boolean&nbsp;secure;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;version&nbsp;of&nbsp;the&nbsp;state&nbsp;management&nbsp;mechanism&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;conforms.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Integer&nbsp;version;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;uninitialized&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Empty&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;equals(final&nbsp;Object&nbsp;obj)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this&nbsp;==&nbsp;obj)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(obj&nbsp;instanceof&nbsp;Cookie))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;other&nbsp;=&nbsp;(Cookie)&nbsp;obj;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;objectsAreEqual(comment,&nbsp;other.comment)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(commentURL,&nbsp;other.commentURL)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(discard,&nbsp;other.discard)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(domain,&nbsp;other.domain)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(expires,&nbsp;other.expires)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(httpOnly,&nbsp;other.httpOnly)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(maxAge,&nbsp;other.maxAge)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(name,&nbsp;other.name)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(path,&nbsp;other.path)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(port,&nbsp;other.port)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(secure,&nbsp;other.secure)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(value,&nbsp;other.value)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;objectsAreEqual(version,&nbsp;other.version);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getComment()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;comment;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;identifying&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;URL&nbsp;identifying&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getCommentURL()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;commentURL;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;discard&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;unconditionally&nbsp;when&nbsp;it&nbsp;terminates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;discard&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unconditionally&nbsp;when&nbsp;it&nbsp;terminates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Boolean&nbsp;getDiscard()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;discard;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;domain&nbsp;for&nbsp;which&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;domain&nbsp;for&nbsp;which&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getDomain()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;domain;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;as&nbsp;the&nbsp;date&nbsp;and&nbsp;time&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;expiration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;as&nbsp;the&nbsp;date&nbsp;and&nbsp;time&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expiration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Date&nbsp;getExpires()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;expires;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;make&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;inaccessible&nbsp;to&nbsp;client&nbsp;side&nbsp;script.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;make&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inaccessible&nbsp;to&nbsp;client&nbsp;side&nbsp;script.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Boolean&nbsp;getHttpOnly()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;httpOnly;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;in&nbsp;seconds.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;in&nbsp;seconds.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Integer&nbsp;getMaxAge()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;maxAge;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;name&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;subset&nbsp;of&nbsp;URLs&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;applies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;subset&nbsp;of&nbsp;URLs&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getPath()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;path;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;restricted&nbsp;list&nbsp;of&nbsp;port(s)&nbsp;to&nbsp;which&nbsp;a&nbsp;cookie&nbsp;may&nbsp;be&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;restricted&nbsp;list&nbsp;of&nbsp;port(s)&nbsp;to&nbsp;which&nbsp;a&nbsp;cookie&nbsp;may&nbsp;be&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;Integer&amp;gt;&nbsp;getPort()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;port;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;use&nbsp;only&nbsp;secure&nbsp;means&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;send&nbsp;back&nbsp;this&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;use&nbsp;only&nbsp;secure&nbsp;means&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send&nbsp;back&nbsp;this&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Boolean&nbsp;getSecure()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;secure;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getValue()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;version&nbsp;of&nbsp;the&nbsp;state&nbsp;management&nbsp;mechanism&nbsp;to&nbsp;which&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cookie&nbsp;conforms.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;version&nbsp;of&nbsp;the&nbsp;state&nbsp;management&nbsp;mechanism&nbsp;to&nbsp;which&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie&nbsp;conforms.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Integer&nbsp;getVersion()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;version;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;hashCode()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;prime&nbsp;=&nbsp;31;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;result&nbsp;=&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(comment&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;comment.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(commentURL&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;commentURL.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(discard&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;discard.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(domain&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;domain.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(expires&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;expires.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(httpOnly&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;httpOnly.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(maxAge&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;maxAge.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(name&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;name.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(path&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;path.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(port&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;port.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(secure&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;secure.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(value&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;value.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;prime&nbsp;*&nbsp;result&nbsp;+&nbsp;(version&nbsp;==&nbsp;null&nbsp;?&nbsp;0&nbsp;:&nbsp;version.hashCode());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;comment<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setComment(final&nbsp;String&nbsp;comment)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.comment&nbsp;=&nbsp;comment;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;URL&nbsp;identifying&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;commentURL<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;URL&nbsp;identifying&nbsp;the&nbsp;intended&nbsp;use&nbsp;of&nbsp;a&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setCommentURL(final&nbsp;String&nbsp;commentURL)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.commentURL&nbsp;=&nbsp;commentURL;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;value&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;discard&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cookie&nbsp;unconditionally&nbsp;when&nbsp;it&nbsp;terminates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;discard<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;discard&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unconditionally&nbsp;when&nbsp;it&nbsp;terminates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setDiscard(final&nbsp;Boolean&nbsp;discard)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.discard&nbsp;=&nbsp;discard;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;domain&nbsp;for&nbsp;which&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;domain<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;domain&nbsp;for&nbsp;which&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setDomain(final&nbsp;String&nbsp;domain)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.domain&nbsp;=&nbsp;domain;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;as&nbsp;the&nbsp;date&nbsp;and&nbsp;time&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;expiration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;expires<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;as&nbsp;the&nbsp;date&nbsp;and&nbsp;time&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expiration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setExpires(final&nbsp;Date&nbsp;expires)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.expires&nbsp;=&nbsp;expires;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;value&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;make&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;inaccessible&nbsp;to&nbsp;client&nbsp;side&nbsp;script.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;httpOnly<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;make&nbsp;the&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inaccessible&nbsp;to&nbsp;client&nbsp;side&nbsp;script.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setHttpOnly(final&nbsp;Boolean&nbsp;httpOnly)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.httpOnly&nbsp;=&nbsp;httpOnly;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;in&nbsp;seconds.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;maxAge<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;cookie,&nbsp;expressed&nbsp;in&nbsp;seconds.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setMaxAge(final&nbsp;Integer&nbsp;maxAge)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.maxAge&nbsp;=&nbsp;maxAge;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setName(final&nbsp;String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;subset&nbsp;of&nbsp;URLs&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;applies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;subset&nbsp;of&nbsp;URLs&nbsp;on&nbsp;the&nbsp;origin&nbsp;server&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setPath(final&nbsp;String&nbsp;path)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.path&nbsp;=&nbsp;path;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;value&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;use&nbsp;only&nbsp;secure<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;means&nbsp;to&nbsp;send&nbsp;back&nbsp;this&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;secure<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;user&nbsp;agent&nbsp;should&nbsp;use&nbsp;only&nbsp;secure&nbsp;means&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;send&nbsp;back&nbsp;this&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setSecure(final&nbsp;Boolean&nbsp;secure)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.secure&nbsp;=&nbsp;secure;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setValue(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.value&nbsp;=&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;version&nbsp;of&nbsp;the&nbsp;state&nbsp;management&nbsp;mechanism&nbsp;to&nbsp;which&nbsp;this&nbsp;cookie<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;conforms.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;version<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;version&nbsp;of&nbsp;the&nbsp;state&nbsp;management&nbsp;mechanism&nbsp;to&nbsp;which&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie&nbsp;conforms.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;cookie.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Cookie&nbsp;setVersion(final&nbsp;Integer&nbsp;version)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.version&nbsp;=&nbsp;version;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;[&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(name&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;name=&amp;quot;).append(name).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;value=&amp;quot;).append(value).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(comment&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;comment=&amp;quot;).append(comment).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(commentURL&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;commentURL=&amp;quot;).append(commentURL).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(discard&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;discard=&amp;quot;).append(discard).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(domain&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;domain=&amp;quot;).append(domain).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(expires&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;expires=&amp;quot;).append(expires).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpOnly&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;httpOnly=&amp;quot;).append(httpOnly).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(maxAge&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;maxAge=&amp;quot;).append(maxAge).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(path&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;path=&amp;quot;).append(path).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(port&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;port=&amp;quot;).append(port).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(secure&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;secure=&amp;quot;).append(secure).append(&amp;quot;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(version&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;version=&amp;quot;).append(version);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;]&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;builder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;boolean&nbsp;objectsAreEqual(final&nbsp;Object&nbsp;o1,&nbsp;final&nbsp;Object&nbsp;o2)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o1&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;o2&nbsp;==&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;o1.equals(o2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Cookie.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpEntityjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Entity.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Entity.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Entity.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,511&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.util.Json.*;<br>
+import&nbsp;static&nbsp;org.forgerock.util.Utils.*;<br>
+import&nbsp;static&nbsp;org.forgerock.http.util.StandardCharsets.*;<br>
+<br>
+import&nbsp;com.fasterxml.jackson.core.JsonParser;<br>
+import&nbsp;com.fasterxml.jackson.core.JsonToken;<br>
+import&nbsp;com.fasterxml.jackson.core.type.TypeReference;<br>
+import&nbsp;com.fasterxml.jackson.databind.ObjectMapper;<br>
+import&nbsp;org.forgerock.http.header.ContentEncodingHeader;<br>
+import&nbsp;org.forgerock.http.header.ContentLengthHeader;<br>
+import&nbsp;org.forgerock.http.header.ContentTypeHeader;<br>
+import&nbsp;org.forgerock.http.io.BranchingInputStream;<br>
+import&nbsp;org.forgerock.http.io.IO;<br>
+<br>
+import&nbsp;java.io.BufferedReader;<br>
+import&nbsp;java.io.ByteArrayOutputStream;<br>
+import&nbsp;java.io.Closeable;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.io.InputStreamReader;<br>
+import&nbsp;java.io.OutputStream;<br>
+import&nbsp;java.io.Reader;<br>
+import&nbsp;java.io.StringWriter;<br>
+import&nbsp;java.io.UnsupportedEncodingException;<br>
+import&nbsp;java.io.Writer;<br>
+import&nbsp;java.nio.charset.Charset;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.LinkedList;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Message&nbsp;content.&nbsp;An&nbsp;entity&nbsp;wraps&nbsp;a&nbsp;BranchingInputStream&nbsp;and&nbsp;provides&nbsp;various<br>
+&nbsp;*&nbsp;convenience&nbsp;methods&nbsp;for&nbsp;accessing&nbsp;the&nbsp;content,&nbsp;transparently&nbsp;handling&nbsp;content<br>
+&nbsp;*&nbsp;encoding.&nbsp;The&nbsp;underlying&nbsp;input&nbsp;stream&nbsp;can&nbsp;be&nbsp;branched&nbsp;in&nbsp;order&nbsp;to&nbsp;perform<br>
+&nbsp;*&nbsp;repeated&nbsp;reads&nbsp;of&nbsp;the&nbsp;data.&nbsp;This&nbsp;is&nbsp;achieved&nbsp;by&nbsp;either&nbsp;calling<br>
+&nbsp;*&nbsp;{@link&nbsp;#push()},&nbsp;{@link&nbsp;#newDecodedContentReader(Charset)},&nbsp;or<br>
+&nbsp;*&nbsp;{@link&nbsp;#newDecodedContentInputStream()}.&nbsp;The&nbsp;branch&nbsp;can&nbsp;then&nbsp;be&nbsp;closed&nbsp;by<br>
+&nbsp;*&nbsp;calling&nbsp;{@link&nbsp;#pop}&nbsp;on&nbsp;the&nbsp;entity,&nbsp;or&nbsp;{@code&nbsp;close()}&nbsp;on&nbsp;the&nbsp;returned<br>
+&nbsp;*&nbsp;{@link&nbsp;#newDecodedContentReader(Charset)&nbsp;BufferedReader}&nbsp;or<br>
+&nbsp;*&nbsp;{@link&nbsp;#newDecodedContentInputStream()&nbsp;InputStream}.&nbsp;Calling&nbsp;{@link&nbsp;#close}<br>
+&nbsp;*&nbsp;on&nbsp;the&nbsp;entity&nbsp;fully&nbsp;closes&nbsp;the&nbsp;input&nbsp;stream&nbsp;invaliding&nbsp;any&nbsp;branches&nbsp;in&nbsp;the<br>
+&nbsp;*&nbsp;process.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;Several&nbsp;convenience&nbsp;methods&nbsp;are&nbsp;provided&nbsp;for&nbsp;accessing&nbsp;the&nbsp;entity&nbsp;as&nbsp;either<br>
+&nbsp;*&nbsp;{@link&nbsp;#getBytes()&nbsp;byte},&nbsp;{@link&nbsp;#getString()&nbsp;string},&nbsp;or&nbsp;{@link&nbsp;#getJson()<br>
+&nbsp;*&nbsp;JSON}&nbsp;content.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Entity&nbsp;implements&nbsp;Closeable&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Implementation&nbsp;note:&nbsp;this&nbsp;class&nbsp;lazily&nbsp;creates&nbsp;the&nbsp;alternative&nbsp;string&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;json&nbsp;representations.&nbsp;Updates&nbsp;to&nbsp;the&nbsp;json&nbsp;content,&nbsp;string&nbsp;content,&nbsp;bytes,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;or&nbsp;input&nbsp;stream&nbsp;invalidates&nbsp;the&nbsp;other&nbsp;representations&nbsp;accordingly.&nbsp;The<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;setters&nbsp;cascade&nbsp;updates&nbsp;in&nbsp;the&nbsp;following&nbsp;order:&nbsp;setJson()&nbsp;-&amp;gt;&nbsp;setString()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;-&amp;gt;&nbsp;setBytes()&nbsp;-&amp;gt;&nbsp;setRawInputStream().<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;Content-Type&nbsp;used&nbsp;when&nbsp;setting&nbsp;the&nbsp;entity&nbsp;to&nbsp;JSON.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;final&nbsp;String&nbsp;APPLICATION_JSON_CHARSET_UTF_8&nbsp;=&nbsp;&amp;quot;application/json;&nbsp;charset=UTF-8&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;content&nbsp;stream.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;BranchingInputStream&nbsp;EMPTY_STREAM&nbsp;=&nbsp;IO<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.newBranchingInputStream(new&nbsp;byte[0]);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;encapsulating&nbsp;Message&nbsp;which&nbsp;may&nbsp;have&nbsp;content&nbsp;encoding&nbsp;headers.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Message&nbsp;message;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;input&nbsp;stream&nbsp;from&nbsp;which&nbsp;all&nbsp;all&nbsp;branches&nbsp;are&nbsp;created.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;trunk;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;most&nbsp;recently&nbsp;created&nbsp;branch.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;head;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Cached&nbsp;and&nbsp;lazily&nbsp;created&nbsp;JSON&nbsp;representation&nbsp;of&nbsp;the&nbsp;entity.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object&nbsp;json;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Cached&nbsp;and&nbsp;lazily&nbsp;created&nbsp;String&nbsp;representation&nbsp;of&nbsp;the&nbsp;entity.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;string;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Entity(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.message&nbsp;=&nbsp;message;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;entity&nbsp;may&nbsp;contain&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;entity&nbsp;may&nbsp;contain&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;mayContainData()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Used&nbsp;reference&nbsp;equality&nbsp;intentionally&nbsp;(not&nbsp;equalsTo())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trunk&nbsp;!=&nbsp;EMPTY_STREAM;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Mark&nbsp;this&nbsp;entity&nbsp;as&nbsp;being&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setRawContentInputStream(EMPTY_STREAM);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;all&nbsp;resources&nbsp;associated&nbsp;with&nbsp;this&nbsp;entity.&nbsp;Any&nbsp;open&nbsp;streams&nbsp;will<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;be&nbsp;closed,&nbsp;and&nbsp;the&nbsp;underlying&nbsp;content&nbsp;reset&nbsp;back&nbsp;to&nbsp;a&nbsp;zero&nbsp;length.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Copies&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;writer.&nbsp;After<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;method&nbsp;returns&nbsp;it&nbsp;will&nbsp;no&nbsp;longer&nbsp;be&nbsp;possible&nbsp;to&nbsp;read&nbsp;data&nbsp;from&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity.&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;push&nbsp;or&nbsp;pop&nbsp;branches.&nbsp;It&nbsp;does,&nbsp;however,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;decode&nbsp;the&nbsp;content&nbsp;according&nbsp;to&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header&nbsp;if&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;destination&nbsp;writer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;copying&nbsp;the&nbsp;decoded&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;copyDecodedContentTo(final&nbsp;OutputStream&nbsp;out)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IO.stream(getDecodedInputStream(head),&nbsp;out);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.flush();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Copies&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;writer.&nbsp;After<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;method&nbsp;returns&nbsp;it&nbsp;will&nbsp;no&nbsp;longer&nbsp;be&nbsp;possible&nbsp;to&nbsp;read&nbsp;data&nbsp;from&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity.&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;push&nbsp;or&nbsp;pop&nbsp;branches.&nbsp;It&nbsp;does,&nbsp;however,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;decode&nbsp;the&nbsp;content&nbsp;according&nbsp;to&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;Content-Type}&nbsp;headers&nbsp;if&nbsp;they&nbsp;are&nbsp;present&nbsp;in&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;destination&nbsp;writer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;copying&nbsp;the&nbsp;decoded&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;copyDecodedContentTo(final&nbsp;Writer&nbsp;out)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IO.stream(getBufferedReader(head,&nbsp;null),&nbsp;out);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.flush();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Copies&nbsp;the&nbsp;raw&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;output&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;After&nbsp;the&nbsp;method&nbsp;returns&nbsp;it&nbsp;will&nbsp;no&nbsp;longer&nbsp;be&nbsp;possible&nbsp;to&nbsp;read&nbsp;data&nbsp;from<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;entity.&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;push&nbsp;or&nbsp;pop&nbsp;branches&nbsp;nor&nbsp;does&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;perform&nbsp;any&nbsp;decoding&nbsp;of&nbsp;the&nbsp;raw&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;destination&nbsp;output&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;copying&nbsp;the&nbsp;raw&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;copyRawContentTo(final&nbsp;OutputStream&nbsp;out)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IO.stream(head,&nbsp;out);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.flush();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;byte&nbsp;array&nbsp;containing&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity.&nbsp;Calling&nbsp;this&nbsp;method&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;underlying<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;input&nbsp;stream.&nbsp;Subsequent&nbsp;changes&nbsp;to&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;will&nbsp;not<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;be&nbsp;reflected&nbsp;in&nbsp;the&nbsp;returned&nbsp;byte&nbsp;array,&nbsp;nor&nbsp;will&nbsp;changes&nbsp;in&nbsp;the&nbsp;returned<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;byte&nbsp;array&nbsp;be&nbsp;reflected&nbsp;in&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;byte&nbsp;array&nbsp;containing&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity&nbsp;(never&nbsp;{@code&nbsp;null}).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;reading&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;byte[]&nbsp;getBytes()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ByteArrayOutputStream&nbsp;bytes&nbsp;=&nbsp;new&nbsp;ByteArrayOutputStream();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyDecodedContentTo(bytes);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;bytes.toByteArray();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;JSON&nbsp;object.&nbsp;Calling&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;underlying&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Subsequent&nbsp;changes&nbsp;to&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;will&nbsp;not&nbsp;be&nbsp;reflected&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;returned&nbsp;JSON&nbsp;object,&nbsp;nor&nbsp;will&nbsp;changes&nbsp;in&nbsp;the&nbsp;returned&nbsp;JSON&nbsp;object&nbsp;be<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;reflected&nbsp;in&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;JSON&nbsp;object,&nbsp;which&nbsp;will<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;{@code&nbsp;null}&nbsp;only&nbsp;if&nbsp;the&nbsp;content&nbsp;represents&nbsp;the&nbsp;JSON<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null}&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;reading&nbsp;the&nbsp;content&nbsp;or&nbsp;if&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSON&nbsp;is&nbsp;malformed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object&nbsp;getJson()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(json&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;BufferedReader&nbsp;reader&nbsp;=&nbsp;newDecodedContentReader(UTF_8);&nbsp;//&nbsp;RFC&nbsp;7159<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json&nbsp;=&nbsp;readJson(reader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;&amp;lt;T&amp;gt;&nbsp;T&nbsp;parse(ObjectMapper&nbsp;mapper,&nbsp;Reader&nbsp;reader)&nbsp;throws&nbsp;IOException&nbsp;{&nbsp;//TODO&nbsp;move&nbsp;JsonValueUtil/Json&nbsp;in&nbsp;to&nbsp;http-core&nbsp;util&nbsp;and&nbsp;use&nbsp;that<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reader&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;JsonParser&nbsp;jp&nbsp;=&nbsp;mapper.getFactory().createParser(reader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;JsonToken&nbsp;jToken&nbsp;=&nbsp;jp.nextToken();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jToken&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(jToken)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;START_ARRAY:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;LinkedList&amp;lt;?&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;START_OBJECT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;LinkedHashMap&amp;lt;String,&nbsp;?&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_FALSE:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_TRUE:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Boolean&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NUMBER_INT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Integer&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NUMBER_FLOAT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Float&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NULL:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;is&nbsp;very&nbsp;unlikely&nbsp;to&nbsp;happen.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;Invalid&nbsp;JSON&nbsp;content&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;input&nbsp;stream&nbsp;representing&nbsp;the&nbsp;raw&nbsp;content&nbsp;of&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reading&nbsp;from&nbsp;the&nbsp;input&nbsp;stream&nbsp;will&nbsp;update&nbsp;the&nbsp;state&nbsp;of&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;input&nbsp;stream&nbsp;representing&nbsp;the&nbsp;raw&nbsp;content&nbsp;of&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;InputStream&nbsp;getRawContentInputStream()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;head;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;string.&nbsp;Calling&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;underlying&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Subsequent&nbsp;changes&nbsp;to&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;will&nbsp;not&nbsp;be&nbsp;reflected&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;returned&nbsp;string,&nbsp;nor&nbsp;will&nbsp;changes&nbsp;in&nbsp;the&nbsp;returned&nbsp;string&nbsp;be&nbsp;reflected<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;string&nbsp;(never<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null}).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;reading&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getString()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(string&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringWriter&nbsp;writer&nbsp;=&nbsp;new&nbsp;StringWriter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyDecodedContentTo(writer);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;=&nbsp;writer.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;string;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;branched&nbsp;input&nbsp;stream&nbsp;representing&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity.&nbsp;Reading&nbsp;from&nbsp;the&nbsp;returned&nbsp;input&nbsp;stream&nbsp;will&nbsp;NOT&nbsp;update&nbsp;the&nbsp;state<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;of&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;entity&nbsp;will&nbsp;be&nbsp;decompressed&nbsp;based&nbsp;on&nbsp;any&nbsp;codings&nbsp;that&nbsp;are&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;b&amp;gt;Note:&amp;lt;/b&amp;gt;&nbsp;The&nbsp;caller&nbsp;is&nbsp;responsible&nbsp;for&nbsp;calling&nbsp;the&nbsp;input&nbsp;stream's<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;close}&nbsp;method&nbsp;when&nbsp;it&nbsp;is&nbsp;finished&nbsp;reading&nbsp;the&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;buffered&nbsp;input&nbsp;stream&nbsp;for&nbsp;reading&nbsp;the&nbsp;decoded&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedEncodingException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;content&nbsp;encoding&nbsp;are&nbsp;not&nbsp;supported.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;reading&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;InputStream&nbsp;newDecodedContentInputStream()&nbsp;throws&nbsp;UnsupportedEncodingException,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;BranchingInputStream&nbsp;headBranch&nbsp;=&nbsp;head.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getDecodedInputStream(headBranch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(headBranch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;e;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;branched&nbsp;reader&nbsp;representing&nbsp;the&nbsp;decoded&nbsp;content&nbsp;of&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity.&nbsp;Reading&nbsp;from&nbsp;the&nbsp;returned&nbsp;reader&nbsp;will&nbsp;NOT&nbsp;update&nbsp;the&nbsp;state&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;entity&nbsp;will&nbsp;be&nbsp;decoded&nbsp;and/or&nbsp;decompressed&nbsp;based&nbsp;on&nbsp;any&nbsp;codings&nbsp;that<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;are&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;{@code&nbsp;charset}&nbsp;is&nbsp;not&nbsp;{@code&nbsp;null}&nbsp;then&nbsp;it&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;decode&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;entity,&nbsp;otherwise&nbsp;the&nbsp;character&nbsp;set&nbsp;specified&nbsp;in&nbsp;the&nbsp;message's<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;Content-Type}&nbsp;header&nbsp;(if&nbsp;present)&nbsp;will&nbsp;be&nbsp;used,&nbsp;otherwise&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;default&nbsp;{@code&nbsp;ISO-8859-1}&nbsp;character&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;b&amp;gt;Note:&amp;lt;/b&amp;gt;&nbsp;The&nbsp;caller&nbsp;is&nbsp;responsible&nbsp;for&nbsp;calling&nbsp;the&nbsp;reader's<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;close}&nbsp;method&nbsp;when&nbsp;it&nbsp;is&nbsp;finished&nbsp;reading&nbsp;the&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;charset<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;character&nbsp;set&nbsp;to&nbsp;decode&nbsp;with,&nbsp;or&nbsp;message-specified&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;if&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;buffered&nbsp;reader&nbsp;for&nbsp;reading&nbsp;the&nbsp;decoded&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedEncodingException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;content&nbsp;encoding&nbsp;or&nbsp;charset&nbsp;are&nbsp;not&nbsp;supported.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;reading&nbsp;the&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;BufferedReader&nbsp;newDecodedContentReader(final&nbsp;Charset&nbsp;charset)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;UnsupportedEncodingException,&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;BranchingInputStream&nbsp;headBranch&nbsp;=&nbsp;head.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getBufferedReader(headBranch,&nbsp;charset);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(headBranch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;e;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Restores&nbsp;the&nbsp;underlying&nbsp;input&nbsp;stream&nbsp;to&nbsp;the&nbsp;state&nbsp;it&nbsp;had&nbsp;immediately<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;before&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;{@link&nbsp;#push}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;pop()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(head);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head&nbsp;=&nbsp;head.parent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Saves&nbsp;the&nbsp;current&nbsp;position&nbsp;of&nbsp;the&nbsp;underlying&nbsp;input&nbsp;stream&nbsp;and&nbsp;creates&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;new&nbsp;buffered&nbsp;input&nbsp;stream.&nbsp;Subsequent&nbsp;attempts&nbsp;to&nbsp;read&nbsp;from&nbsp;this&nbsp;entity,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;e.g.&nbsp;using&nbsp;{@link&nbsp;#copyRawContentTo(OutputStream)&nbsp;copyRawContentTo}&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;#getRawInputStream()},&nbsp;will&nbsp;not&nbsp;impact&nbsp;the&nbsp;saved&nbsp;state.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Use&nbsp;the&nbsp;{@link&nbsp;#pop}&nbsp;method&nbsp;to&nbsp;restore&nbsp;the&nbsp;entity&nbsp;to&nbsp;the&nbsp;previous&nbsp;state<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;it&nbsp;had&nbsp;before&nbsp;this&nbsp;method&nbsp;was&nbsp;called.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;this&nbsp;entity&nbsp;has&nbsp;been&nbsp;closed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;push()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head&nbsp;=&nbsp;head.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;raw&nbsp;data&nbsp;contained&nbsp;in&nbsp;the&nbsp;provided<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;byte&nbsp;array.&nbsp;Calling&nbsp;this&nbsp;method&nbsp;will&nbsp;close&nbsp;any&nbsp;existing&nbsp;streams<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.&nbsp;Also&nbsp;sets&nbsp;the&nbsp;{@code&nbsp;Content-Length}&nbsp;header,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;overwriting&nbsp;any&nbsp;existing&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;encode&nbsp;the&nbsp;entity&nbsp;based-on&nbsp;any<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;codings&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;byte&nbsp;array&nbsp;containing&nbsp;the&nbsp;raw&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setBytes(final&nbsp;byte[]&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;==&nbsp;null&nbsp;||&nbsp;value.length&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message.getHeaders().putSingle(ContentLengthHeader.NAME,&nbsp;&amp;quot;0&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message.getHeaders()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.putSingle(ContentLengthHeader.NAME,&nbsp;Integer.toString(value.length));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setRawContentInputStream(IO.newBranchingInputStream(value));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;JSON&nbsp;representation&nbsp;of&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;object.&nbsp;Calling&nbsp;this&nbsp;method&nbsp;will&nbsp;close&nbsp;any&nbsp;existing&nbsp;streams<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.&nbsp;Also&nbsp;sets&nbsp;the&nbsp;{@code&nbsp;Content-Type}&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;Content-Length}&nbsp;headers,&nbsp;overwriting&nbsp;any&nbsp;existing&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;encode&nbsp;the&nbsp;entity&nbsp;based-on&nbsp;any<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;codings&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;whose&nbsp;JSON&nbsp;representation&nbsp;is&nbsp;to&nbsp;be&nbsp;store&nbsp;in&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;IO&nbsp;error&nbsp;occurred&nbsp;while&nbsp;writing&nbsp;JSON,&nbsp;such&nbsp;as&nbsp;trying&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;content&nbsp;in&nbsp;wrong&nbsp;context&nbsp;(non-matching&nbsp;end-array&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end-object,&nbsp;for&nbsp;example).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setJson(final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message.getHeaders().putSingle(ContentTypeHeader.NAME,&nbsp;APPLICATION_JSON_CHARSET_UTF_8);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setBytes(writeJson(value));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO&nbsp;do&nbsp;something&nbsp;better&nbsp;than&nbsp;a&nbsp;runtime&nbsp;exception&nbsp;:)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;RuntimeException(&amp;quot;Cannot&nbsp;produce&nbsp;JSON&nbsp;from&nbsp;&amp;quot;&nbsp;+&nbsp;value,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json&nbsp;=&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;input&nbsp;stream.&nbsp;Calling<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;method&nbsp;will&nbsp;close&nbsp;any&nbsp;existing&nbsp;streams&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;No&nbsp;headers&nbsp;will&nbsp;be&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawContentInputStream(final&nbsp;BranchingInputStream&nbsp;is)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(trunk);&nbsp;//&nbsp;Closes&nbsp;all&nbsp;sub-branches<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk&nbsp;=&nbsp;is&nbsp;!=&nbsp;null&nbsp;?&nbsp;is&nbsp;:&nbsp;EMPTY_STREAM;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head&nbsp;=&nbsp;trunk;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;string.&nbsp;Calling&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;will&nbsp;close&nbsp;any&nbsp;existing&nbsp;streams&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.&nbsp;Also<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;sets&nbsp;the&nbsp;{@code&nbsp;Content-Length}&nbsp;header,&nbsp;overwriting&nbsp;any&nbsp;existing&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;character&nbsp;set&nbsp;specified&nbsp;in&nbsp;the&nbsp;message's&nbsp;{@code&nbsp;Content-Type}&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;(if&nbsp;present)&nbsp;will&nbsp;be&nbsp;used,&nbsp;otherwise&nbsp;the&nbsp;default&nbsp;{@code&nbsp;ISO-8859-1}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;character&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;encode&nbsp;the&nbsp;entity&nbsp;based-on&nbsp;any<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;codings&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;string&nbsp;whose&nbsp;value&nbsp;is&nbsp;to&nbsp;be&nbsp;store&nbsp;in&nbsp;this&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setString(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setBytes(value&nbsp;!=&nbsp;null&nbsp;?&nbsp;value.getBytes(cs(null))&nbsp;:&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;=&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;string.&nbsp;Calling&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;underlying&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;content&nbsp;of&nbsp;this&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;string&nbsp;(never<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null}).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;e.getMessage();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Charset&nbsp;cs(final&nbsp;Charset&nbsp;charset)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(charset&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;charset;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;use&nbsp;Content-Type&nbsp;charset&nbsp;if&nbsp;not&nbsp;explicitly&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Charset&nbsp;contentType&nbsp;=&nbsp;ContentTypeHeader.valueOf(message).getCharset();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(contentType&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;contentType;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;use&nbsp;default&nbsp;per&nbsp;RFC&nbsp;2616&nbsp;if&nbsp;not&nbsp;resolved<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ISO_8859_1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BufferedReader&nbsp;getBufferedReader(final&nbsp;InputStream&nbsp;is,&nbsp;final&nbsp;Charset&nbsp;charset)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;UnsupportedEncodingException,&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;BufferedReader(new&nbsp;InputStreamReader(getDecodedInputStream(is),&nbsp;cs(charset)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;InputStream&nbsp;getDecodedInputStream(final&nbsp;InputStream&nbsp;is)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;UnsupportedEncodingException,&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ContentEncodingHeader.valueOf(message).decode(is);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Entity.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpFilterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Filter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Filter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Filter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,50&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Filters&nbsp;the&nbsp;request&nbsp;and/or&nbsp;response&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;exchange.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Filter&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Filters&nbsp;the&nbsp;request&nbsp;and/or&nbsp;response&nbsp;of&nbsp;an&nbsp;exchange.&nbsp;To&nbsp;pass&nbsp;the&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;to&nbsp;the&nbsp;next&nbsp;filter&nbsp;or&nbsp;handler&nbsp;in&nbsp;the&nbsp;chain,&nbsp;the&nbsp;filter&nbsp;calls<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;next.handle(context,&nbsp;request,&nbsp;handler)}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;may&nbsp;elect&nbsp;not&nbsp;to&nbsp;pass&nbsp;the&nbsp;request&nbsp;to&nbsp;the&nbsp;next&nbsp;filter&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;handler,&nbsp;and&nbsp;instead&nbsp;handle&nbsp;the&nbsp;request&nbsp;itself.&nbsp;It&nbsp;can&nbsp;achieve&nbsp;this&nbsp;by<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;merely&nbsp;avoiding&nbsp;a&nbsp;call&nbsp;to&nbsp;{@code&nbsp;next.handle(context,&nbsp;request,&nbsp;handler)}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;creating&nbsp;its&nbsp;own&nbsp;response&nbsp;object.&nbsp;The&nbsp;filter&nbsp;is&nbsp;also&nbsp;at&nbsp;liberty&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;replace&nbsp;a&nbsp;response&nbsp;with&nbsp;another&nbsp;of&nbsp;its&nbsp;own&nbsp;by&nbsp;wrapping&nbsp;and&nbsp;intercepting<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;response&nbsp;handler.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;context<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;request&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;next<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;next&nbsp;filter&nbsp;or&nbsp;handler&nbsp;in&nbsp;the&nbsp;chain&nbsp;to&nbsp;handle&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exchange.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ResponseException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;exception&nbsp;occurs&nbsp;that&nbsp;prevents&nbsp;handling&nbsp;of&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;filter(Context&nbsp;context,&nbsp;Request&nbsp;request,&nbsp;Handler&nbsp;next)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;ResponseException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Filter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpFormjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Form.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Form.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Form.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,178&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.URIUtil.urlDecode;<br>
+import&nbsp;static&nbsp;org.forgerock.http.URIUtil.urlEncode;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.net.URISyntaxException;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.http.util.MultiValueMap;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Form&nbsp;fields,&nbsp;a&nbsp;case-sensitive&nbsp;multi-string-valued&nbsp;map.&nbsp;The&nbsp;form&nbsp;can&nbsp;be&nbsp;read<br>
+&nbsp;*&nbsp;from&nbsp;and&nbsp;written&nbsp;to&nbsp;request&nbsp;objects&nbsp;as&nbsp;query&nbsp;parameters&nbsp;(GET)&nbsp;and&nbsp;request<br>
+&nbsp;*&nbsp;entities&nbsp;(POST).<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;Form&nbsp;extends&nbsp;MultiValueMap&amp;lt;String,&nbsp;String&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new,&nbsp;empty&nbsp;form&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Form()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;a&nbsp;URL-encoded&nbsp;string&nbsp;containing&nbsp;form&nbsp;parameters&nbsp;and&nbsp;stores&nbsp;them&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;object.&nbsp;Malformed&nbsp;name-value&nbsp;pairs&nbsp;(missing&nbsp;the&nbsp;&amp;quot;=&amp;quot;&nbsp;delimiter)&nbsp;are<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;simply&nbsp;ignored.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;s&nbsp;the&nbsp;URL-encoded&nbsp;string&nbsp;to&nbsp;parse.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;form&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Form&nbsp;fromString(String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;param&nbsp;:&nbsp;s.split(&amp;quot;&amp;amp;&amp;quot;))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;nv&nbsp;=&nbsp;param.split(&amp;quot;=&amp;quot;,&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nv.length&nbsp;==&nbsp;2)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(urlDecode(nv[0]),&nbsp;urlDecode(nv[1]));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;this&nbsp;form&nbsp;in&nbsp;a&nbsp;URL-encoded&nbsp;format&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;URL-encoded&nbsp;form.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;name&nbsp;:&nbsp;keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;value&nbsp;:&nbsp;get(name))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sb.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append('&amp;amp;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(urlEncode(name)).append('=').append(urlEncode(value));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;query&nbsp;parameters&nbsp;of&nbsp;a&nbsp;request&nbsp;and&nbsp;stores&nbsp;them&nbsp;in&nbsp;this&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;object&nbsp;is&nbsp;not&nbsp;cleared&nbsp;beforehand,&nbsp;so&nbsp;this&nbsp;adds&nbsp;to&nbsp;any&nbsp;fields&nbsp;already<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;place.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;the&nbsp;request&nbsp;to&nbsp;be&nbsp;parsed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;form&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Form&nbsp;fromRequestQuery(Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;query&nbsp;=&nbsp;request.getUri().getRawQuery();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(query&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fromString(query);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;a&nbsp;request&nbsp;URI&nbsp;with&nbsp;query&nbsp;parameters.&nbsp;This&nbsp;overwrites&nbsp;any&nbsp;query<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;parameters&nbsp;that&nbsp;may&nbsp;already&nbsp;exist&nbsp;in&nbsp;the&nbsp;request&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;the&nbsp;request&nbsp;to&nbsp;set&nbsp;query&nbsp;parameters&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;toRequestQuery(Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getUri().setRawQuery(toString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(URISyntaxException&nbsp;use)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(use);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Appends&nbsp;the&nbsp;form&nbsp;as&nbsp;additional&nbsp;query&nbsp;parameters&nbsp;on&nbsp;an&nbsp;existing&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;URI.&nbsp;This&nbsp;leaves&nbsp;any&nbsp;existing&nbsp;query&nbsp;parameters&nbsp;intact.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;the&nbsp;request&nbsp;to&nbsp;append&nbsp;query&nbsp;parameters&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;appendRequestQuery(Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;uriQuery&nbsp;=&nbsp;request.getUri().getRawQuery();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(uriQuery&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;uriQuery.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(uriQuery);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;toAppend&nbsp;=&nbsp;toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(toAppend&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;toAppend.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sb.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append('&amp;amp;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(toAppend);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;newQuery&nbsp;=&nbsp;sb.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(newQuery.length()&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newQuery&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getUri().setRawQuery(newQuery);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(URISyntaxException&nbsp;use)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(use);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;URL-encoded&nbsp;form&nbsp;entity&nbsp;of&nbsp;a&nbsp;request&nbsp;and&nbsp;stores&nbsp;them&nbsp;in&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;object.&nbsp;The&nbsp;object&nbsp;is&nbsp;not&nbsp;cleared&nbsp;beforehand,&nbsp;so&nbsp;this&nbsp;adds&nbsp;to&nbsp;any&nbsp;fields<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;already&nbsp;in&nbsp;place.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;request&nbsp;to&nbsp;be&nbsp;parsed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;form&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Form&nbsp;fromRequestEntity(Request&nbsp;request)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request&nbsp;!=&nbsp;null<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;request.getEntity()&nbsp;!=&nbsp;null<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;&amp;quot;application/x-www-form-urlencoded&amp;quot;.equalsIgnoreCase(request.getHeaders()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getFirst(&amp;quot;Content-Type&amp;quot;)))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fromString(request.getEntity().getString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Populates&nbsp;a&nbsp;request&nbsp;with&nbsp;the&nbsp;necessary&nbsp;headers&nbsp;and&nbsp;entity&nbsp;for&nbsp;the&nbsp;form&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;be&nbsp;submitted&nbsp;as&nbsp;a&nbsp;POST&nbsp;with&nbsp;application/x-www-form-urlencoded&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;type.&nbsp;This&nbsp;overwrites&nbsp;any&nbsp;entity&nbsp;that&nbsp;may&nbsp;already&nbsp;be&nbsp;in&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;the&nbsp;request&nbsp;to&nbsp;add&nbsp;the&nbsp;form&nbsp;entity&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;toRequestEntity(Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;form&nbsp;=&nbsp;toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setMethod(&amp;quot;POST&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(&amp;quot;Content-Type&amp;quot;,&nbsp;&amp;quot;application/x-www-form-urlencoded&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(&amp;quot;Content-Length&amp;quot;,&nbsp;Integer.toString(form.length()));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getEntity().setString(form);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Form.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHandlerjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Handler.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Handler.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Handler.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,45&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Handles&nbsp;an&nbsp;HTTP&nbsp;exchange&nbsp;request&nbsp;by&nbsp;producing&nbsp;an&nbsp;associated&nbsp;response.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Handler&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Called&nbsp;to&nbsp;request&nbsp;the&nbsp;handler&nbsp;respond&nbsp;to&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;A&nbsp;handler&nbsp;that&nbsp;doesn't&nbsp;hand-off&nbsp;an&nbsp;exchange&nbsp;to&nbsp;another&nbsp;handler&nbsp;downstream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;responsible&nbsp;for&nbsp;creating&nbsp;the&nbsp;response&nbsp;and&nbsp;returning&nbsp;it&nbsp;via&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;response&nbsp;handler&nbsp;or&nbsp;by&nbsp;throwing&nbsp;a&nbsp;{@code&nbsp;ResponseException}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;context<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;request&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ResponseException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;exception&nbsp;occurs&nbsp;that&nbsp;prevents&nbsp;handling&nbsp;of&nbsp;the&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;handle(Context&nbsp;context,&nbsp;Request&nbsp;request)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;ResponseException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Handler.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Header.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Header.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Header.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,41&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;HTTP&nbsp;message&nbsp;header.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Header&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;header,&nbsp;as&nbsp;it&nbsp;would&nbsp;canonically&nbsp;appear&nbsp;within&nbsp;an<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;HTTP&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;header,&nbsp;as&nbsp;it&nbsp;would&nbsp;canonically&nbsp;appear&nbsp;within&nbsp;an<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getName();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;header&nbsp;as&nbsp;a&nbsp;single&nbsp;string&nbsp;value.&nbsp;If&nbsp;the&nbsp;header&nbsp;is&nbsp;empty,&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;will&nbsp;return&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;header&nbsp;as&nbsp;a&nbsp;single&nbsp;string&nbsp;value&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;toString();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Header.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHeadersjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Headers.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Headers.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Headers.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,65&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.http.util.CaseInsensitiveMap;<br>
+import&nbsp;org.forgerock.http.util.MultiValueMap;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Message&nbsp;headers,&nbsp;a&nbsp;case-insensitive&nbsp;multiple-value&nbsp;map.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;Headers&nbsp;extends&nbsp;MultiValueMap&amp;lt;String,&nbsp;String&amp;gt;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;TODO:&nbsp;if&nbsp;this&nbsp;class&nbsp;implemented&nbsp;MultiValueMap&amp;lt;String,&nbsp;Header&amp;gt;&nbsp;then&nbsp;we<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;could&nbsp;lazily&nbsp;convert&nbsp;header&nbsp;values&nbsp;on&nbsp;demand.&nbsp;Subsequent&nbsp;changes&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;headers&nbsp;(assuming&nbsp;they&nbsp;are&nbsp;mutable)&nbsp;would&nbsp;then&nbsp;be&nbsp;reflected&nbsp;when&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;headers&nbsp;are&nbsp;re-serialized.&nbsp;For&nbsp;example,&nbsp;a&nbsp;filter&nbsp;could&nbsp;modify&nbsp;the&nbsp;cookies<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;have&nbsp;those&nbsp;changes&nbsp;automatically&nbsp;applied&nbsp;when&nbsp;the&nbsp;header&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;re-encoded&nbsp;when&nbsp;it&nbsp;is&nbsp;forwarded.&nbsp;However,&nbsp;changing&nbsp;the&nbsp;type&nbsp;of&nbsp;map&nbsp;values<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;from&nbsp;String&nbsp;to&nbsp;Header&nbsp;may&nbsp;have&nbsp;implications&nbsp;on&nbsp;our&nbsp;EL&nbsp;and&nbsp;scripting<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;support.&nbsp;For&nbsp;example,&nbsp;previously&nbsp;it&nbsp;was&nbsp;possible&nbsp;to&nbsp;do<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;quot;request.headers.Connection&nbsp;=&nbsp;[&nbsp;'token1',&nbsp;'token2'&nbsp;]&amp;quot;&nbsp;in&nbsp;Groovy,&nbsp;but&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;may&nbsp;not&nbsp;be&nbsp;possible&nbsp;with&nbsp;if&nbsp;the&nbsp;values&nbsp;are&nbsp;Headers.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;message&nbsp;headers.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Headers()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;CaseInsensitiveMap&amp;lt;List&amp;lt;String&amp;gt;&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;provider&nbsp;header&nbsp;but&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;non-empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Headers&nbsp;putSingle(Header&nbsp;header)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Only&nbsp;include&nbsp;the&nbsp;header&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;value&nbsp;=&nbsp;header.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;!value.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putSingle(header.getName(),&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Headers.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Http.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Http.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Http.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,91&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Utility&nbsp;methods&nbsp;for&nbsp;creating&nbsp;common&nbsp;types&nbsp;of&nbsp;handler&nbsp;and&nbsp;filters.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;Http&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;FIXME:&nbsp;handlers&nbsp;and&nbsp;filters&nbsp;should&nbsp;always&nbsp;return&nbsp;responses&nbsp;regardless&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;status&nbsp;code.&nbsp;Exceptions&nbsp;should&nbsp;be&nbsp;reserved&nbsp;for&nbsp;internal&nbsp;failures.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Filter&nbsp;newSessionFilter(SessionManager&nbsp;sessionManager)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;SessionFilter(sessionManager);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Handler&nbsp;chainOf(final&nbsp;Handler&nbsp;handler,&nbsp;final&nbsp;Filter...&nbsp;filters)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chainOf(handler,&nbsp;Arrays.asList(filters));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Handler&nbsp;chainOf(final&nbsp;Handler&nbsp;handler,&nbsp;final&nbsp;List&amp;lt;Filter&amp;gt;&nbsp;filters)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Chain(handler,&nbsp;filters,&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Filter&nbsp;chainOf(final&nbsp;Filter...&nbsp;filters)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chainOf(Arrays.asList(filters));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Filter&nbsp;chainOf(final&nbsp;Collection&amp;lt;Filter&amp;gt;&nbsp;filters)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO:&nbsp;return&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;filters.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;class&nbsp;Chain&nbsp;implements&nbsp;Handler&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Handler&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;Filter&amp;gt;&nbsp;filters;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;position;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Chain(Handler&nbsp;handler,&nbsp;List&amp;lt;Filter&amp;gt;&nbsp;filters,&nbsp;int&nbsp;position)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.handler&nbsp;=&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.filters&nbsp;=&nbsp;filters;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.position&nbsp;=&nbsp;position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;handle(Context&nbsp;context,&nbsp;Request&nbsp;request)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(position&nbsp;&amp;lt;&nbsp;filters.size())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;filters.get(position).filter(context,&nbsp;request,&nbsp;next());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;handler.handle(context,&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Handler&nbsp;next()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Chain(handler,&nbsp;filters,&nbsp;position&nbsp;+&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;filters.toString()&nbsp;+&nbsp;&amp;quot;&nbsp;-&amp;gt;&nbsp;&amp;quot;&nbsp;+&nbsp;handler.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Http()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Prevent&nbsp;instantiation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Http.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpApplicationjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplication.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplication.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplication.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,57&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;org.forgerock.http.io.Buffer;<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+import&nbsp;org.slf4j.Logger;<br>
+import&nbsp;org.slf4j.LoggerFactory;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;Configuration&nbsp;class&nbsp;to&nbsp;configure&nbsp;the&nbsp;{@code&nbsp;HttpApplication}&nbsp;instance.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;The&nbsp;implementation&nbsp;of&nbsp;this&nbsp;class&nbsp;will&nbsp;be&nbsp;loaded&nbsp;using&nbsp;the&nbsp;{@link&nbsp;java.util.ServiceLoader}&nbsp;framework.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;HttpApplication&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Http&nbsp;Framework&nbsp;core&nbsp;Logger&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Logger&nbsp;LOGGER&nbsp;=&nbsp;LoggerFactory.getLogger(HttpApplication.class);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Gets&nbsp;the&nbsp;root&nbsp;{@link&nbsp;Handler}&nbsp;that&nbsp;will&nbsp;handle&nbsp;all&nbsp;HTTP&nbsp;requests.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;The&nbsp;{@code&nbsp;Handler}&nbsp;returned&nbsp;from&nbsp;this&nbsp;method&nbsp;MUST&nbsp;be&nbsp;a&nbsp;singleton.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;{@code&nbsp;Handler}&nbsp;to&nbsp;handle&nbsp;HTTP&nbsp;requests.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HttpApplicationException&nbsp;If&nbsp;there&nbsp;is&nbsp;a&nbsp;problem&nbsp;constructing&nbsp;the&nbsp;root&nbsp;application&nbsp;{@code&nbsp;Handler}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;start()&nbsp;throws&nbsp;HttpApplicationException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Gets&nbsp;the&nbsp;{@link&nbsp;Factory}&nbsp;that&nbsp;will&nbsp;create&nbsp;temporary&nbsp;storage&nbsp;{@link&nbsp;Buffer}s&nbsp;to&nbsp;handle&nbsp;the&nbsp;processing&nbsp;of&nbsp;requests.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;May&nbsp;return&nbsp;{@code&nbsp;null}&nbsp;indicating&nbsp;that&nbsp;the&nbsp;container&nbsp;should&nbsp;provide&nbsp;a&nbsp;default&nbsp;buffer&nbsp;factory.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;{@code&nbsp;Buffer}&nbsp;{@code&nbsp;Factory}&nbsp;or&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;getBufferFactory();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;stop();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplication.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpApplicationExceptionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplicationException.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplicationException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplicationException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,45&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;exception&nbsp;that&nbsp;is&nbsp;thrown&nbsp;during&nbsp;a&nbsp;Http&nbsp;Application&nbsp;start&nbsp;up&nbsp;when&nbsp;the&nbsp;start&nbsp;up&nbsp;of&nbsp;the&nbsp;application&nbsp;fails.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;HttpApplicationException&nbsp;extends&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;3010033632180707412L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;message&nbsp;The&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HttpApplicationException(String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message&nbsp;and&nbsp;cause.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;message&nbsp;The&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;cause&nbsp;The&nbsp;exception&nbsp;which&nbsp;caused&nbsp;this&nbsp;exception&nbsp;to&nbsp;be&nbsp;thrown.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HttpApplicationException(String&nbsp;message,&nbsp;Throwable&nbsp;cause)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message,&nbsp;cause);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpApplicationException.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpHttpContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,73&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.security.Principal;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.util.Reject;<br>
+import&nbsp;org.forgerock.resource.core.AbstractContext;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Represents&nbsp;extrinsic&nbsp;state&nbsp;associated&nbsp;with&nbsp;the&nbsp;processing&nbsp;of&nbsp;a&nbsp;request&nbsp;in&nbsp;a<br>
+&nbsp;*&nbsp;server.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;HttpContext&nbsp;extends&nbsp;AbstractContext&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;TODO:&nbsp;add&nbsp;connection&nbsp;information&nbsp;such&nbsp;as&nbsp;IP&nbsp;address,&nbsp;SSL&nbsp;parameters,&nbsp;etc.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;principal&nbsp;associated&nbsp;with&nbsp;the&nbsp;request,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;unknown.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Principal&nbsp;principal;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Session&nbsp;information&nbsp;associated&nbsp;with&nbsp;the&nbsp;remote&nbsp;client.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Session&nbsp;session;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;attributes&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;Object&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//TODO&nbsp;this&nbsp;should&nbsp;be&nbsp;default&nbsp;visibility<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HttpContext(Context&nbsp;parent,&nbsp;Session&nbsp;session)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(parent,&nbsp;&amp;quot;httpRequest&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reject.ifNull(session,&nbsp;&amp;quot;Session&nbsp;cannot&nbsp;be&nbsp;null.&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.session&nbsp;=&nbsp;session;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Principal&nbsp;getPrincipal()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;principal;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HttpContext&nbsp;setPrincipal(Principal&nbsp;principal)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.principal&nbsp;=&nbsp;principal;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Session&nbsp;getSession()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;session;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;HttpContext&nbsp;setSession(Session&nbsp;session)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.session&nbsp;=&nbsp;session;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;getAttributes()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;attributes;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/HttpContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMessagejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Message.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Message.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Message.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,90&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.Closeable;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Elements&nbsp;common&nbsp;to&nbsp;requests&nbsp;and&nbsp;responses.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Message&nbsp;extends&nbsp;Closeable&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Entity&nbsp;getEntity();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;headers.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;headers.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Headers&nbsp;getHeaders();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;protocol&nbsp;version.&nbsp;Default:&nbsp;{@code&nbsp;HTTP/1.1}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;protocol&nbsp;version.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getVersion();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;entity&nbsp;to&nbsp;the&nbsp;provided&nbsp;value.&nbsp;Calling&nbsp;this&nbsp;method<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;will&nbsp;close&nbsp;any&nbsp;existing&nbsp;streams&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.&nbsp;May&nbsp;also&nbsp;set<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;{@code&nbsp;Content-Length}&nbsp;header,&nbsp;overwriting&nbsp;any&nbsp;existing&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;is&nbsp;intended&nbsp;mostly&nbsp;as&nbsp;a&nbsp;convenience&nbsp;method&nbsp;within&nbsp;scripts.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;parameter&nbsp;will&nbsp;be&nbsp;handled&nbsp;depending&nbsp;on&nbsp;its&nbsp;type&nbsp;as&nbsp;follows:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;ul&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;li&amp;gt;{@code&nbsp;BranchingInputStream}&nbsp;-&nbsp;equivalent&nbsp;to&nbsp;calling<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@link&nbsp;Entity#setRawContentInputStream}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;li&amp;gt;{@code&nbsp;byte[]}&nbsp;-&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;{@link&nbsp;Entity#setBytes}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;li&amp;gt;{@code&nbsp;String}&nbsp;-&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;{@link&nbsp;Entity#setString}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;li&amp;gt;{@code&nbsp;Object}&nbsp;-&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;{@link&nbsp;Entity#setJson}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/ul&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;encode&nbsp;the&nbsp;entity&nbsp;based-on&nbsp;any<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;codings&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;o<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;whose&nbsp;value&nbsp;should&nbsp;be&nbsp;stored&nbsp;in&nbsp;the&nbsp;entity.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Message&nbsp;setEntity(Object&nbsp;o);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;protocol&nbsp;version.&nbsp;Default:&nbsp;{@code&nbsp;HTTP/1.1}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;version<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;protocol&nbsp;version.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Message&nbsp;setVersion(final&nbsp;String&nbsp;version);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;all&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;entity.&nbsp;Any&nbsp;open&nbsp;streams&nbsp;will&nbsp;be<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;closed,&nbsp;and&nbsp;the&nbsp;underlying&nbsp;content&nbsp;reset&nbsp;back&nbsp;to&nbsp;a&nbsp;zero&nbsp;length.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;Entity#close()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;close();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Message.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMessageImpljava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MessageImpl.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MessageImpl.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MessageImpl.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,79&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;org.forgerock.http.io.BranchingInputStream;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Abstract&nbsp;message&nbsp;base&nbsp;class.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;sub-type&nbsp;of&nbsp;this&nbsp;message.<br>
+&nbsp;*/<br>
+abstract&nbsp;class&nbsp;MessageImpl&amp;lt;T&nbsp;extends&nbsp;MessageImpl&amp;lt;T&amp;gt;&amp;gt;&nbsp;implements&nbsp;Message&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Message&nbsp;entity&nbsp;body.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Entity&nbsp;entity&nbsp;=&nbsp;new&nbsp;Entity(this);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Message&nbsp;header&nbsp;fields.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Headers&nbsp;headers&nbsp;=&nbsp;new&nbsp;Headers();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Protocol&nbsp;version.&nbsp;Default:&nbsp;{@code&nbsp;HTTP/1.1}.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;version&nbsp;=&nbsp;&amp;quot;HTTP/1.1&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;MessageImpl()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Hidden&nbsp;constructor.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;Entity&nbsp;getEntity()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;entity;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;Headers&nbsp;getHeaders()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;headers;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;String&nbsp;getVersion()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;version;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;void&nbsp;setEntity0(final&nbsp;Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o&nbsp;instanceof&nbsp;BranchingInputStream)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream((BranchingInputStream)&nbsp;o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(o&nbsp;instanceof&nbsp;byte[])&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setBytes((byte[])&nbsp;o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(o&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setString((String)&nbsp;o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setJson(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;void&nbsp;setVersion0(final&nbsp;String&nbsp;version)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.version&nbsp;=&nbsp;version;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MessageImpl.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpMutableUrijava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MutableUri.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MutableUri.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MutableUri.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,470&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.URIUtil.*;<br>
+<br>
+import&nbsp;java.net.URI;<br>
+import&nbsp;java.net.URISyntaxException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;MutableUri&nbsp;is&nbsp;a&nbsp;modifiable&nbsp;{@link&nbsp;URI}&nbsp;substitute.<br>
+&nbsp;*&nbsp;Unlike&nbsp;URIs,&nbsp;which&nbsp;are&nbsp;immutable,&nbsp;a&nbsp;MutableUri&nbsp;can&nbsp;have&nbsp;its&nbsp;fields&nbsp;updated&nbsp;independently.<br>
+&nbsp;*&nbsp;That&nbsp;makes&nbsp;it&nbsp;easier&nbsp;if&nbsp;you&nbsp;just&nbsp;want&nbsp;to&nbsp;change&nbsp;a&nbsp;element&nbsp;of&nbsp;an&nbsp;Uri.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;URI<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;MutableUri&nbsp;implements&nbsp;Comparable&amp;lt;MutableUri&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Factory&nbsp;method&nbsp;for&nbsp;avoiding&nbsp;typing&nbsp;{@code&nbsp;new&nbsp;MutableUri(&amp;quot;http://...&amp;quot;)}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;URL&nbsp;encoded&nbsp;URI<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;new&nbsp;MutableUri&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;given&nbsp;Uri&nbsp;is&nbsp;not&nbsp;well-formed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;MutableUri&nbsp;uri(String&nbsp;uri)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;MutableUri(uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;real&nbsp;URI,&nbsp;hidden&nbsp;by&nbsp;this&nbsp;class.&nbsp;Recreated&nbsp;each&nbsp;time&nbsp;a&nbsp;field&nbsp;is&nbsp;updated.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;URI&nbsp;uri;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;new&nbsp;MutableUri&nbsp;using&nbsp;the&nbsp;given&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;URI<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri(final&nbsp;URI&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;new&nbsp;MutableUri&nbsp;with&nbsp;deep&nbsp;copy.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;mutableUri&nbsp;URI<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri(final&nbsp;MutableUri&nbsp;mutableUri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;mutableUri.asURI();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;new&nbsp;MutableUri&nbsp;using&nbsp;the&nbsp;given&nbsp;URL&nbsp;encoded&nbsp;String&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;URL&nbsp;encoded&nbsp;URI<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;given&nbsp;Uri&nbsp;is&nbsp;not&nbsp;well-formed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri(final&nbsp;String&nbsp;uri)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;new&nbsp;MutableUri&nbsp;using&nbsp;the&nbsp;given&nbsp;fields&nbsp;values&nbsp;(decoded&nbsp;values).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;scheme&nbsp;Scheme&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;userInfo&nbsp;User&nbsp;name&nbsp;and&nbsp;authorization&nbsp;information<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;host&nbsp;Host&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;port&nbsp;Port&nbsp;number<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;path&nbsp;Path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;query&nbsp;Query<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;fragment&nbsp;Fragment<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;produced&nbsp;URI&nbsp;is&nbsp;not&nbsp;well-formed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri(String&nbsp;scheme,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;userInfo,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;host,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;port,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;path,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;query,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;fragment)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(scheme,&nbsp;userInfo,&nbsp;host,&nbsp;port,&nbsp;path,&nbsp;query,&nbsp;fragment);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;equivalent&nbsp;{@link&nbsp;URI}&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;equivalent&nbsp;{@link&nbsp;URI}&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;URI&nbsp;asURI()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;scheme&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;scheme&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getScheme()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getScheme();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;scheme&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;scheme&nbsp;new&nbsp;scheme&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setScheme(final&nbsp;String&nbsp;scheme)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(scheme,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;user&nbsp;info&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;user&nbsp;info&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getUserInfo()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getUserInfo();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;raw&nbsp;(encoded)&nbsp;user&nbsp;info&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;raw&nbsp;user&nbsp;info&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRawUserInfo()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getRawUserInfo();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;user&nbsp;info&nbsp;(not&nbsp;encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;userInfo&nbsp;new&nbsp;user&nbsp;info&nbsp;element&nbsp;(not&nbsp;encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setUserInfo(final&nbsp;String&nbsp;userInfo)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;userInfo,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;user&nbsp;info&nbsp;(encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawUserInfo&nbsp;new&nbsp;user&nbsp;info&nbsp;element&nbsp;(encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawUserInfo(String&nbsp;rawUserInfo)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;create(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawUserInfo,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;host&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;host&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getHost()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getHost();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;host&nbsp;name&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;host&nbsp;new&nbsp;host&nbsp;element<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setHost(final&nbsp;String&nbsp;host)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;port&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;port&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;getPort()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getPort();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;port&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;port&nbsp;new&nbsp;port&nbsp;number<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setPort(final&nbsp;int&nbsp;port)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getPath()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getPath();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;raw&nbsp;(encoded)&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;raw&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRawPath()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getRawPath();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;path&nbsp;(not&nbsp;encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;path&nbsp;new&nbsp;path&nbsp;element&nbsp;(not&nbsp;encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setPath(final&nbsp;String&nbsp;path)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;pah&nbsp;(encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawPath&nbsp;new&nbsp;path&nbsp;element&nbsp;(encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawPath(String&nbsp;rawPath)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;create(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawPath,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getQuery()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getQuery();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;raw&nbsp;(encoded)&nbsp;query&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;raw&nbsp;query&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRawQuery()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getRawQuery();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;query&nbsp;string&nbsp;(not&nbsp;encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;query&nbsp;new&nbsp;query&nbsp;string&nbsp;element&nbsp;(not&nbsp;encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setQuery(final&nbsp;String&nbsp;query)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;query&nbsp;(encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawQuery&nbsp;new&nbsp;query&nbsp;element&nbsp;(encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawQuery(String&nbsp;rawQuery)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;create(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawQuery,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;fragment&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;fragment&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getFragment()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getFragment();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;raw&nbsp;(encoded)&nbsp;fragment&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;raw&nbsp;fragment&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRawFragment()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getRawFragment();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;fragment&nbsp;(not&nbsp;encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;fragment&nbsp;new&nbsp;fragment&nbsp;element&nbsp;(not&nbsp;encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setFragment(final&nbsp;String&nbsp;fragment)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;new&nbsp;URI(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fragment);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Update&nbsp;the&nbsp;fragment&nbsp;(encoded)&nbsp;of&nbsp;this&nbsp;MutableUri.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawFragment&nbsp;new&nbsp;framgent&nbsp;element&nbsp;(encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;new&nbsp;equivalent&nbsp;URI&nbsp;is&nbsp;invalid<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawFragment(String&nbsp;rawFragment)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;create(uri.getScheme(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawUserInfo(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getPort(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawQuery(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rawFragment);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;authority&nbsp;compound&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;authority&nbsp;compound&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getAuthority()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getAuthority();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;raw&nbsp;(encoded)&nbsp;authority&nbsp;compound&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;authority&nbsp;compound&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRawAuthority()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.getRawAuthority();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Changes&nbsp;the&nbsp;base&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port&nbsp;of&nbsp;this&nbsp;MutableUri&nbsp;to&nbsp;that&nbsp;specified&nbsp;in&nbsp;a&nbsp;base&nbsp;URI,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;or&nbsp;leaves&nbsp;them&nbsp;unchanged&nbsp;if&nbsp;the&nbsp;base&nbsp;URI&nbsp;is&nbsp;{@code&nbsp;null}.&nbsp;This&nbsp;implementation&nbsp;only<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;uses&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port.&nbsp;The&nbsp;remaining&nbsp;components&nbsp;of&nbsp;the&nbsp;URI&nbsp;remain&nbsp;intact.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;base&nbsp;the&nbsp;URI&nbsp;to&nbsp;base&nbsp;the&nbsp;other&nbsp;URI&nbsp;on.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;(rebased)&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri&nbsp;rebase(MutableUri&nbsp;base)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(base&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;scheme&nbsp;=&nbsp;base.getScheme();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;host&nbsp;=&nbsp;base.getHost();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;port&nbsp;=&nbsp;base.getPort();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(scheme&nbsp;==&nbsp;null&nbsp;||&nbsp;host&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setScheme(scheme);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setHost(host);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setPort(port);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(URISyntaxException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Changes&nbsp;the&nbsp;base&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port&nbsp;of&nbsp;this&nbsp;MutableUri&nbsp;to&nbsp;that&nbsp;specified&nbsp;in&nbsp;a&nbsp;base&nbsp;URI,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;or&nbsp;leaves&nbsp;them&nbsp;unchanged&nbsp;if&nbsp;the&nbsp;base&nbsp;URI&nbsp;is&nbsp;{@code&nbsp;null}.&nbsp;This&nbsp;implementation&nbsp;only<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;uses&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port.&nbsp;The&nbsp;remaining&nbsp;components&nbsp;of&nbsp;the&nbsp;URI&nbsp;remain&nbsp;intact.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;base&nbsp;the&nbsp;URI&nbsp;to&nbsp;base&nbsp;the&nbsp;other&nbsp;URI&nbsp;on.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;(rebased)&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri&nbsp;rebase(URI&nbsp;base)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rebase(new&nbsp;MutableUri(base));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;compareTo(final&nbsp;MutableUri&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;asURI().compareTo(o.asURI());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Relativizes&nbsp;the&nbsp;given&nbsp;URI&nbsp;against&nbsp;this&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;the&nbsp;uri&nbsp;to&nbsp;relativizes&nbsp;against&nbsp;this&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;instance&nbsp;(mutated)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;URI#relativize(URI)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri&nbsp;relativize(final&nbsp;MutableUri&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;this.uri.relativize(uri.asURI());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Resolves&nbsp;the&nbsp;given&nbsp;URI&nbsp;against&nbsp;this&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;the&nbsp;uri&nbsp;to&nbsp;resolve&nbsp;against&nbsp;this&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;instance&nbsp;(mutated)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;URI#resolve(URI)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri&nbsp;resolve(final&nbsp;MutableUri&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;this.uri.resolve(uri.asURI());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;URI&nbsp;as&nbsp;a&nbsp;US-ASCII&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;content&nbsp;of&nbsp;this&nbsp;URI&nbsp;as&nbsp;a&nbsp;US-ASCII&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toASCIIString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.toASCIIString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;equals(final&nbsp;Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this&nbsp;==&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o&nbsp;==&nbsp;null&nbsp;||&nbsp;!(o&nbsp;instanceof&nbsp;MutableUri))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;that&nbsp;=&nbsp;(MutableUri)&nbsp;o;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.equals(that.uri);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;hashCode()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.hashCode();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/MutableUri.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpNotFoundExceptionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/NotFoundException.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/NotFoundException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/NotFoundException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,54&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyrighted&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;exception&nbsp;that&nbsp;is&nbsp;thrown&nbsp;when&nbsp;a&nbsp;specified&nbsp;resource&nbsp;cannot&nbsp;be&nbsp;found.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;NotFoundException&nbsp;extends&nbsp;ResponseException&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;1L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;{@code&nbsp;null}&nbsp;as&nbsp;its&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;NotFoundException()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(400);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;NotFoundException(final&nbsp;String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(400,&nbsp;message);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message&nbsp;and&nbsp;cause.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;cause<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;exception&nbsp;which&nbsp;caused&nbsp;this&nbsp;exception&nbsp;to&nbsp;be&nbsp;thrown.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;NotFoundException(String&nbsp;message,&nbsp;Throwable&nbsp;cause)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;Response().setStatusAndReason(400),&nbsp;message,&nbsp;cause);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/NotFoundException.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpRequestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Request.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Request.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Request.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,155&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.net.URI;<br>
+import&nbsp;java.net.URISyntaxException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;request&nbsp;message.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;A&nbsp;RequestResolver&nbsp;is&nbsp;linked&nbsp;to&nbsp;this&nbsp;class.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;org.forgerock.openig.resolver.RequestResolver<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Request&nbsp;extends&nbsp;MessageImpl&amp;lt;Request&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Exposes&nbsp;incoming&nbsp;request&nbsp;cookies.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;RequestCookies&nbsp;cookies&nbsp;=&nbsp;new&nbsp;RequestCookies(this);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;method&nbsp;to&nbsp;be&nbsp;performed&nbsp;on&nbsp;the&nbsp;resource.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;method;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;MutableUri&nbsp;uri;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;request&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;incoming&nbsp;request&nbsp;cookies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;incoming&nbsp;request&nbsp;cookies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RequestCookies&nbsp;getCookies()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;query&nbsp;parameters&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;application/x-www-form-urlencoded}&nbsp;entity&nbsp;decoded&nbsp;as&nbsp;a&nbsp;form.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Modifications&nbsp;to&nbsp;the&nbsp;returned&nbsp;form&nbsp;are&nbsp;not&nbsp;reflected&nbsp;in&nbsp;this&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;query&nbsp;parameters&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;application/x-www-form-urlencoded}&nbsp;entity&nbsp;as&nbsp;a&nbsp;form.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Form&nbsp;getForm()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Form&nbsp;form&nbsp;=&nbsp;new&nbsp;Form();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.fromRequestQuery(this);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.fromRequestEntity(this);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Ignore:&nbsp;return&nbsp;empty&nbsp;form.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;form;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;method&nbsp;to&nbsp;be&nbsp;performed&nbsp;on&nbsp;the&nbsp;resource.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;method&nbsp;to&nbsp;be&nbsp;performed&nbsp;on&nbsp;the&nbsp;resource.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getMethod()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;method;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MutableUri&nbsp;getUri()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request&nbsp;setEntity(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setEntity0(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;method&nbsp;to&nbsp;be&nbsp;performed&nbsp;on&nbsp;the&nbsp;resource.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;method<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;method&nbsp;to&nbsp;be&nbsp;performed&nbsp;on&nbsp;the&nbsp;resource.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request&nbsp;setMethod(final&nbsp;String&nbsp;method)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.method&nbsp;=&nbsp;method;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Request&nbsp;setUri(final&nbsp;MutableUri&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uri&nbsp;=&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;fully-qualified&nbsp;string&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fully-qualified&nbsp;string&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;given&nbsp;URI&nbsp;string&nbsp;is&nbsp;not&nbsp;well-formed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request&nbsp;setUri(final&nbsp;String&nbsp;uri)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;setUri(new&nbsp;MutableUri(uri));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fully-qualified&nbsp;URI&nbsp;of&nbsp;the&nbsp;resource&nbsp;being&nbsp;accessed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request&nbsp;setUri(final&nbsp;URI&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;setUri(new&nbsp;MutableUri(uri));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Request&nbsp;setVersion(String&nbsp;version)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setVersion0(version);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Request.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpRequestCookiesjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/RequestCookies.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/RequestCookies.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/RequestCookies.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,119&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.util.AbstractMap;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.Set;<br>
+import&nbsp;java.util.TreeMap;<br>
+<br>
+import&nbsp;org.forgerock.http.header.CookieHeader;<br>
+import&nbsp;org.forgerock.http.util.UnmodifiableCollection;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Exposes&nbsp;incoming&nbsp;request&nbsp;cookies.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;RequestCookies&nbsp;extends&nbsp;AbstractMap&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;&nbsp;implements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;,&nbsp;UnmodifiableCollection&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO:&nbsp;maybe&nbsp;some&nbsp;intelligent&nbsp;caching&nbsp;so&nbsp;each&nbsp;call&nbsp;to&nbsp;get&nbsp;doesn't&nbsp;re-parse&nbsp;the&nbsp;cookies<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;request&nbsp;to&nbsp;read&nbsp;cookies&nbsp;from.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Request&nbsp;request;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;request&nbsp;cookies&nbsp;object&nbsp;that&nbsp;reads&nbsp;cookies&nbsp;from&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;specified&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;request&nbsp;to&nbsp;read&nbsp;cookies&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RequestCookies(final&nbsp;Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.request&nbsp;=&nbsp;request;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsKey(final&nbsp;Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;get(key)&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsValue(final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies().containsValue(value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Set&amp;lt;Entry&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;&amp;gt;&nbsp;entrySet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies().entrySet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;Cookie&amp;gt;&nbsp;get(final&nbsp;Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ArrayList&amp;lt;Cookie&amp;gt;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;Cookie&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(key&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;(String)&nbsp;key;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;Cookie&nbsp;cookie&nbsp;:&nbsp;CookieHeader.valueOf(request).getCookies())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.equalsIgnoreCase(cookie.getName()))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(cookie);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list.size()&nbsp;&amp;gt;&nbsp;0&nbsp;?&nbsp;list&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CookieHeader.valueOf(request).getCookies().isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Set&amp;lt;String&amp;gt;&nbsp;keySet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies().keySet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;size()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CookieHeader.valueOf(request).getCookies().size();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies().toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Collection&amp;lt;List&amp;lt;Cookie&amp;gt;&amp;gt;&nbsp;values()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies().values();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;&nbsp;cookies()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;&nbsp;cookies&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;TreeMap&amp;lt;String,&nbsp;List&amp;lt;Cookie&amp;gt;&amp;gt;(String.CASE_INSENSITIVE_ORDER);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;Cookie&nbsp;cookie&nbsp;:&nbsp;CookieHeader.valueOf(request).getCookies())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;Cookie&amp;gt;&nbsp;list&nbsp;=&nbsp;cookies.get(cookie.getName());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(list&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookies.put(cookie.getName(),&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;Cookie&amp;gt;(1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(cookie);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/RequestCookies.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpResponsejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Response.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Response.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Response.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,200&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;response&nbsp;message.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Response&nbsp;extends&nbsp;MessageImpl&amp;lt;Response&amp;gt;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;response&nbsp;status&nbsp;reason.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;reason;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;response&nbsp;status&nbsp;code.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Integer&nbsp;status;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;response&nbsp;status&nbsp;reason.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;response&nbsp;status&nbsp;reason.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getReason()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;reason;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;response&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;response&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Integer&nbsp;getStatus()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;status;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;setEntity(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setEntity0(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;response&nbsp;status&nbsp;reason.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;reason<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;response&nbsp;status&nbsp;reason.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;setReason(final&nbsp;String&nbsp;reason)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.reason&nbsp;=&nbsp;reason;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;response&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;status<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;response&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;setStatus(final&nbsp;Integer&nbsp;status)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.status&nbsp;=&nbsp;status;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;response&nbsp;status&nbsp;code&nbsp;and&nbsp;reason&nbsp;as&nbsp;per&nbsp;RFC&nbsp;2616&nbsp;§6.1.1.&nbsp;If&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;status&nbsp;code&nbsp;is&nbsp;unrecognized,&nbsp;then&nbsp;&amp;quot;{@code&nbsp;Uncertain}&amp;quot;&nbsp;is&nbsp;used.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;status<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;response&nbsp;status&nbsp;code.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;setStatusAndReason(final&nbsp;Integer&nbsp;status)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.status&nbsp;=&nbsp;status;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.reason&nbsp;=&nbsp;status&nbsp;!=&nbsp;null&nbsp;?&nbsp;getReason(status)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;setVersion(String&nbsp;version)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setVersion0(version);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;getReason(int&nbsp;status)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(status)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;100:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Continue&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;101:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Switching&nbsp;Protocols&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;200:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;OK&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;201:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Created&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;202:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Accepted&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;203:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Non-Authoritative&nbsp;Information&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;204:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;No&nbsp;Content&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;205:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Reset&nbsp;Content&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;206:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Partial&nbsp;Content&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;300:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Multiple&nbsp;Choices&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;301:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Moved&nbsp;Permanently&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;302:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Found&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;303:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;See&nbsp;Other&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;304:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Not&nbsp;Modified&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;305:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Use&nbsp;Proxy&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;307:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Temporary&nbsp;Redirect&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;400:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Bad&nbsp;Request&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;401:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Unauthorized&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;402:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Payment&nbsp;Required&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;403:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Forbidden&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;404:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Not&nbsp;Found&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;405:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Method&nbsp;Not&nbsp;Allowed&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;406:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Not&nbsp;Acceptable&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;407:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Proxy&nbsp;Authentication&nbsp;Required&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;408:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Request&nbsp;Time-out&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;409:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Conflict&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;410:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Gone&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;411:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Length&nbsp;Required&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;412:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Precondition&nbsp;Failed&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;413:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Request&nbsp;Entity&nbsp;Too&nbsp;Large&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;414:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Request-URI&nbsp;Too&nbsp;Large&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;415:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Unsupported&nbsp;Media&nbsp;Type&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;416:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Requested&nbsp;range&nbsp;not&nbsp;satisfiable&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;417:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Expectation&nbsp;Failed&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;500:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Internal&nbsp;Server&nbsp;Error&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;501:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Not&nbsp;Implemented&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;502:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Bad&nbsp;Gateway&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;503:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Service&nbsp;Unavailable&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;504:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Gateway&nbsp;Time-out&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;505:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;HTTP&nbsp;Version&nbsp;not&nbsp;supported&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;Uncertain&amp;quot;;&nbsp;//&nbsp;not&nbsp;specified&nbsp;per&nbsp;RFC&nbsp;2616<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;response&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;error.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;response&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;error.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isError()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getStatus()&nbsp;&amp;lt;&nbsp;200&nbsp;||&nbsp;getStatus()&nbsp;&amp;gt;=&nbsp;300;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Response.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpResponseExceptionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ResponseException.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ResponseException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ResponseException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,55&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;HTTP&nbsp;error.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;TODO:&nbsp;re-use&nbsp;CREST&nbsp;ResourceException?<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ResponseException&nbsp;extends&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;7012424171155584261L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Response&nbsp;response;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResponseException(int&nbsp;status)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;Response().setStatusAndReason(status));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResponseException(int&nbsp;status,&nbsp;String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;Response().setStatusAndReason(status),&nbsp;message);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResponseException(final&nbsp;Response&nbsp;response)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(response,&nbsp;response.getReason());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResponseException(final&nbsp;Response&nbsp;response,&nbsp;String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(response,&nbsp;message,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResponseException(final&nbsp;Response&nbsp;response,&nbsp;String&nbsp;message,&nbsp;final&nbsp;Throwable&nbsp;cause)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message,&nbsp;cause);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.response&nbsp;=&nbsp;response;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;getResponse()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;response;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/ResponseException.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Session.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Session.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Session.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,40&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;interface&nbsp;for&nbsp;managing&nbsp;attributes&nbsp;across&nbsp;multiple&nbsp;requests&nbsp;from&nbsp;the&nbsp;same&nbsp;user&nbsp;agent.<br>
+&nbsp;*&nbsp;Implementations&nbsp;should&nbsp;expose&nbsp;underlying&nbsp;container&nbsp;session&nbsp;attributes&nbsp;through&nbsp;this<br>
+&nbsp;*&nbsp;interface&nbsp;if&nbsp;applicable.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;New&nbsp;keys&nbsp;added&nbsp;to&nbsp;a&nbsp;session&nbsp;object&nbsp;should&nbsp;be&nbsp;named&nbsp;in&nbsp;a&nbsp;manner&nbsp;that&nbsp;avoids&nbsp;possible<br>
+&nbsp;*&nbsp;collision&nbsp;with&nbsp;keys&nbsp;added&nbsp;by&nbsp;other&nbsp;objects&nbsp;in&nbsp;the&nbsp;heap.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Session&nbsp;extends&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Save&nbsp;the&nbsp;session&nbsp;state&nbsp;to&nbsp;the&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;response&nbsp;The&nbsp;{@link&nbsp;Response}&nbsp;instance&nbsp;to&nbsp;write&nbsp;the&nbsp;session&nbsp;state&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException&nbsp;If&nbsp;an&nbsp;I/O&nbsp;error&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;save(Response&nbsp;response)&nbsp;throws&nbsp;IOException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/Session.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionFilterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionFilter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionFilter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionFilter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,76&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.HttpApplication.LOGGER;<br>
+<br>
+import&nbsp;org.forgerock.util.Reject;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.util.promise.FailureHandler;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+import&nbsp;org.forgerock.util.promise.SuccessHandler;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Filter&nbsp;implementation&nbsp;that&nbsp;uses&nbsp;a&nbsp;{@link&nbsp;SessionManager}&nbsp;to&nbsp;set&nbsp;the&nbsp;{@link&nbsp;Session}&nbsp;in&nbsp;the&nbsp;{@link&nbsp;HttpContext}.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;The&nbsp;previous&nbsp;{@code&nbsp;Session}&nbsp;value&nbsp;will&nbsp;be&nbsp;saved&nbsp;and&nbsp;restored&nbsp;after&nbsp;the&nbsp;{@code&nbsp;Handler}&nbsp;has&nbsp;been&nbsp;executed.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+class&nbsp;SessionFilter&nbsp;implements&nbsp;Filter&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;SessionManager&nbsp;sessionManager;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;SessionFilter(SessionManager&nbsp;sessionManager)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reject.ifNull(sessionManager,&nbsp;&amp;quot;sessionManager&nbsp;must&nbsp;not&nbsp;be&nbsp;null&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.sessionManager&nbsp;=&nbsp;sessionManager;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;filter(Context&nbsp;context,&nbsp;Request&nbsp;request,&nbsp;Handler&nbsp;next)&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;HttpContext&nbsp;httpContext&nbsp;=&nbsp;context.asContext(HttpContext.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Session&nbsp;oldSession&nbsp;=&nbsp;httpContext.getSession();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpContext.setSession(sessionManager.load(request));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;next.handle(context,&nbsp;request)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(new&nbsp;SuccessHandler&amp;lt;Response&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;handleResult(Response&nbsp;response)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveSession(httpContext.getSession(),&nbsp;response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;new&nbsp;FailureHandler&amp;lt;ResponseException&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;handleError(ResponseException&nbsp;error)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveSession(httpContext.getSession(),&nbsp;error.getResponse());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.thenAlways(new&nbsp;Runnable()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;run()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpContext.setSession(oldSession);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;saveSession(Session&nbsp;session,&nbsp;Response&nbsp;response)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sessionManager.save(session,&nbsp;response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.error(&amp;quot;Failed&nbsp;to&nbsp;save&nbsp;session&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionFilter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpSessionManagerjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionManager.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionManager.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionManager.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,42&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;A&nbsp;SessionFactory&nbsp;is&nbsp;responsible&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;type&nbsp;of&nbsp;{@link&nbsp;Session}.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;This&nbsp;allows&nbsp;users&nbsp;to&nbsp;extends&nbsp;the&nbsp;default&nbsp;OpenIG&nbsp;behaviour&nbsp;quite&nbsp;easily.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;SessionManager&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Loads&nbsp;a&nbsp;new&nbsp;Session&nbsp;for&nbsp;the&nbsp;given&nbsp;{@link&nbsp;Request}.&nbsp;The&nbsp;implementations&nbsp;are&nbsp;free&nbsp;to&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;Request}.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;The&nbsp;session&nbsp;object&nbsp;is&nbsp;scoped&nbsp;by&nbsp;the&nbsp;{@code&nbsp;Request}'s&nbsp;own&nbsp;lifecycle.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;Request&nbsp;to&nbsp;create&nbsp;a&nbsp;session&nbsp;for.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;new&nbsp;Session&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Session&nbsp;load(Request&nbsp;request);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;save(Session&nbsp;session,&nbsp;Response&nbsp;response)&nbsp;throws&nbsp;IOException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/SessionManager.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpURIUtiljava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/URIUtil.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/URIUtil.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/URIUtil.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,174&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;java.io.UnsupportedEncodingException;<br>
+import&nbsp;java.net.URI;<br>
+import&nbsp;java.net.URISyntaxException;<br>
+import&nbsp;java.net.URLDecoder;<br>
+import&nbsp;java.net.URLEncoder;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Utility&nbsp;class&nbsp;for&nbsp;performing&nbsp;operations&nbsp;on&nbsp;universal&nbsp;resource&nbsp;identifiers.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;URIUtil&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Static&nbsp;methods&nbsp;only.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;URIUtil()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;hierarchical&nbsp;URI&nbsp;constructed&nbsp;from&nbsp;the&nbsp;given&nbsp;components.&nbsp;Differs&nbsp;from&nbsp;the&nbsp;URI<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;constructor&nbsp;by&nbsp;accepting&nbsp;raw&nbsp;versions&nbsp;of&nbsp;userInfo,&nbsp;path,&nbsp;query&nbsp;and&nbsp;fragment&nbsp;components.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;scheme&nbsp;the&nbsp;scheme&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawUserInfo&nbsp;the&nbsp;raw&nbsp;user-information&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;host&nbsp;the&nbsp;host&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;port&nbsp;the&nbsp;port&nbsp;number&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;-1}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawPath&nbsp;the&nbsp;raw&nbsp;path&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawQuery&nbsp;the&nbsp;raw&nbsp;query&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawFragment&nbsp;the&nbsp;raw&nbsp;fragment&nbsp;component&nbsp;of&nbsp;the&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;URI&nbsp;constructed&nbsp;from&nbsp;the&nbsp;given&nbsp;components.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;URISyntaxException&nbsp;if&nbsp;the&nbsp;resulting&nbsp;URI&nbsp;would&nbsp;be&nbsp;malformed&nbsp;per&nbsp;RFC&nbsp;2396.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;URI&nbsp;create(String&nbsp;scheme,&nbsp;String&nbsp;rawUserInfo,&nbsp;String&nbsp;host,&nbsp;int&nbsp;port,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;rawPath,&nbsp;String&nbsp;rawQuery,&nbsp;String&nbsp;rawFragment)&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(scheme&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(scheme).append(':');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(host&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;//&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rawUserInfo&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(rawUserInfo).append('@');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(host&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(host);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(port&nbsp;!=&nbsp;-1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(':').append(Integer.toString(port));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rawPath&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(rawPath);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rawQuery&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append('?').append(rawQuery);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rawFragment&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;#&amp;quot;).append(rawFragment);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;URI(sb.toString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Changes&nbsp;the&nbsp;base&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port&nbsp;of&nbsp;a&nbsp;request&nbsp;to&nbsp;that&nbsp;specified&nbsp;in&nbsp;a&nbsp;base&nbsp;URI,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;or&nbsp;leaves&nbsp;them&nbsp;unchanged&nbsp;if&nbsp;the&nbsp;base&nbsp;URI&nbsp;is&nbsp;{@code&nbsp;null}.&nbsp;This&nbsp;implementation&nbsp;only<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;uses&nbsp;scheme,&nbsp;host&nbsp;and&nbsp;port.&nbsp;The&nbsp;remaining&nbsp;components&nbsp;of&nbsp;the&nbsp;URI&nbsp;remain&nbsp;intact.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;the&nbsp;URI&nbsp;whose&nbsp;base&nbsp;is&nbsp;to&nbsp;be&nbsp;changed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;base&nbsp;the&nbsp;URI&nbsp;to&nbsp;base&nbsp;the&nbsp;other&nbsp;URI&nbsp;on.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;the&nbsp;URI&nbsp;with&nbsp;the&nbsp;new&nbsp;established&nbsp;base.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;URI&nbsp;rebase(URI&nbsp;uri,&nbsp;URI&nbsp;base)&nbsp;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(base&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;scheme&nbsp;=&nbsp;base.getScheme();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;host&nbsp;=&nbsp;base.getHost();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;port&nbsp;=&nbsp;base.getPort();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(scheme&nbsp;==&nbsp;null&nbsp;||&nbsp;host&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;create(scheme,&nbsp;uri.getRawUserInfo(),&nbsp;host,&nbsp;port,&nbsp;uri.getRawPath(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.getRawQuery(),&nbsp;uri.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(URISyntaxException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;new&nbsp;URI&nbsp;having&nbsp;the&nbsp;provided&nbsp;query&nbsp;parameters.&nbsp;The&nbsp;scheme,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;authority,&nbsp;path,&nbsp;and&nbsp;fragment&nbsp;remain&nbsp;unchanged.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;URI&nbsp;whose&nbsp;query&nbsp;is&nbsp;to&nbsp;be&nbsp;changed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;query<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;form&nbsp;containing&nbsp;the&nbsp;query&nbsp;parameters.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;new&nbsp;URI&nbsp;having&nbsp;the&nbsp;provided&nbsp;query&nbsp;parameters.&nbsp;The&nbsp;scheme,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;authority,&nbsp;path,&nbsp;and&nbsp;fragment&nbsp;remain&nbsp;unchanged.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;URI&nbsp;withQuery(final&nbsp;URI&nbsp;uri,&nbsp;final&nbsp;Form&nbsp;query)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;create(uri.getScheme(),&nbsp;uri.getRawUserInfo(),&nbsp;uri.getHost(),&nbsp;uri.getPort(),&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getRawPath(),&nbsp;query.toString(),&nbsp;uri.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;URISyntaxException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;new&nbsp;URI&nbsp;having&nbsp;the&nbsp;same&nbsp;scheme,&nbsp;authority&nbsp;and&nbsp;path,&nbsp;but&nbsp;no<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;query&nbsp;nor&nbsp;fragment.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;URI&nbsp;whose&nbsp;query&nbsp;and&nbsp;fragments&nbsp;are&nbsp;to&nbsp;be&nbsp;removed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;new&nbsp;URI&nbsp;having&nbsp;the&nbsp;same&nbsp;scheme,&nbsp;authority&nbsp;and&nbsp;path,&nbsp;but&nbsp;no<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query&nbsp;nor&nbsp;fragment.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;URI&nbsp;withoutQueryAndFragment(final&nbsp;URI&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;URI(uri.getScheme(),&nbsp;uri.getAuthority(),&nbsp;uri.getPath(),&nbsp;null,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(final&nbsp;URISyntaxException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;decoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;string&nbsp;to&nbsp;be&nbsp;URL&nbsp;decoded,&nbsp;which&nbsp;may&nbsp;be&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;URL&nbsp;decoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;string,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;string}&nbsp;was&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;urlDecode(String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value&nbsp;!=&nbsp;null&nbsp;?&nbsp;URLDecoder.decode(value,&nbsp;&amp;quot;UTF-8&amp;quot;)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(UnsupportedEncodingException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;encoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;string&nbsp;to&nbsp;be&nbsp;URL&nbsp;encoded,&nbsp;which&nbsp;may&nbsp;be&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;URL&nbsp;encoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;string,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;string}&nbsp;was&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;urlEncode(String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value&nbsp;!=&nbsp;null&nbsp;?&nbsp;URLEncoder.encode(value,&nbsp;&amp;quot;UTF-8&amp;quot;)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(UnsupportedEncodingException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/URIUtil.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderDecoderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/Decoder.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/Decoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/Decoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,56&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.decoder;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.http.util.CaseInsensitiveMap;<br>
+import&nbsp;org.forgerock.http.util.Indexed;<br>
+import&nbsp;org.forgerock.http.util.Loader;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Decodes&nbsp;an&nbsp;HTTP&nbsp;message&nbsp;entity&nbsp;input&nbsp;stream.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Decoder&nbsp;extends&nbsp;Indexed&amp;lt;String&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Mapping&nbsp;of&nbsp;supported&nbsp;codings&nbsp;to&nbsp;associated&nbsp;decoders.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;Decoder&amp;gt;&nbsp;SERVICES&nbsp;=&nbsp;Collections.unmodifiableMap(new&nbsp;CaseInsensitiveMap&amp;lt;Decoder&amp;gt;(Loader.loadMap(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String.class,&nbsp;Decoder.class)));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;coding&nbsp;that&nbsp;the&nbsp;decoder&nbsp;supports,&nbsp;as&nbsp;it&nbsp;would&nbsp;appear&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;coding&nbsp;that&nbsp;the&nbsp;decoder&nbsp;supports,&nbsp;as&nbsp;it&nbsp;would&nbsp;appear&nbsp;in&nbsp;the&nbsp;{@code&nbsp;Content-Encoding}&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getKey();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;instance&nbsp;of&nbsp;an&nbsp;input&nbsp;stream&nbsp;that&nbsp;decodes&nbsp;the&nbsp;specified&nbsp;input.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;input&nbsp;stream&nbsp;to&nbsp;be&nbsp;decoded.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;an&nbsp;input&nbsp;stream&nbsp;exposing&nbsp;the&nbsp;decoded&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs&nbsp;during&nbsp;decoding.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;decode(InputStream&nbsp;in)&nbsp;throws&nbsp;IOException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/Decoder.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderDeflateDecoderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/DeflateDecoder.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/DeflateDecoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/DeflateDecoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,40&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.decoder;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.util.zip.Inflater;<br>
+import&nbsp;java.util.zip.InflaterInputStream;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Decodes&nbsp;an&nbsp;entity&nbsp;encoded&nbsp;with&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;deflate}&amp;lt;/strong&amp;gt;&nbsp;encoding.&nbsp;See<br>
+&nbsp;*&nbsp;in&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§3.5&nbsp;for&nbsp;more&nbsp;information.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;DeflateDecoder&nbsp;implements&nbsp;Decoder&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getKey()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;deflate&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;InputStream&nbsp;decode(InputStream&nbsp;in)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;InflaterInputStream(in,&nbsp;new&nbsp;Inflater(true));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/DeflateDecoder.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderGzipDecoderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/GzipDecoder.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/GzipDecoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/GzipDecoder.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,39&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.decoder;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.util.zip.GZIPInputStream;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Decodes&nbsp;an&nbsp;entity&nbsp;encoded&nbsp;with&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;gzip}&amp;lt;/strong&amp;gt;&nbsp;encoding.&nbsp;See<br>
+&nbsp;*&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§3.5&nbsp;for&nbsp;more&nbsp;information.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;GzipDecoder&nbsp;implements&nbsp;Decoder&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getKey()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&amp;quot;gzip&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;InputStream&nbsp;decode(InputStream&nbsp;in)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;GZIPInputStream(in);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/GzipDecoder.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpdecoderpackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,21&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Decodes&nbsp;HTTP&nbsp;entities&nbsp;that&nbsp;are&nbsp;compressed&nbsp;or&nbsp;encoded.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.decoder;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/decoder/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderConnectionHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ConnectionHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ConnectionHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ConnectionHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,98&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseMultiValuedHeader;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Connection}&amp;lt;/strong&amp;gt;&nbsp;message&nbsp;header.&nbsp;For&nbsp;more<br>
+&nbsp;*&nbsp;information,&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;<br>
+&nbsp;*&nbsp;§14.10.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ConnectionHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ConnectionHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ConnectionHeader(parseMultiValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ConnectionHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ConnectionHeader(parseMultiValuedHeader(string));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Connection&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;A&nbsp;list&nbsp;of&nbsp;connection&nbsp;tokens.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;tokens;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ConnectionHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;ArrayList&amp;lt;String&amp;gt;(1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;connection&nbsp;tokens.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;tokens<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;connection&nbsp;tokens.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ConnectionHeader(final&nbsp;List&amp;lt;String&amp;gt;&nbsp;tokens)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.tokens&nbsp;=&nbsp;tokens;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;list&nbsp;of&nbsp;connection&nbsp;tokens.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;list&nbsp;of&nbsp;connection&nbsp;tokens.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;String&amp;gt;&nbsp;getTokens()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tokens;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;will&nbsp;return&nbsp;null&nbsp;if&nbsp;empty<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HeaderUtil.join(tokens,&nbsp;',');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ConnectionHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentEncodingHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentEncodingHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentEncodingHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentEncodingHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,128&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseMultiValuedHeader;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.io.UnsupportedEncodingException;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.ListIterator;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+import&nbsp;org.forgerock.http.decoder.Decoder;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Content-Encoding}&amp;lt;/strong&amp;gt;&nbsp;message&nbsp;header.&nbsp;For<br>
+&nbsp;*&nbsp;more&nbsp;information,&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC<br>
+&nbsp;*&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§14.11.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ContentEncodingHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Content-Encoding&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;content&nbsp;coding,&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;are&nbsp;applied&nbsp;to&nbsp;the&nbsp;entity.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;codings;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentEncodingHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;ArrayList&amp;lt;String&amp;gt;(1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;content&nbsp;encodings.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;codings<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;content&nbsp;encodings.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentEncodingHeader(final&nbsp;List&amp;lt;String&amp;gt;&nbsp;codings)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.codings&nbsp;=&nbsp;codings;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentEncodingHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ContentEncodingHeader(parseMultiValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentEncodingHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ContentEncodingHeader(parseMultiValuedHeader(string));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;input&nbsp;stream&nbsp;that&nbsp;decodes&nbsp;the&nbsp;specified&nbsp;input&nbsp;stream,&nbsp;given<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;content-codings&nbsp;that&nbsp;are&nbsp;specified&nbsp;in&nbsp;the&nbsp;{@code&nbsp;codings}&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;input&nbsp;stream&nbsp;to&nbsp;decode.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;an&nbsp;input&nbsp;stream&nbsp;that&nbsp;provides&nbsp;the&nbsp;decoded&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedEncodingException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;unsupported&nbsp;content-encoding&nbsp;is&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;InputStream&nbsp;decode(InputStream&nbsp;in)&nbsp;throws&nbsp;IOException,&nbsp;UnsupportedEncodingException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;decode&nbsp;in&nbsp;the&nbsp;reverse&nbsp;order&nbsp;that&nbsp;encoding&nbsp;was&nbsp;applied<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ListIterator&amp;lt;String&amp;gt;&nbsp;i&nbsp;=&nbsp;codings.listIterator(codings.size());&nbsp;i.hasPrevious();)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;name&nbsp;=&nbsp;i.previous();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decoder&nbsp;decoder&nbsp;=&nbsp;Decoder.SERVICES.get(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(decoder&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;UnsupportedEncodingException(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;=&nbsp;decoder.decode(in);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;in;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;list&nbsp;of&nbsp;content&nbsp;codings.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;list&nbsp;of&nbsp;content&nbsp;codings.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;String&amp;gt;&nbsp;getCodings()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;codings;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;will&nbsp;return&nbsp;null&nbsp;if&nbsp;empty<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;HeaderUtil.join(codings,&nbsp;',');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentEncodingHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentLengthHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentLengthHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentLengthHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentLengthHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,106&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseSingleValuedHeader;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Content-Length}&amp;lt;/strong&amp;gt;&nbsp;message&nbsp;header.&nbsp;For<br>
+&nbsp;*&nbsp;more&nbsp;information,&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC<br>
+&nbsp;*&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§14.13.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ContentLengthHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentLengthHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(parseSingleValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentLengthHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;length&nbsp;=&nbsp;-1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(string&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length&nbsp;=&nbsp;Long.parseLong(string);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length&nbsp;=&nbsp;length&nbsp;&amp;gt;=&nbsp;0&nbsp;?&nbsp;length&nbsp;:&nbsp;-1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(NumberFormatException&nbsp;nfe)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;will&nbsp;remain&nbsp;default&nbsp;of&nbsp;-1&nbsp;from&nbsp;clear()&nbsp;call&nbsp;above<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ContentLengthHeader(length);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Content-Length&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;content&nbsp;length,&nbsp;or&nbsp;{@code&nbsp;-1}&nbsp;if&nbsp;not&nbsp;specified.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;long&nbsp;length;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header&nbsp;whose&nbsp;length&nbsp;is&nbsp;set&nbsp;to&nbsp;-1.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentLengthHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;content&nbsp;length.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;content&nbsp;length,&nbsp;or&nbsp;{@code&nbsp;-1}&nbsp;if&nbsp;no&nbsp;content&nbsp;length&nbsp;has<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;been&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentLengthHeader(long&nbsp;length)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.length&nbsp;=&nbsp;length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;content&nbsp;length,&nbsp;or&nbsp;{@code&nbsp;-1}&nbsp;if&nbsp;no&nbsp;content&nbsp;length&nbsp;has&nbsp;been<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;content&nbsp;length,&nbsp;or&nbsp;{@code&nbsp;-1}&nbsp;if&nbsp;no&nbsp;content&nbsp;length&nbsp;has&nbsp;been<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;long&nbsp;getLength()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;length&nbsp;&amp;gt;=&nbsp;0&nbsp;?&nbsp;Long.toString(length)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentLengthHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderContentTypeHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentTypeHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentTypeHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentTypeHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,158&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseSingleValuedHeader;<br>
+<br>
+import&nbsp;java.nio.charset.Charset;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Content-Type}&amp;lt;/strong&amp;gt;&nbsp;message&nbsp;header.&nbsp;For&nbsp;more<br>
+&nbsp;*&nbsp;information,&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;<br>
+&nbsp;*&nbsp;§14.17.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;ContentTypeHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentTypeHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(parseSingleValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ContentTypeHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;String&amp;gt;&nbsp;parts&nbsp;=&nbsp;HeaderUtil.split(string,&nbsp;';');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(parts.size()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;type&nbsp;=&nbsp;parts.get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;parameters&nbsp;=&nbsp;HeaderUtil.parseParameters(parts);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;charset&nbsp;=&nbsp;parameters.get(&amp;quot;charset&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;boundary&nbsp;=&nbsp;parameters.get(&amp;quot;boundary&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ContentTypeHeader(type,&nbsp;charset,&nbsp;boundary);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ContentTypeHeader(null,&nbsp;null,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Content-Type&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;type/sub-type&nbsp;of&nbsp;the&nbsp;message.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;type;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;character&nbsp;set&nbsp;used&nbsp;in&nbsp;encoding&nbsp;the&nbsp;message.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;charset;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;boundary&nbsp;value&nbsp;provided&nbsp;in&nbsp;multipart&nbsp;messages.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;boundary;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header&nbsp;whose&nbsp;type,&nbsp;charset,&nbsp;and&nbsp;boundary&nbsp;are&nbsp;all<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentTypeHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(null,&nbsp;null,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;parameters.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;type/sub-type&nbsp;of&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;charset<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;character&nbsp;set&nbsp;used&nbsp;in&nbsp;encoding&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;boundary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;boundary&nbsp;value&nbsp;provided&nbsp;in&nbsp;multipart&nbsp;messages.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ContentTypeHeader(String&nbsp;type,&nbsp;String&nbsp;charset,&nbsp;String&nbsp;boundary)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.type&nbsp;=&nbsp;type;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.charset&nbsp;=&nbsp;charset;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.boundary&nbsp;=&nbsp;boundary;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;media&nbsp;type&nbsp;of&nbsp;the&nbsp;underlying&nbsp;data&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;media&nbsp;type&nbsp;of&nbsp;the&nbsp;underlying&nbsp;data&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getType()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;type;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;character&nbsp;set&nbsp;encoding&nbsp;used&nbsp;to&nbsp;encode&nbsp;the&nbsp;message,&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;no&nbsp;character&nbsp;set&nbsp;was&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;character&nbsp;set&nbsp;encoding&nbsp;used&nbsp;to&nbsp;encode&nbsp;the&nbsp;message&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;java.nio.charset.IllegalCharsetNameException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;given&nbsp;charset&nbsp;name&nbsp;is&nbsp;illegal.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;java.nio.charset.UnsupportedCharsetException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;no&nbsp;support&nbsp;for&nbsp;the&nbsp;named&nbsp;charset&nbsp;is&nbsp;available.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Charset&nbsp;getCharset()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;charset&nbsp;!=&nbsp;null&nbsp;?&nbsp;Charset.forName(charset)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;encapsulation&nbsp;boundary&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;encapsulation&nbsp;boundary&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;none&nbsp;specified.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getBoundary()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;boundary;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(type&nbsp;==&nbsp;null&nbsp;||&nbsp;type.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(type);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(charset&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;charset=&amp;quot;).append(charset);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(boundary&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;boundary=&amp;quot;).append(boundary);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.length()&nbsp;&amp;gt;&nbsp;0&nbsp;?&nbsp;sb.toString()&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/ContentTypeHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderCookieHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/CookieHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/CookieHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/CookieHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,202&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseMultiValuedHeader;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.http.Cookie;<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Cookie}&amp;lt;/strong&amp;gt;&nbsp;request&nbsp;message&nbsp;header.&nbsp;For<br>
+&nbsp;*&nbsp;more&nbsp;information,&nbsp;see&nbsp;the&nbsp;original&nbsp;&amp;lt;a&nbsp;href=<br>
+&nbsp;*&nbsp;&amp;quot;http://web.archive.org/web/20070805052634/http://wp.netscape.com/newsref/std/cookie_spec.html&amp;quot;<br>
+&nbsp;*&nbsp;&amp;gt;&nbsp;Netscape&nbsp;specification&amp;lt;/a&amp;gt;,&nbsp;&amp;lt;a<br>
+&nbsp;*&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2109.txt&amp;quot;&amp;gt;RFC&nbsp;2109&amp;lt;/a&amp;gt;&nbsp;and&nbsp;&amp;lt;a<br>
+&nbsp;*&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2965.txt&amp;quot;&amp;gt;RFC&nbsp;2965&amp;lt;/a&amp;gt;.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;Note:&nbsp;This&nbsp;implementation&nbsp;is&nbsp;designed&nbsp;to&nbsp;be&nbsp;forgiving&nbsp;when&nbsp;parsing&nbsp;malformed<br>
+&nbsp;*&nbsp;cookies.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;CookieHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;CookieHeader&nbsp;valueOf(final&nbsp;List&amp;lt;String&amp;gt;&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;Cookie&amp;gt;&nbsp;cookies&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;Cookie&amp;gt;(values.size());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer&nbsp;version&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;new&nbsp;Cookie();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;s1&nbsp;:&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;s2&nbsp;:&nbsp;HeaderUtil.split(s1,&nbsp;';'))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;nvp&nbsp;=&nbsp;HeaderUtil.parseParameter(s2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nvp[0].length()&nbsp;&amp;gt;&nbsp;0&nbsp;&amp;amp;&amp;amp;&nbsp;nvp[0].charAt(0)&nbsp;!=&nbsp;'$')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getName()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;existing&nbsp;cookie&nbsp;was&nbsp;being&nbsp;parsed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookies.add(cookie);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie&nbsp;=&nbsp;new&nbsp;Cookie();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inherit&nbsp;previous&nbsp;parsed&nbsp;version<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setVersion(version);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setName(nvp[0]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setValue(nvp[1]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(&amp;quot;$Version&amp;quot;.equalsIgnoreCase(nvp[0]))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setVersion(version&nbsp;=&nbsp;parseInteger(nvp[1]));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(&amp;quot;$Path&amp;quot;.equalsIgnoreCase(nvp[0]))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setPath(nvp[1]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(&amp;quot;$Domain&amp;quot;.equalsIgnoreCase(nvp[0]))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.setDomain(nvp[1]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(&amp;quot;$Port&amp;quot;.equalsIgnoreCase(nvp[0]))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookie.getPort().clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parsePorts(cookie.getPort(),&nbsp;nvp[1]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getName()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;last&nbsp;cookie&nbsp;being&nbsp;parsed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cookies.add(cookie);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;CookieHeader(cookies);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;void&nbsp;parsePorts(List&amp;lt;Integer&amp;gt;&nbsp;list,&nbsp;String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;port&nbsp;:&nbsp;s.split(&amp;quot;,&amp;quot;))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer&nbsp;p&nbsp;=&nbsp;parseInteger(port);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(p&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(p);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Integer&nbsp;parseInteger(String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Integer.valueOf(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(NumberFormatException&nbsp;nfe)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;CookieHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(parseMultiValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;CookieHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(parseMultiValuedHeader(string));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Cookie&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Request&nbsp;message&nbsp;cookies.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;Cookie&amp;gt;&nbsp;cookies;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CookieHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(new&nbsp;ArrayList&amp;lt;Cookie&amp;gt;(1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;cookies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;cookies<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;cookies.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CookieHeader(List&amp;lt;Cookie&amp;gt;&nbsp;cookies)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.cookies&nbsp;=&nbsp;cookies;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;cookies'&nbsp;request&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;cookies'&nbsp;request&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;List&amp;lt;Cookie&amp;gt;&nbsp;getCookies()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cookies;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;quoted&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer&nbsp;version&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Cookie&nbsp;cookie&nbsp;:&nbsp;cookies)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getVersion()&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;(version&nbsp;==&nbsp;null&nbsp;||&nbsp;cookie.getVersion()&nbsp;&amp;gt;&nbsp;version))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;cookie.getVersion();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(version&nbsp;==&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;(cookie.getPath()&nbsp;!=&nbsp;null&nbsp;||&nbsp;cookie.getDomain()&nbsp;!=&nbsp;null))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;presence&nbsp;of&nbsp;extended&nbsp;fields&nbsp;makes&nbsp;it&nbsp;version&nbsp;1&nbsp;at&nbsp;minimum<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;=&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(version&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;$Version=&amp;quot;).append(version.toString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quoted&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Cookie&nbsp;cookie&nbsp;:&nbsp;cookies)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getName()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sb.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(cookie.getName()).append('=');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(quoted&nbsp;?&nbsp;HeaderUtil.quote(cookie.getValue())&nbsp;:&nbsp;cookie.getValue());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getPath()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;$Path=&amp;quot;).append(HeaderUtil.quote(cookie.getPath()));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getDomain()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;$Domain=&amp;quot;).append(HeaderUtil.quote(cookie.getDomain()));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cookie.getPort().size()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(&amp;quot;;&nbsp;$Port=&amp;quot;).append(HeaderUtil.quote(portList(cookie.getPort())));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return&nbsp;null&nbsp;if&nbsp;empty<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.length()&nbsp;&amp;gt;&nbsp;0&nbsp;?&nbsp;sb.toString()&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;portList(List&amp;lt;Integer&amp;gt;&nbsp;ports)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Integer&nbsp;port&nbsp;:&nbsp;ports)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sb.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(',');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(port.toString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/CookieHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderGenericHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/GenericHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/GenericHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/GenericHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,54&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;undecoded&nbsp;HTTP&nbsp;message&nbsp;header.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;GenericHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;header&nbsp;name.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;name;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;header&nbsp;value.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;value;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;name&nbsp;and&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;header&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;header&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;GenericHeader(String&nbsp;name,&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.value&nbsp;=&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/GenericHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderHeaderUtiljava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/HeaderUtil.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/HeaderUtil.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/HeaderUtil.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,307&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.http.Message;<br>
+import&nbsp;org.forgerock.http.util.CaseInsensitiveMap;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Utility&nbsp;class&nbsp;for&nbsp;processing&nbsp;values&nbsp;in&nbsp;HTTP&nbsp;header&nbsp;fields.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;HeaderUtil&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Static&nbsp;methods&nbsp;only.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;HeaderUtil()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;No&nbsp;implementation&nbsp;required.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;an&nbsp;HTTP&nbsp;header&nbsp;value,&nbsp;splitting&nbsp;it&nbsp;into&nbsp;multiple&nbsp;values&nbsp;around&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;specified&nbsp;separator.&nbsp;Quoted&nbsp;strings&nbsp;are&nbsp;not&nbsp;split&nbsp;into&nbsp;multiple&nbsp;values&nbsp;if<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;they&nbsp;contain&nbsp;separator&nbsp;characters.&nbsp;All&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;white&nbsp;space<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;in&nbsp;values&nbsp;is&nbsp;trimmed.&nbsp;All&nbsp;quotations&nbsp;remain&nbsp;intact.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;is&nbsp;liberal&nbsp;in&nbsp;its&nbsp;interpretation&nbsp;of&nbsp;malformed&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;values;&nbsp;namely&nbsp;the&nbsp;incorrect&nbsp;use&nbsp;of&nbsp;string&nbsp;and&nbsp;character&nbsp;quoting<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;mechanisms&nbsp;and&nbsp;unquoted&nbsp;white&nbsp;space.&nbsp;If&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;or&nbsp;empty&nbsp;string&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;supplied&nbsp;as&nbsp;a&nbsp;value,&nbsp;this&nbsp;method&nbsp;yields&nbsp;an&nbsp;empty&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;header&nbsp;value&nbsp;to&nbsp;be&nbsp;split.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;separator<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;separator&nbsp;character&nbsp;to&nbsp;split&nbsp;headers&nbsp;around.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;list&nbsp;of&nbsp;string&nbsp;representing&nbsp;the&nbsp;split&nbsp;values&nbsp;of&nbsp;the&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;List&amp;lt;String&amp;gt;&nbsp;split(final&nbsp;String&nbsp;value,&nbsp;final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(separator&nbsp;==&nbsp;'&amp;quot;'&nbsp;||&nbsp;separator&nbsp;==&nbsp;'\\')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;invalid&nbsp;separator:&nbsp;&amp;quot;&nbsp;+&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ArrayList&amp;lt;String&amp;gt;&nbsp;values&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;value.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;escaped&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;quoted&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0,&nbsp;cp;&nbsp;n&nbsp;&amp;lt;&nbsp;length;&nbsp;n&nbsp;+=&nbsp;Character.charCount(cp))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;=&nbsp;value.codePointAt(n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(escaped)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;single-character&nbsp;quoting&nbsp;mechanism&nbsp;per&nbsp;RFC&nbsp;2616&nbsp;§2.2<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escaped&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(cp&nbsp;==&nbsp;'\\')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(quoted)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;single-character&nbsp;quoting&nbsp;mechanism&nbsp;per&nbsp;RFC&nbsp;2616&nbsp;§2.2<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escaped&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(cp&nbsp;==&nbsp;'&amp;quot;')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;quotation&nbsp;marks&nbsp;remain&nbsp;intact&nbsp;here<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quoted&nbsp;=&nbsp;!quoted;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(cp&nbsp;==&nbsp;separator&nbsp;&amp;amp;&amp;amp;&nbsp;!quoted)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;only&nbsp;separator&nbsp;if&nbsp;not&nbsp;in&nbsp;quoted&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;s&nbsp;=&nbsp;sb.toString().trim();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values.add(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;reset&nbsp;for&nbsp;next&nbsp;token<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.setLength(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;sb.toString().trim();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values.add(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;values;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Joins&nbsp;a&nbsp;collection&nbsp;of&nbsp;header&nbsp;values&nbsp;into&nbsp;a&nbsp;single&nbsp;header&nbsp;value,&nbsp;with&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;specified&nbsp;specified&nbsp;separator.&nbsp;A&nbsp;{@code&nbsp;null}&nbsp;or&nbsp;empty&nbsp;collection&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;header&nbsp;values&nbsp;yeilds&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;return&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;values<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;values&nbsp;to&nbsp;be&nbsp;joined.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;separator<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;separator&nbsp;to&nbsp;separate&nbsp;values&nbsp;within&nbsp;the&nbsp;returned&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;single&nbsp;header&nbsp;value,&nbsp;with&nbsp;values&nbsp;separated&nbsp;by&nbsp;the&nbsp;separator.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;join(final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;values,&nbsp;final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(separator&nbsp;==&nbsp;'&amp;quot;'&nbsp;||&nbsp;separator&nbsp;==&nbsp;'\\')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;invalid&nbsp;separator:&nbsp;&amp;quot;&nbsp;+&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(values&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;String&nbsp;s&nbsp;:&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sb.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(separator).append('&nbsp;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.length()&nbsp;&amp;gt;&nbsp;0&nbsp;?&nbsp;sb.toString()&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Splits&nbsp;a&nbsp;single&nbsp;HTTP&nbsp;header&nbsp;parameter&nbsp;name&nbsp;and&nbsp;value&nbsp;from&nbsp;an&nbsp;input&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;value.&nbsp;The&nbsp;input&nbsp;string&nbsp;value&nbsp;is&nbsp;presumed&nbsp;to&nbsp;have&nbsp;been&nbsp;extracted&nbsp;from&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;collection&nbsp;provided&nbsp;by&nbsp;the&nbsp;{@link&nbsp;#split(String,&nbsp;char)}&nbsp;method.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;returns&nbsp;the&nbsp;parameter&nbsp;name-value&nbsp;pair&nbsp;split&nbsp;into&nbsp;an&nbsp;array&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;String}s.&nbsp;Element&nbsp;{@code&nbsp;[0]}&nbsp;contains&nbsp;the&nbsp;parameter&nbsp;name;&nbsp;element<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;[1]}&nbsp;contains&nbsp;contains&nbsp;the&nbsp;parameter&nbsp;value&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;there&nbsp;is&nbsp;no&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;A&nbsp;value&nbsp;that&nbsp;is&nbsp;contained&nbsp;within&nbsp;a&nbsp;quoted-string&nbsp;is&nbsp;processed&nbsp;such&nbsp;that<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;surrounding&nbsp;'&amp;quot;'&nbsp;(quotation&nbsp;mark)&nbsp;characters&nbsp;are&nbsp;removed&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;single-character&nbsp;quotations&nbsp;hold&nbsp;the&nbsp;character&nbsp;being&nbsp;quoted&nbsp;without&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;escape&nbsp;'\'&nbsp;(backslash)&nbsp;character.&nbsp;All&nbsp;white&nbsp;space&nbsp;outside&nbsp;of&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;quoted-string&nbsp;is&nbsp;removed.&nbsp;White&nbsp;space&nbsp;within&nbsp;the&nbsp;quoted-string&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;retained.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;is&nbsp;liberal&nbsp;in&nbsp;its&nbsp;interpretation&nbsp;of&nbsp;a&nbsp;malformed&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;value;&nbsp;namely&nbsp;the&nbsp;incorrect&nbsp;use&nbsp;of&nbsp;string&nbsp;and&nbsp;character&nbsp;quoting<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;mechanisms&nbsp;and&nbsp;unquoted&nbsp;white&nbsp;space.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;string&nbsp;to&nbsp;parse&nbsp;the&nbsp;name-value&nbsp;parameter&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;name-value&nbsp;pair&nbsp;split&nbsp;into&nbsp;a&nbsp;{@code&nbsp;String}&nbsp;array.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String[]&nbsp;parseParameter(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;ss&nbsp;=&nbsp;new&nbsp;String[2];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;inValue&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;quoted&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;escaped&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;value.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0,&nbsp;cp;&nbsp;n&nbsp;&amp;lt;&nbsp;length;&nbsp;n&nbsp;+=&nbsp;Character.charCount(cp))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;=&nbsp;value.codePointAt(n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(escaped)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;single-character&nbsp;quoting&nbsp;mechanism&nbsp;per&nbsp;RFC&nbsp;2616&nbsp;§2.2<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escaped&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(cp&nbsp;==&nbsp;'\\')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(quoted)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;next&nbsp;character&nbsp;is&nbsp;literal<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escaped&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;not&nbsp;quoted,&nbsp;push&nbsp;the&nbsp;backslash&nbsp;literal&nbsp;(header&nbsp;probably&nbsp;malformed)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(cp&nbsp;==&nbsp;'&amp;quot;')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;toggle&nbsp;quoted&nbsp;status<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quoted&nbsp;=&nbsp;!quoted;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!quoted&nbsp;&amp;amp;&amp;amp;&nbsp;!inValue&nbsp;&amp;amp;&amp;amp;&nbsp;cp&nbsp;==&nbsp;'=')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;only&nbsp;separator&nbsp;if&nbsp;in&nbsp;key&nbsp;and&nbsp;not&nbsp;in&nbsp;quoted-string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ss[0]&nbsp;=&nbsp;sb.toString().trim();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;reset&nbsp;for&nbsp;next&nbsp;token<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.setLength(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inValue&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!quoted&nbsp;&amp;amp;&amp;amp;&nbsp;Character.isWhitespace(cp))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;drop&nbsp;unquoted&nbsp;white&nbsp;space&nbsp;(header&nbsp;probably&nbsp;malformed&nbsp;if&nbsp;not&nbsp;at&nbsp;beginning&nbsp;or&nbsp;end)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!inValue)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ss[0]&nbsp;=&nbsp;sb.toString().trim();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ss[1]&nbsp;=&nbsp;sb.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ss;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;a&nbsp;set&nbsp;of&nbsp;HTTP&nbsp;header&nbsp;parameters&nbsp;from&nbsp;a&nbsp;collection&nbsp;of&nbsp;values.&nbsp;The<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;input&nbsp;collection&nbsp;of&nbsp;values&nbsp;is&nbsp;presumed&nbsp;to&nbsp;have&nbsp;been&nbsp;provided&nbsp;from&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@link&nbsp;#split(String,&nbsp;char)}&nbsp;method.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;A&nbsp;well-formed&nbsp;parameter&nbsp;contains&nbsp;an&nbsp;attribute&nbsp;and&nbsp;optional&nbsp;value,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;separated&nbsp;by&nbsp;an&nbsp;'='&nbsp;(equals&nbsp;sign)&nbsp;character.&nbsp;If&nbsp;the&nbsp;parameter&nbsp;contains&nbsp;no<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;value,&nbsp;it&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;value&nbsp;in&nbsp;the&nbsp;returned&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Values&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;quoted-strings&nbsp;are&nbsp;processed&nbsp;such&nbsp;that&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;surrounding&nbsp;'&amp;quot;'&nbsp;(quotation&nbsp;mark)&nbsp;characters&nbsp;are&nbsp;removed&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;single-character&nbsp;quotations&nbsp;hold&nbsp;the&nbsp;character&nbsp;being&nbsp;quoted&nbsp;without&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;escape&nbsp;'\'&nbsp;(backslash)&nbsp;character.&nbsp;All&nbsp;white&nbsp;space&nbsp;outside&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;quoted-strings&nbsp;is&nbsp;removed.&nbsp;White&nbsp;space&nbsp;within&nbsp;quoted-strings&nbsp;is&nbsp;retained.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note:&nbsp;This&nbsp;method&nbsp;is&nbsp;liberal&nbsp;in&nbsp;its&nbsp;interpretation&nbsp;of&nbsp;malformed&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;values;&nbsp;namely&nbsp;the&nbsp;incorrect&nbsp;use&nbsp;of&nbsp;string&nbsp;and&nbsp;character&nbsp;quoting<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;mechanisms&nbsp;and&nbsp;unquoted&nbsp;white&nbsp;space.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;values<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;HTTP&nbsp;header&nbsp;parameters.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;map&nbsp;of&nbsp;parameter&nbsp;name-value&nbsp;pairs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;parseParameters(final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CaseInsensitiveMap&amp;lt;String&amp;gt;&nbsp;map&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;CaseInsensitiveMap&amp;lt;String&amp;gt;(new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(values&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;String&nbsp;value&nbsp;:&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String[]&nbsp;param&nbsp;=&nbsp;parseParameter(value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(param[0]&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;param[0].length()&nbsp;&amp;gt;&nbsp;0&nbsp;&amp;amp;&amp;amp;&nbsp;!map.containsKey(param[0]))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(param[0],&nbsp;param[1]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;map;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Encloses&nbsp;a&nbsp;string&nbsp;in&nbsp;quotation&nbsp;marks.&nbsp;Quotation&nbsp;marks&nbsp;and&nbsp;backslash<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;characters&nbsp;are&nbsp;escaped&nbsp;with&nbsp;the&nbsp;single-character&nbsp;quoting&nbsp;mechanism.&nbsp;For<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;more&nbsp;information,&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§2.2.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;value&nbsp;to&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;quotation&nbsp;marks.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;value&nbsp;enclosed&nbsp;in&nbsp;quotation&nbsp;marks.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;quote(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;sb&nbsp;=&nbsp;new&nbsp;StringBuilder(&amp;quot;\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;value.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0,&nbsp;cp;&nbsp;n&nbsp;&amp;lt;&nbsp;length;&nbsp;n&nbsp;+=&nbsp;Character.charCount(cp))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;=&nbsp;value.codePointAt(n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cp&nbsp;==&nbsp;'\\'&nbsp;||&nbsp;cp&nbsp;==&nbsp;'&amp;quot;')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append('\\');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.appendCodePoint(cp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.append('&amp;quot;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sb.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;named&nbsp;header&nbsp;from&nbsp;the&nbsp;message&nbsp;as&nbsp;a&nbsp;multi-valued&nbsp;comma<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;separated&nbsp;value.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;headers&nbsp;present&nbsp;then&nbsp;they&nbsp;are<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;first&nbsp;merged&nbsp;and&nbsp;then&nbsp;{@link&nbsp;#split(String,&nbsp;char)&nbsp;split}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request&nbsp;or&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;list&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;split&nbsp;values&nbsp;of&nbsp;the&nbsp;header,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;may&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;header&nbsp;was&nbsp;not&nbsp;present&nbsp;in&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;List&amp;lt;String&amp;gt;&nbsp;parseMultiValuedHeader(Message&nbsp;message,&nbsp;String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;values&nbsp;=&nbsp;message&nbsp;!=&nbsp;null&nbsp;?&nbsp;message.getHeaders().get(name)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parseMultiValuedHeader(join(values,&nbsp;','));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;header&nbsp;content&nbsp;as&nbsp;a&nbsp;multi-valued&nbsp;comma&nbsp;separated&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;header<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;header&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;list&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;split&nbsp;values&nbsp;of&nbsp;the&nbsp;header,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;may&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;header&nbsp;was&nbsp;{@code&nbsp;null}&nbsp;or&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;List&amp;lt;String&amp;gt;&nbsp;parseMultiValuedHeader(final&nbsp;String&nbsp;header)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;split(header,&nbsp;',');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;named&nbsp;single-valued&nbsp;header&nbsp;from&nbsp;the&nbsp;message.&nbsp;If&nbsp;there&nbsp;are<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;multiple&nbsp;headers&nbsp;present&nbsp;then&nbsp;only&nbsp;the&nbsp;first&nbsp;is&nbsp;used.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request&nbsp;or&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;header&nbsp;value,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;the&nbsp;header&nbsp;was&nbsp;not&nbsp;present<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;parseSingleValuedHeader(Message&nbsp;message,&nbsp;String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;message&nbsp;!=&nbsp;null&nbsp;?&nbsp;message.getHeaders().getFirst(name)&nbsp;:&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/HeaderUtil.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderLocationHeaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/LocationHeader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/LocationHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/LocationHeader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,96&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.HeaderUtil.parseSingleValuedHeader;<br>
+<br>
+import&nbsp;org.forgerock.http.Header;<br>
+import&nbsp;org.forgerock.http.Message;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;the&nbsp;&amp;lt;strong&amp;gt;{@code&nbsp;Location}&amp;lt;/strong&amp;gt;&nbsp;message&nbsp;header.&nbsp;For&nbsp;more<br>
+&nbsp;*&nbsp;information&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;<br>
+&nbsp;*&nbsp;§14.30.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;LocationHeader&nbsp;implements&nbsp;Header&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;message&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;LocationHeader&nbsp;valueOf(final&nbsp;Message&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(parseSingleValuedHeader(message,&nbsp;NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header,&nbsp;initialized&nbsp;from&nbsp;the&nbsp;specified&nbsp;string&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;initialize&nbsp;the&nbsp;header&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;LocationHeader&nbsp;valueOf(final&nbsp;String&nbsp;string)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;LocationHeader(string);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;name&nbsp;of&nbsp;this&nbsp;header.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;NAME&nbsp;=&nbsp;&amp;quot;Location&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;location&nbsp;URI&nbsp;value&nbsp;from&nbsp;the&nbsp;header,&nbsp;or&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;locationUri;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;header&nbsp;whose&nbsp;location&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;LocationHeader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;header&nbsp;with&nbsp;the&nbsp;provided&nbsp;location&nbsp;URI.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;locationUri<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;location&nbsp;URI,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;no&nbsp;location&nbsp;has&nbsp;been&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;LocationHeader(String&nbsp;locationUri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.locationUri&nbsp;=&nbsp;locationUri&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;locationUri.isEmpty()&nbsp;?&nbsp;null&nbsp;:&nbsp;locationUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;location&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;location&nbsp;URI&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getLocationUri()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;locationUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;locationUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/LocationHeader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpheaderpackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,21&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Processes&nbsp;HTTP&nbsp;message&nbsp;header&nbsp;fields.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/header/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBranchingInputStreamjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingInputStream.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingInputStream.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingInputStream.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,54&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;input&nbsp;stream&nbsp;that&nbsp;can&nbsp;branch&nbsp;into&nbsp;separate&nbsp;input&nbsp;streams&nbsp;to&nbsp;perform<br>
+&nbsp;*&nbsp;divergent&nbsp;reads.<br>
+&nbsp;*/<br>
+public&nbsp;abstract&nbsp;class&nbsp;BranchingInputStream&nbsp;extends&nbsp;InputStream&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;branch&nbsp;at&nbsp;this&nbsp;stream's&nbsp;current&nbsp;position.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;new&nbsp;branching&nbsp;stream,&nbsp;in&nbsp;the&nbsp;same&nbsp;position&nbsp;as&nbsp;this&nbsp;branch.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;abstract&nbsp;BranchingInputStream&nbsp;branch()&nbsp;throws&nbsp;IOException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;this&nbsp;branching&nbsp;stream&nbsp;and&nbsp;all&nbsp;of&nbsp;the&nbsp;branches&nbsp;created&nbsp;from&nbsp;it.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;abstract&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;parent&nbsp;branching&nbsp;input&nbsp;stream&nbsp;from&nbsp;which&nbsp;this&nbsp;branch&nbsp;was<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;created,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;trunk.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;parent&nbsp;branching&nbsp;input&nbsp;stream&nbsp;from&nbsp;which&nbsp;this&nbsp;branch&nbsp;was<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;created,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;trunk.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;abstract&nbsp;BranchingInputStream&nbsp;parent();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingInputStream.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBranchingStreamWrapperjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingStreamWrapper.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingStreamWrapper.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingStreamWrapper.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,274&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Wraps&nbsp;an&nbsp;standard&nbsp;input&nbsp;stream&nbsp;with&nbsp;a&nbsp;stream&nbsp;that&nbsp;can&nbsp;branch&nbsp;to&nbsp;perform<br>
+&nbsp;*&nbsp;divergent&nbsp;reads.&nbsp;All&nbsp;divergence&nbsp;between&nbsp;branches&nbsp;is&nbsp;maintained&nbsp;in&nbsp;a&nbsp;temporary<br>
+&nbsp;*&nbsp;buffer.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;This&nbsp;stream&nbsp;and&nbsp;any&nbsp;branches&nbsp;it&nbsp;creates&nbsp;are&nbsp;not&nbsp;safe<br>
+&nbsp;*&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;concurrent&nbsp;threads.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;BranchingStreamWrapper&nbsp;extends&nbsp;BranchingInputStream&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;A&nbsp;shared&nbsp;object&nbsp;by&nbsp;all&nbsp;branches&nbsp;of&nbsp;the&nbsp;same&nbsp;input&nbsp;stream.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Trunk&nbsp;trunk;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Points&nbsp;to&nbsp;this&nbsp;branch's&nbsp;parent.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;BranchingStreamWrapper&nbsp;parent;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;This&nbsp;branch's&nbsp;position&nbsp;relative&nbsp;to&nbsp;the&nbsp;trunk&nbsp;buffer.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;position;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper(InputStream&nbsp;in,&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;bufferFactory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(in&nbsp;instanceof&nbsp;BranchingStreamWrapper)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;branch&nbsp;off&nbsp;of&nbsp;existing&nbsp;trunk<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;bsw&nbsp;=&nbsp;(BranchingStreamWrapper)&nbsp;in;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;=&nbsp;bsw;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk&nbsp;=&nbsp;bsw.trunk;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;=&nbsp;bsw.position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;wrapping&nbsp;a&nbsp;non-wrapping&nbsp;stream;&nbsp;sprout&nbsp;a&nbsp;new&nbsp;trunk<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk&nbsp;=&nbsp;new&nbsp;Trunk(in,&nbsp;bufferFactory);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.branches.add(this);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;BranchingStreamWrapper&nbsp;branch()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;constructor&nbsp;will&nbsp;branch<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;BranchingStreamWrapper(this,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isClosed()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trunk&nbsp;==&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;BranchingStreamWrapper&nbsp;parent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;b&nbsp;=&nbsp;new&nbsp;byte[1];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(read(b,&nbsp;0,&nbsp;1)&nbsp;&amp;gt;&nbsp;0&nbsp;?&nbsp;(b[0]&nbsp;&amp;amp;&nbsp;0xff)&nbsp;:&nbsp;-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(byte[]&nbsp;b)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;read(b,&nbsp;0,&nbsp;b.length);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;try&nbsp;reading&nbsp;from&nbsp;buffer&nbsp;first<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((n&nbsp;=&nbsp;readBuffer(b,&nbsp;off,&nbsp;len))&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;not&nbsp;buffered;&nbsp;cascade&nbsp;the&nbsp;call<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((n&nbsp;=&nbsp;trunk.in.read(b,&nbsp;off,&nbsp;len))&nbsp;&amp;gt;=&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;write&nbsp;result&nbsp;to&nbsp;buffer&nbsp;if&nbsp;necessary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeBuffer(b,&nbsp;off,&nbsp;n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(n&nbsp;&amp;lt;&nbsp;len)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;q;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;byte&nbsp;array&nbsp;large&nbsp;that&nbsp;buffered&nbsp;data;&nbsp;read&nbsp;from&nbsp;input&nbsp;stream&nbsp;to&nbsp;fill&nbsp;up&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((q&nbsp;=&nbsp;trunk.in.read(b,&nbsp;off&nbsp;+&nbsp;n,&nbsp;len&nbsp;-&nbsp;n))&nbsp;&amp;gt;=&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;write&nbsp;result&nbsp;to&nbsp;buffer&nbsp;if&nbsp;necessary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeBuffer(b,&nbsp;off&nbsp;+&nbsp;n,&nbsp;q);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;+=&nbsp;q;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;long&nbsp;skip(long&nbsp;n)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n&nbsp;&amp;lt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;==&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;trunk.branches.size()&nbsp;==&nbsp;1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;not&nbsp;buffering;&nbsp;safely&nbsp;cascade&nbsp;call<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trunk.in.skip(n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;stream&nbsp;nowhere,&nbsp;just&nbsp;to&nbsp;buffer&nbsp;(or&nbsp;unbuffer)&nbsp;the&nbsp;result&nbsp;skipped<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IO.stream(this,&nbsp;IO.nullOutputStream(),&nbsp;(int)&nbsp;Math.min(Integer.MAX_VALUE,&nbsp;n));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;available()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;trunk.buffer.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(position&nbsp;&amp;lt;&nbsp;length)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this&nbsp;branch&nbsp;is&nbsp;still&nbsp;reading&nbsp;from&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;report&nbsp;buffer&nbsp;availability<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;length&nbsp;-&nbsp;position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;trunk.in.available();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;close&nbsp;are&nbsp;harmless<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeBranches();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.branches.remove(this);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;close&nbsp;buffer&nbsp;if&nbsp;applicable<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reviewBuffer();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.branches.size()&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;last&nbsp;one&nbsp;out&nbsp;turn&nbsp;off&nbsp;the&nbsp;lights<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.in.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;all&nbsp;else&nbsp;fails,&nbsp;this&nbsp;branch&nbsp;thinks&nbsp;it's&nbsp;closed<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;closeBranches()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;multiple&nbsp;calls&nbsp;are&nbsp;harmless<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&amp;lt;BranchingStreamWrapper&amp;gt;&nbsp;branches&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;ArrayList&amp;lt;BranchingStreamWrapper&amp;gt;(trunk.branches);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(BranchingStreamWrapper&nbsp;branch&nbsp;:&nbsp;branches)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branch.parent&nbsp;==&nbsp;this)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;recursively&nbsp;closes&nbsp;its&nbsp;children<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;this&nbsp;branching&nbsp;stream&nbsp;and&nbsp;all&nbsp;of&nbsp;the&nbsp;branches&nbsp;created&nbsp;from&nbsp;it.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;Throwable<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;be&nbsp;raised&nbsp;by&nbsp;super.finalize().<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;finalize()&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;ioe)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inappropriate&nbsp;to&nbsp;throw&nbsp;an&nbsp;exception&nbsp;when&nbsp;object&nbsp;is&nbsp;being&nbsp;collected<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.finalize();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;the&nbsp;trunk&nbsp;buffer&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;divergence&nbsp;between&nbsp;branches&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;all&nbsp;remaining&nbsp;branch&nbsp;positions&nbsp;are&nbsp;outside&nbsp;the&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;reviewBuffer()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no&nbsp;buffer&nbsp;to&nbsp;review<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;trunk.buffer.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(BranchingStreamWrapper&nbsp;branch&nbsp;:&nbsp;trunk.branches)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branch.position&nbsp;&amp;lt;&nbsp;length)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;branch&nbsp;is&nbsp;still&nbsp;using&nbsp;buffer;&nbsp;leave&nbsp;it&nbsp;alone<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;any&nbsp;remaining&nbsp;branches&nbsp;are&nbsp;non-divergent&nbsp;and&nbsp;outside&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.buffer.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.buffer&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Throws&nbsp;an&nbsp;{@link&nbsp;IOException}&nbsp;if&nbsp;the&nbsp;stream&nbsp;is&nbsp;closed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;notClosed()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;stream&nbsp;is&nbsp;closed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;readBuffer(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;trunk.buffer.length()&nbsp;&amp;gt;&nbsp;position)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;trunk.buffer.read(position,&nbsp;b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;+=&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;see&nbsp;if&nbsp;the&nbsp;buffer&nbsp;can&nbsp;be&nbsp;closed&nbsp;after&nbsp;this&nbsp;operation<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reviewBuffer();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;writeBuffer(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;==&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;trunk.branches.size()&nbsp;&amp;gt;&nbsp;1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;diverging&nbsp;branches;&nbsp;allocate&nbsp;new&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.buffer&nbsp;=&nbsp;trunk.bufferFactory.newInstance();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(BranchingStreamWrapper&nbsp;branch&nbsp;:&nbsp;trunk.branches)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;set&nbsp;each&nbsp;branch&nbsp;position&nbsp;to&nbsp;beginning&nbsp;of&nbsp;new&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.position&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(trunk.buffer&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.buffer.append(b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;+=&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Object&nbsp;shared&nbsp;by&nbsp;all&nbsp;branches.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;class&nbsp;Trunk&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Keeps&nbsp;track&nbsp;of&nbsp;all&nbsp;branches&nbsp;on&nbsp;this&nbsp;trunk.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;BranchingStreamWrapper&amp;gt;&nbsp;branches&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;ArrayList&amp;lt;BranchingStreamWrapper&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;input&nbsp;stream&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;the&nbsp;branches.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;InputStream&nbsp;in;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;An&nbsp;object&nbsp;that&nbsp;creates&nbsp;new&nbsp;temporary&nbsp;buffers.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;bufferFactory;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;A&nbsp;buffer&nbsp;to&nbsp;track&nbsp;diverging&nbsp;streams.&nbsp;Is&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;there&nbsp;is&nbsp;no<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;divergence.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Buffer&nbsp;buffer;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Trunk(InputStream&nbsp;in,&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;factory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.in&nbsp;=&nbsp;in;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.bufferFactory&nbsp;=&nbsp;factory;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/BranchingStreamWrapper.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioBufferjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/Buffer.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/Buffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/Buffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,71&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.Closeable;<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;dynamically&nbsp;growing&nbsp;data&nbsp;buffer.&nbsp;Data&nbsp;can&nbsp;be&nbsp;read&nbsp;from&nbsp;any&nbsp;point&nbsp;within&nbsp;the&nbsp;buffer,<br>
+&nbsp;*&nbsp;and&nbsp;written&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;buffer.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Buffer&nbsp;extends&nbsp;Closeable&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reads&nbsp;up&nbsp;to&nbsp;{@code&nbsp;len}&nbsp;bytes&nbsp;of&nbsp;data&nbsp;from&nbsp;the&nbsp;buffer&nbsp;into&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.&nbsp;An<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;attempt&nbsp;is&nbsp;made&nbsp;to&nbsp;read&nbsp;as&nbsp;many&nbsp;as&nbsp;{@code&nbsp;len}&nbsp;bytes,&nbsp;but&nbsp;a&nbsp;smaller&nbsp;number&nbsp;may&nbsp;be&nbsp;read.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;number&nbsp;of&nbsp;bytes&nbsp;actually&nbsp;read&nbsp;is&nbsp;returned&nbsp;as&nbsp;an&nbsp;integer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pos&nbsp;the&nbsp;offset&nbsp;position,&nbsp;measured&nbsp;in&nbsp;bytes&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;buffer,&nbsp;at&nbsp;which&nbsp;to&nbsp;read&nbsp;the&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;b&nbsp;the&nbsp;array&nbsp;of&nbsp;bytes&nbsp;to&nbsp;write&nbsp;the&nbsp;data&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;off&nbsp;the&nbsp;start&nbsp;offset&nbsp;in&nbsp;the&nbsp;array&nbsp;at&nbsp;which&nbsp;the&nbsp;data&nbsp;is&nbsp;written.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;read.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read&nbsp;into&nbsp;the&nbsp;array,&nbsp;or&nbsp;-1&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;more&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;read(int&nbsp;pos,&nbsp;byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Appends&nbsp;{@code&nbsp;len}&nbsp;bytes&nbsp;from&nbsp;the&nbsp;specified&nbsp;byte&nbsp;array&nbsp;starting&nbsp;at&nbsp;offset&nbsp;{@code&nbsp;off}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;b&nbsp;the&nbsp;array&nbsp;of&nbsp;bytes&nbsp;to&nbsp;read&nbsp;the&nbsp;data&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;off&nbsp;the&nbsp;start&nbsp;offset&nbsp;in&nbsp;the&nbsp;array&nbsp;at&nbsp;which&nbsp;the&nbsp;data&nbsp;is&nbsp;read.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;be&nbsp;appended&nbsp;to&nbsp;the&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;OverflowException&nbsp;if&nbsp;appending&nbsp;{@code&nbsp;len}&nbsp;bytes&nbsp;to&nbsp;the&nbsp;buffer&nbsp;would&nbsp;exceed&nbsp;its&nbsp;limit.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;append(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException,&nbsp;OverflowException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;current&nbsp;length&nbsp;of&nbsp;the&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;file,&nbsp;measured&nbsp;in&nbsp;bytes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length()&nbsp;throws&nbsp;IOException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Closes&nbsp;the&nbsp;buffer&nbsp;and&nbsp;releases&nbsp;any&nbsp;system&nbsp;resources&nbsp;associated&nbsp;with&nbsp;it.&nbsp;A&nbsp;closed&nbsp;buffer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cannot&nbsp;perform&nbsp;input&nbsp;or&nbsp;output&nbsp;operations&nbsp;and&nbsp;cannot&nbsp;be&nbsp;reopened.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/Buffer.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioByteArrayBranchingStreamjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/ByteArrayBranchingStream.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/ByteArrayBranchingStream.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/ByteArrayBranchingStream.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,116&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Wraps&nbsp;a&nbsp;byte&nbsp;array&nbsp;with&nbsp;a&nbsp;stream&nbsp;that&nbsp;can&nbsp;branch&nbsp;to&nbsp;perform&nbsp;divergent&nbsp;reads.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;ByteArrayBranchingStream&nbsp;extends&nbsp;BranchingInputStream&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Branch&nbsp;that&nbsp;this&nbsp;was&nbsp;spawned&nbsp;from,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;trunk.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ByteArrayBranchingStream&nbsp;parent&nbsp;=&nbsp;null;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;index&nbsp;of&nbsp;the&nbsp;next&nbsp;byte&nbsp;to&nbsp;read&nbsp;from&nbsp;the&nbsp;byte&nbsp;array.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;position&nbsp;=&nbsp;0;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;currently&nbsp;marked&nbsp;position&nbsp;in&nbsp;the&nbsp;stream.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;mark&nbsp;=&nbsp;-1;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;byte&nbsp;array&nbsp;to&nbsp;expose&nbsp;as&nbsp;the&nbsp;input&nbsp;stream.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;byte[]&nbsp;data;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayBranchingStream(byte[]&nbsp;data)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.data&nbsp;=&nbsp;data;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ByteArrayBranchingStream&nbsp;branch()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayBranchingStream&nbsp;branch&nbsp;=&nbsp;new&nbsp;ByteArrayBranchingStream(data);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.position&nbsp;=&nbsp;this.position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.parent&nbsp;=&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;branch;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ByteArrayBranchingStream&nbsp;parent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;int&nbsp;read()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(position&nbsp;&amp;lt;&nbsp;data.length&nbsp;?&nbsp;data[position++]&nbsp;&amp;amp;&nbsp;0xff&nbsp;:&nbsp;-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(byte[]&nbsp;b)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;read(b,&nbsp;0,&nbsp;b.length);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;int&nbsp;read(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(position&nbsp;&amp;gt;=&nbsp;data.length)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;end&nbsp;of&nbsp;stream&nbsp;has&nbsp;been&nbsp;reached<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;Math.min(len,&nbsp;data.length&nbsp;-&nbsp;position);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(data,&nbsp;position,&nbsp;b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;+=&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;long&nbsp;skip(long&nbsp;n)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n&nbsp;&amp;lt;=&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;Math.min(n,&nbsp;data.length&nbsp;-&nbsp;position);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;+=&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;int&nbsp;available()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;data.length&nbsp;-&nbsp;position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;markSupported()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;mark(int&nbsp;readlimit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mark&nbsp;=&nbsp;position;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;void&nbsp;reset()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(mark&nbsp;&amp;lt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;position&nbsp;was&nbsp;not&nbsp;marked&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position&nbsp;=&nbsp;mark;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/ByteArrayBranchingStream.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioFileBufferjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/FileBuffer.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/FileBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/FileBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,115&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.File;<br>
+import&nbsp;java.io.FileNotFoundException;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.RandomAccessFile;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;buffer&nbsp;that&nbsp;uses&nbsp;a&nbsp;local&nbsp;file&nbsp;for&nbsp;data&nbsp;storage.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;This&nbsp;implementation&nbsp;is&nbsp;not&nbsp;synchronized.&nbsp;If&nbsp;multiple&nbsp;threads&nbsp;access<br>
+&nbsp;*&nbsp;a&nbsp;buffer&nbsp;concurrently,&nbsp;threads&nbsp;that&nbsp;append&nbsp;to&nbsp;the&nbsp;buffer&nbsp;should&nbsp;synchronize&nbsp;on&nbsp;the&nbsp;instance<br>
+&nbsp;*&nbsp;of&nbsp;this&nbsp;object.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;FileBuffer&nbsp;implements&nbsp;Buffer&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;File&nbsp;to&nbsp;store&nbsp;buffered&nbsp;data&nbsp;in.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;RandomAccessFile&nbsp;raf;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Maximum&nbsp;file&nbsp;size,&nbsp;after&nbsp;which&nbsp;an&nbsp;{@link&nbsp;OverflowException}&nbsp;will&nbsp;be&nbsp;thrown.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;limit;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;FileBuffer(File&nbsp;file,&nbsp;int&nbsp;limit)&nbsp;throws&nbsp;FileNotFoundException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf&nbsp;=&nbsp;new&nbsp;RandomAccessFile(file,&nbsp;&amp;quot;rw&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.limit&nbsp;=&nbsp;limit;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(int&nbsp;pos,&nbsp;byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(pos&nbsp;&amp;lt;&nbsp;raf.length())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;synchronized&nbsp;(raf)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(pos);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((n&nbsp;=&nbsp;raf.read(b,&nbsp;off,&nbsp;len))&nbsp;==&nbsp;-1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;obey&nbsp;the&nbsp;contract&nbsp;of&nbsp;buffer&nbsp;reads<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;append(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException,&nbsp;OverflowException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;synchronized&nbsp;(raf)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;rafLength&nbsp;=&nbsp;(int)&nbsp;Math.min(Integer.MAX_VALUE,&nbsp;raf.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rafLength&nbsp;+&nbsp;len&nbsp;&amp;gt;&nbsp;limit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;OverflowException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(rafLength);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.write(b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;length()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(int)&nbsp;Math.min(Integer.MAX_VALUE,&nbsp;raf.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(raf&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;finalize()&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;ioe)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;inappropriate&nbsp;to&nbsp;throw&nbsp;an&nbsp;exception&nbsp;when&nbsp;object&nbsp;is&nbsp;being&nbsp;collected<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.finalize();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Throws&nbsp;an&nbsp;{@link&nbsp;IOException}&nbsp;if&nbsp;the&nbsp;buffer&nbsp;is&nbsp;closed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;notClosed()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(raf&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;buffer&nbsp;is&nbsp;closed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/FileBuffer.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioIOjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/IO.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/IO.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/IO.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,306&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.ByteArrayInputStream;<br>
+import&nbsp;java.io.File;<br>
+import&nbsp;java.io.FileNotFoundException;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.io.OutputStream;<br>
+import&nbsp;java.io.Reader;<br>
+import&nbsp;java.io.Writer;<br>
+<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Utility&nbsp;class&nbsp;that&nbsp;can&nbsp;stream&nbsp;to&nbsp;and&nbsp;from&nbsp;streams.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;IO&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;8&nbsp;KiB.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;int&nbsp;DEFAULT_TMP_INIT_LENGTH&nbsp;=&nbsp;8&nbsp;*&nbsp;1024;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;64&nbsp;KiB.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;int&nbsp;DEFAULT_TMP_MEMORY_LIMIT&nbsp;=&nbsp;64&nbsp;*&nbsp;1024;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;1&nbsp;MiB.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;int&nbsp;DEFAULT_TMP_FILE_LIMIT&nbsp;=&nbsp;1&nbsp;*&nbsp;1024&nbsp;*&nbsp;1024;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Size&nbsp;of&nbsp;buffer&nbsp;to&nbsp;use&nbsp;during&nbsp;streaming.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;int&nbsp;BUF_SIZE&nbsp;=&nbsp;8&nbsp;*&nbsp;1024;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;InputStream&nbsp;NULL_INPUT_STREAM&nbsp;=&nbsp;new&nbsp;ByteArrayInputStream(new&nbsp;byte[0]);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;OutputStream&nbsp;NULL_OUTPUT_STREAM&nbsp;=&nbsp;new&nbsp;OutputStream()&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;write(final&nbsp;int&nbsp;b)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;goes&nbsp;nowhere,&nbsp;does&nbsp;nothing<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;branching&nbsp;input&nbsp;stream&nbsp;that&nbsp;wraps&nbsp;a&nbsp;byte&nbsp;array.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;bytes<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte&nbsp;array&nbsp;to&nbsp;wrap&nbsp;with&nbsp;the&nbsp;branching&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;branching&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;BranchingInputStream&nbsp;newBranchingInputStream(final&nbsp;byte[]&nbsp;bytes)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ByteArrayBranchingStream(bytes);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;branching&nbsp;input&nbsp;stream&nbsp;to&nbsp;wrap&nbsp;another&nbsp;input&nbsp;stream.&nbsp;All<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;divergence&nbsp;between&nbsp;branches&nbsp;is&nbsp;maintained&nbsp;in&nbsp;a&nbsp;temporary&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;the&nbsp;stream&nbsp;being&nbsp;wrapped&nbsp;is&nbsp;a&nbsp;branching&nbsp;input&nbsp;stream,&nbsp;this&nbsp;constructor<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;will&nbsp;simply&nbsp;branch&nbsp;off&nbsp;of&nbsp;that&nbsp;existing&nbsp;stream&nbsp;rather&nbsp;than&nbsp;wrapping&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;with&nbsp;another&nbsp;branching&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;This&nbsp;stream&nbsp;and&nbsp;any&nbsp;branches&nbsp;it&nbsp;creates&nbsp;are&nbsp;not<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;safe&nbsp;for&nbsp;use&nbsp;by&nbsp;multiple&nbsp;concurrent&nbsp;threads.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;stream&nbsp;to&nbsp;be&nbsp;wrapped.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;bufferFactory<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;an&nbsp;object&nbsp;that&nbsp;can&nbsp;create&nbsp;new&nbsp;temporary&nbsp;buffers&nbsp;(e.g.&nbsp;@link<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TemporaryStorage}).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;branching&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;BranchingInputStream&nbsp;newBranchingInputStream(final&nbsp;InputStream&nbsp;in,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;bufferFactory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;BranchingStreamWrapper(in,&nbsp;bufferFactory);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;file&nbsp;buffer&nbsp;that&nbsp;uses&nbsp;a&nbsp;local&nbsp;file&nbsp;for&nbsp;data&nbsp;storage.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;The&nbsp;returned&nbsp;buffer&nbsp;is&nbsp;not&nbsp;synchronized.&nbsp;If<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;multiple&nbsp;threads&nbsp;access&nbsp;a&nbsp;buffer&nbsp;concurrently,&nbsp;threads&nbsp;that&nbsp;append&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;buffer&nbsp;should&nbsp;synchronize&nbsp;on&nbsp;the&nbsp;instance&nbsp;of&nbsp;this&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;file<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;file&nbsp;to&nbsp;use&nbsp;as&nbsp;storage&nbsp;for&nbsp;the&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;limit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;buffer&nbsp;length&nbsp;limit,&nbsp;after&nbsp;which&nbsp;an<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@link&nbsp;OverflowException}&nbsp;will&nbsp;be&nbsp;thrown.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;file&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;FileNotFoundException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;file&nbsp;cannot&nbsp;be&nbsp;created&nbsp;or&nbsp;opened&nbsp;for&nbsp;writing.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;SecurityException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;a&nbsp;security&nbsp;manager&nbsp;denies&nbsp;access&nbsp;to&nbsp;the&nbsp;specified&nbsp;file.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Buffer&nbsp;newFileBuffer(final&nbsp;File&nbsp;file,&nbsp;final&nbsp;int&nbsp;limit)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;FileNotFoundException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;FileBuffer(file,&nbsp;limit);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;buffer&nbsp;that&nbsp;uses&nbsp;a&nbsp;byte&nbsp;array&nbsp;for&nbsp;data&nbsp;storage.&nbsp;The&nbsp;byte<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;array&nbsp;starts&nbsp;at&nbsp;a&nbsp;prescribed&nbsp;initial&nbsp;length,&nbsp;and&nbsp;grows&nbsp;exponentially&nbsp;up<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;to&nbsp;the&nbsp;prescribed&nbsp;limit.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;The&nbsp;returned&nbsp;buffer&nbsp;is&nbsp;not&nbsp;synchronized.&nbsp;If<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;multiple&nbsp;threads&nbsp;access&nbsp;a&nbsp;buffer&nbsp;concurrently,&nbsp;threads&nbsp;that&nbsp;append&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;buffer&nbsp;should&nbsp;synchronize&nbsp;on&nbsp;the&nbsp;instance&nbsp;of&nbsp;this&nbsp;object.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;initial<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;initial&nbsp;size&nbsp;of&nbsp;the&nbsp;byte&nbsp;array&nbsp;to&nbsp;create.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;limit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;buffer&nbsp;length&nbsp;limit,&nbsp;after&nbsp;which&nbsp;an<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@link&nbsp;OverflowException}&nbsp;will&nbsp;be&nbsp;thrown.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;memory&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Buffer&nbsp;newMemoryBuffer(final&nbsp;int&nbsp;initial,&nbsp;final&nbsp;int&nbsp;limit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;MemoryBuffer(initial,&nbsp;limit);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;temporary&nbsp;buffer&nbsp;that&nbsp;first&nbsp;uses&nbsp;memory,&nbsp;then&nbsp;a&nbsp;temporary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;file&nbsp;for&nbsp;data&nbsp;storage.&nbsp;Initially,&nbsp;a&nbsp;{@link&nbsp;#newMemoryBuffer(int,&nbsp;int)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;memory}&nbsp;buffer&nbsp;is&nbsp;used;&nbsp;when&nbsp;the&nbsp;memory&nbsp;buffer&nbsp;limit&nbsp;is&nbsp;exceeded&nbsp;it<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;promotes&nbsp;to&nbsp;the&nbsp;use&nbsp;of&nbsp;a&nbsp;{@link&nbsp;#newFileBuffer(File,&nbsp;int)&nbsp;file}&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;initialLength<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;initial&nbsp;length&nbsp;of&nbsp;memory&nbsp;buffer&nbsp;byte&nbsp;array.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;memoryLimit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;length&nbsp;limit&nbsp;of&nbsp;the&nbsp;memory&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;fileLimit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;length&nbsp;limit&nbsp;of&nbsp;the&nbsp;file&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;directory<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;directory&nbsp;where&nbsp;temporary&nbsp;files&nbsp;are&nbsp;created,&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null}&nbsp;to&nbsp;use&nbsp;the&nbsp;system-dependent&nbsp;default&nbsp;temporary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;temporary&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Buffer&nbsp;newTemporaryBuffer(final&nbsp;int&nbsp;initialLength,&nbsp;final&nbsp;int&nbsp;memoryLimit,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;fileLimit,&nbsp;final&nbsp;File&nbsp;directory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;TemporaryBuffer(initialLength,&nbsp;memoryLimit,&nbsp;fileLimit,&nbsp;directory);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;storage&nbsp;using&nbsp;the&nbsp;system&nbsp;dependent&nbsp;default&nbsp;temporary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;directory&nbsp;and&nbsp;default&nbsp;sizes.&nbsp;Equivalent&nbsp;to&nbsp;call<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;newTemporaryStorage(null)}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;temporary&nbsp;storage.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;newTemporaryStorage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newTemporaryStorage(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;storage&nbsp;using&nbsp;the&nbsp;given&nbsp;directory&nbsp;(may&nbsp;be&nbsp;{@literal&nbsp;null})&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;default&nbsp;sizes.&nbsp;Equivalent&nbsp;to&nbsp;call<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;newTemporaryStorage(directory,&nbsp;HEIGHT_KB,&nbsp;SIXTY_FOUR_KB,&nbsp;ONE_MB)}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;directory<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;directory&nbsp;where&nbsp;temporary&nbsp;files&nbsp;are&nbsp;created.&nbsp;If<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null},&nbsp;then&nbsp;the&nbsp;system-dependent&nbsp;default&nbsp;temporary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;will&nbsp;be&nbsp;used.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;temporary&nbsp;storage.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;newTemporaryStorage(final&nbsp;File&nbsp;directory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newTemporaryStorage(directory,&nbsp;DEFAULT_TMP_INIT_LENGTH,&nbsp;DEFAULT_TMP_MEMORY_LIMIT,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_TMP_FILE_LIMIT);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Builds&nbsp;a&nbsp;storage&nbsp;using&nbsp;the&nbsp;given&nbsp;directory&nbsp;(may&nbsp;be&nbsp;{@literal&nbsp;null})&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;sizes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;directory<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;directory&nbsp;where&nbsp;temporary&nbsp;files&nbsp;are&nbsp;created.&nbsp;If<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@code&nbsp;null},&nbsp;then&nbsp;the&nbsp;system-dependent&nbsp;default&nbsp;temporary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;will&nbsp;be&nbsp;used.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;initialLength<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;initial&nbsp;length&nbsp;of&nbsp;memory&nbsp;buffer&nbsp;byte&nbsp;array.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;memoryLimit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;length&nbsp;limit&nbsp;of&nbsp;the&nbsp;memory&nbsp;buffer.&nbsp;Attempts&nbsp;to&nbsp;exceed&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;will&nbsp;result&nbsp;in&nbsp;promoting&nbsp;the&nbsp;buffer&nbsp;from&nbsp;a&nbsp;memory&nbsp;to&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;buffer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;fileLimit<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;length&nbsp;limit&nbsp;of&nbsp;the&nbsp;file&nbsp;buffer.&nbsp;Attempts&nbsp;to&nbsp;exceed&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit&nbsp;will&nbsp;result&nbsp;in&nbsp;an&nbsp;{@link&nbsp;OverflowException}&nbsp;being<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thrown.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;temporary&nbsp;storage.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;newTemporaryStorage(final&nbsp;File&nbsp;directory,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;initialLength,&nbsp;final&nbsp;int&nbsp;memoryLimit,&nbsp;final&nbsp;int&nbsp;fileLimit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Factory&amp;lt;Buffer&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Buffer&nbsp;newInstance()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newTemporaryBuffer(initialLength,&nbsp;memoryLimit,&nbsp;fileLimit,&nbsp;directory);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;input&nbsp;stream&nbsp;that&nbsp;holds&nbsp;no&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;input&nbsp;stream&nbsp;that&nbsp;holds&nbsp;no&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;InputStream&nbsp;nullInputStream()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL_INPUT_STREAM;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;output&nbsp;stream&nbsp;that&nbsp;discards&nbsp;all&nbsp;data&nbsp;written&nbsp;to&nbsp;it.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;output&nbsp;stream&nbsp;that&nbsp;discards&nbsp;all&nbsp;data&nbsp;written&nbsp;to&nbsp;it.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;OutputStream&nbsp;nullOutputStream()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL_OUTPUT_STREAM;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Streams&nbsp;all&nbsp;data&nbsp;from&nbsp;an&nbsp;input&nbsp;stream&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;input&nbsp;stream&nbsp;to&nbsp;stream&nbsp;the&nbsp;data&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;output&nbsp;stream&nbsp;to&nbsp;stream&nbsp;the&nbsp;data&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;stream(final&nbsp;InputStream&nbsp;in,&nbsp;final&nbsp;OutputStream&nbsp;out)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;byte[]&nbsp;buf&nbsp;=&nbsp;new&nbsp;byte[BUF_SIZE];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((n&nbsp;=&nbsp;in.read(buf,&nbsp;0,&nbsp;BUF_SIZE))&nbsp;!=&nbsp;-1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(buf,&nbsp;0,&nbsp;n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Streams&nbsp;data&nbsp;from&nbsp;an&nbsp;input&nbsp;stream&nbsp;to&nbsp;an&nbsp;output&nbsp;stream,&nbsp;up&nbsp;to&nbsp;a&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;length.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;input&nbsp;stream&nbsp;to&nbsp;stream&nbsp;the&nbsp;data&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;output&nbsp;stream&nbsp;to&nbsp;stream&nbsp;the&nbsp;data&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;actual&nbsp;number&nbsp;of&nbsp;bytes&nbsp;streamed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;int&nbsp;stream(final&nbsp;InputStream&nbsp;in,&nbsp;final&nbsp;OutputStream&nbsp;out,&nbsp;final&nbsp;int&nbsp;len)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;remaining&nbsp;=&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;byte[]&nbsp;buf&nbsp;=&nbsp;new&nbsp;byte[BUF_SIZE];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(remaining&nbsp;&amp;gt;&nbsp;0&nbsp;&amp;amp;&amp;amp;&nbsp;(n&nbsp;=&nbsp;in.read(buf,&nbsp;0,&nbsp;Math.min(remaining,&nbsp;BUF_SIZE)))&nbsp;&amp;gt;=&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(buf,&nbsp;0,&nbsp;n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remaining&nbsp;-=&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;len&nbsp;-&nbsp;remaining;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Streams&nbsp;all&nbsp;characters&nbsp;from&nbsp;a&nbsp;reader&nbsp;to&nbsp;a&nbsp;writer.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;to&nbsp;stream&nbsp;the&nbsp;characters&nbsp;from.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;out<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;writer&nbsp;to&nbsp;stream&nbsp;the&nbsp;characters&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;an&nbsp;I/O&nbsp;exception&nbsp;occurs.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;stream(final&nbsp;Reader&nbsp;in,&nbsp;final&nbsp;Writer&nbsp;out)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;char[]&nbsp;buf&nbsp;=&nbsp;new&nbsp;char[BUF_SIZE];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((n&nbsp;=&nbsp;in.read(buf,&nbsp;0,&nbsp;BUF_SIZE))&nbsp;!=&nbsp;-1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.write(buf,&nbsp;0,&nbsp;n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Static&nbsp;methods&nbsp;only.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;IO()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/IO.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioMemoryBufferjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/MemoryBuffer.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/MemoryBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/MemoryBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,104&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.Arrays;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;buffer&nbsp;that&nbsp;uses&nbsp;a&nbsp;byte&nbsp;array&nbsp;for&nbsp;data&nbsp;storage.&nbsp;The&nbsp;byte&nbsp;array&nbsp;starts&nbsp;at&nbsp;a<br>
+&nbsp;*&nbsp;prescribed&nbsp;initial&nbsp;length,&nbsp;and&nbsp;grows&nbsp;exponentially&nbsp;up&nbsp;to&nbsp;the&nbsp;prescribed<br>
+&nbsp;*&nbsp;limit.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;This&nbsp;implementation&nbsp;is&nbsp;not&nbsp;synchronized.&nbsp;If&nbsp;multiple<br>
+&nbsp;*&nbsp;threads&nbsp;access&nbsp;a&nbsp;buffer&nbsp;concurrently,&nbsp;threads&nbsp;that&nbsp;append&nbsp;to&nbsp;the&nbsp;buffer<br>
+&nbsp;*&nbsp;should&nbsp;synchronize&nbsp;on&nbsp;the&nbsp;instance&nbsp;of&nbsp;this&nbsp;object.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;MemoryBuffer&nbsp;implements&nbsp;Buffer&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;byte&nbsp;array&nbsp;storing&nbsp;buffer&nbsp;data.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;data;&nbsp;//&nbsp;package&nbsp;scope&nbsp;to&nbsp;give&nbsp;TemporaryBuffer&nbsp;access&nbsp;without&nbsp;intermediate&nbsp;copy<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;current&nbsp;length&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;limit;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Current&nbsp;length&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;length&nbsp;=&nbsp;0;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;MemoryBuffer(int&nbsp;initial,&nbsp;int&nbsp;limit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;new&nbsp;byte[initial];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.limit&nbsp;=&nbsp;limit;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(int&nbsp;pos,&nbsp;byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;n&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(pos&nbsp;&amp;lt;&nbsp;length)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;Math.min(len,&nbsp;length&nbsp;-&nbsp;pos);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(data,&nbsp;pos,&nbsp;b,&nbsp;off,&nbsp;n);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;n;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;append(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(off&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;len&nbsp;&amp;gt;&nbsp;b.length&nbsp;-&nbsp;off)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;end&nbsp;=&nbsp;this.length&nbsp;+&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(end&nbsp;&amp;gt;&nbsp;limit)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;OverflowException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(data.length&nbsp;&amp;lt;&nbsp;end)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;buffer&nbsp;grows&nbsp;exponentially&nbsp;(up&nbsp;to&nbsp;limit)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;Arrays.copyOf(data,&nbsp;Math.max(end,&nbsp;Math.min(limit,&nbsp;data.length&nbsp;&amp;lt;&amp;lt;&nbsp;1)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(b,&nbsp;off,&nbsp;data,&nbsp;this.length,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.length&nbsp;+=&nbsp;len;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;length()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;finalize()&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.finalize();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Throws&nbsp;an&nbsp;{@link&nbsp;IOException}&nbsp;if&nbsp;the&nbsp;buffer&nbsp;is&nbsp;closed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;notClosed()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(data&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;buffer&nbsp;is&nbsp;closed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/MemoryBuffer.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioOverflowExceptionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/OverflowException.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/OverflowException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/OverflowException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,66&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;exception&nbsp;that&nbsp;is&nbsp;thrown&nbsp;if&nbsp;a&nbsp;buffer&nbsp;would&nbsp;overflow&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;a&nbsp;write&nbsp;operation.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;OverflowException&nbsp;extends&nbsp;IOException&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;1L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;null&nbsp;as&nbsp;its&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;OverflowException()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;OverflowException(String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;cause.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;cause<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;specified&nbsp;cause&nbsp;of&nbsp;this&nbsp;exception.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;OverflowException(Throwable&nbsp;cause)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(cause);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message&nbsp;and&nbsp;cause.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;cause<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;specified&nbsp;cause&nbsp;of&nbsp;this&nbsp;exception.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;OverflowException(String&nbsp;message,&nbsp;Throwable&nbsp;cause)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message,&nbsp;cause);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/OverflowException.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpioTemporaryBufferjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/TemporaryBuffer.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/TemporaryBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/TemporaryBuffer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,110&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;java.io.File;<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;buffer&nbsp;that&nbsp;first&nbsp;uses&nbsp;memory,&nbsp;then&nbsp;a&nbsp;temporary&nbsp;file&nbsp;for&nbsp;data&nbsp;storage.<br>
+&nbsp;*&nbsp;Initially,&nbsp;a&nbsp;{@link&nbsp;MemoryBuffer}&nbsp;is&nbsp;used;&nbsp;when&nbsp;the&nbsp;memory&nbsp;buffer&nbsp;limit&nbsp;is<br>
+&nbsp;*&nbsp;exceeded&nbsp;it&nbsp;promotes&nbsp;to&nbsp;the&nbsp;use&nbsp;of&nbsp;a&nbsp;{@link&nbsp;FileBuffer}.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;TemporaryBuffer&nbsp;implements&nbsp;Buffer&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;File&nbsp;used&nbsp;for&nbsp;temporary&nbsp;storage.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;File&nbsp;file&nbsp;=&nbsp;null;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;directory&nbsp;where&nbsp;temporary&nbsp;files&nbsp;are&nbsp;created.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;File&nbsp;directory;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;length&nbsp;limit&nbsp;of&nbsp;the&nbsp;file&nbsp;buffer.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;fileLimit;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;buffer&nbsp;currently&nbsp;in&nbsp;use.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Buffer&nbsp;buffer;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;TemporaryBuffer(int&nbsp;initialLength,&nbsp;int&nbsp;memoryLimit,&nbsp;int&nbsp;fileLimit,&nbsp;File&nbsp;directory)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;=&nbsp;IO.newMemoryBuffer(initialLength,&nbsp;memoryLimit);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.fileLimit&nbsp;=&nbsp;fileLimit;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.directory&nbsp;=&nbsp;directory;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;read(int&nbsp;pos,&nbsp;byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buffer.read(pos,&nbsp;b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;append(byte[]&nbsp;b,&nbsp;int&nbsp;off,&nbsp;int&nbsp;len)&nbsp;throws&nbsp;IOException,&nbsp;OverflowException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer.append(b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(OverflowException&nbsp;oe)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;may&nbsp;throw&nbsp;OverflowException&nbsp;to&nbsp;indicate&nbsp;no&nbsp;promotion&nbsp;possible<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;promote();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;recursively&nbsp;retry&nbsp;after&nbsp;promotion<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append(b,&nbsp;off,&nbsp;len);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;length()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notClosed();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buffer.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(buffer&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(file&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.delete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Throws&nbsp;an&nbsp;{@link&nbsp;IOException}&nbsp;if&nbsp;the&nbsp;buffer&nbsp;is&nbsp;closed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;notClosed()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(buffer&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;buffer&nbsp;is&nbsp;closed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;promote()&nbsp;throws&nbsp;IOException,&nbsp;OverflowException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(buffer&nbsp;instanceof&nbsp;MemoryBuffer)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MemoryBuffer&nbsp;membuf&nbsp;=&nbsp;(MemoryBuffer)&nbsp;buffer;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;=&nbsp;File.createTempFile(&amp;quot;buf&amp;quot;,&nbsp;null,&nbsp;directory);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;=&nbsp;IO.newFileBuffer(file,&nbsp;fileLimit);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;accesses&nbsp;byte&nbsp;array&nbsp;directly<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer.append(membuf.data,&nbsp;0,&nbsp;membuf.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;membuf.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no&nbsp;further&nbsp;promotion&nbsp;possible<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;OverflowException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/TemporaryBuffer.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpiopackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,21&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Provides&nbsp;stream&nbsp;buffering,&nbsp;branching,&nbsp;and&nbsp;storage&nbsp;functions.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.io;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/io/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttppackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,22&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Models&nbsp;and&nbsp;manages&nbsp;elements&nbsp;of&nbsp;the&nbsp;Hypertext&nbsp;Transfer&nbsp;Protocol.&nbsp;For&nbsp;more&nbsp;information,&nbsp;see<br>
+&nbsp;*&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttproutingUriRouterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/UriRouter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/UriRouter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/UriRouter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,105&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.routing;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.forgerock.http.Handler;<br>
+import&nbsp;org.forgerock.http.NotFoundException;<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.forgerock.http.ResponseException;<br>
+import&nbsp;org.forgerock.resource.core.routing.AbstractUriRouter;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.ResourceName;<br>
+import&nbsp;org.forgerock.resource.core.routing.RouteMatcher;<br>
+import&nbsp;org.forgerock.resource.core.routing.RouteNotFoundException;<br>
+import&nbsp;org.forgerock.resource.core.routing.RouterContext;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+import&nbsp;org.forgerock.util.promise.Promises;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;{@code&nbsp;Handler}&nbsp;implementation&nbsp;of&nbsp;the&nbsp;{@link&nbsp;AbstractUriRouter}&nbsp;that&nbsp;will&nbsp;route<br>
+&nbsp;*&nbsp;requests&nbsp;using&nbsp;URI&nbsp;template&nbsp;matching&nbsp;against&nbsp;the&nbsp;request's&nbsp;URI.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;AbstractUriRouter<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;UriRouter&nbsp;extends&nbsp;AbstractUriRouter&amp;lt;UriRouter,&nbsp;Handler&amp;gt;&nbsp;implements&nbsp;Handler&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;router&nbsp;with&nbsp;no&nbsp;routes&nbsp;defined.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;UriRouter()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;router&nbsp;containing&nbsp;the&nbsp;same&nbsp;routes&nbsp;and&nbsp;default&nbsp;route&nbsp;as&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;router.&nbsp;Changes&nbsp;to&nbsp;the&nbsp;returned&nbsp;router's&nbsp;routing&nbsp;table&nbsp;will&nbsp;not<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;impact&nbsp;the&nbsp;provided&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;router<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;router&nbsp;to&nbsp;be&nbsp;copied.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;UriRouter(UriRouter&nbsp;router)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(router);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;UriRouter&nbsp;getThis()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;handle(Context&nbsp;context,&nbsp;Request&nbsp;request)&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher&amp;lt;Handler&amp;gt;&nbsp;bestMatch&nbsp;=&nbsp;getBestRoute(context,&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;bestMatch.getHandler().handle(bestMatch.getContext(),&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(ResponseException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newFailedPromise(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;RouteMatcher&amp;lt;Handler&amp;gt;&nbsp;getBestRoute(Context&nbsp;context,&nbsp;Request&nbsp;request)&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResourceName&nbsp;path&nbsp;=&nbsp;ResourceName.valueOf(request.getUri().getPath());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(context.containsContext(RouterContext.class))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResourceName&nbsp;matchedUri&nbsp;=&nbsp;getMatchedUri(context);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;path.tail(matchedUri.size());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;uri&nbsp;=&nbsp;path.toString();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getBestRoute(context,&nbsp;uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(RouteNotFoundException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;NotFoundException(e.getMessage(),&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ResourceName&nbsp;getMatchedUri(Context&nbsp;context)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;String&amp;gt;&nbsp;matched&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Context&nbsp;ctx&nbsp;=&nbsp;context;&nbsp;ctx&nbsp;!=&nbsp;null;&nbsp;ctx&nbsp;=&nbsp;ctx.getParent())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!ctx.containsContext(RouterContext.class))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matched.add(ctx.asContext(RouterContext.class).getMatchedUri());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(matched);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/routing/UriRouter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspiClientImpljava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/ClientImpl.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/ClientImpl.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/ClientImpl.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,56&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.spi;<br>
+<br>
+import&nbsp;java.io.Closeable;<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.forgerock.http.ResponseException;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Interface&nbsp;for&nbsp;all&nbsp;classes&nbsp;that&nbsp;actually&nbsp;implement&nbsp;{@code&nbsp;Client}.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;An&nbsp;implementation&nbsp;class&nbsp;is&nbsp;provided&nbsp;by&nbsp;a&nbsp;{@code&nbsp;TransportProvider}.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;The&nbsp;implementation&nbsp;can&nbsp;be&nbsp;automatically&nbsp;loaded&nbsp;using&nbsp;the<br>
+&nbsp;*&nbsp;{@code&nbsp;java.util.ServiceLoader}&nbsp;facility&nbsp;if&nbsp;its&nbsp;provider&nbsp;extending<br>
+&nbsp;*&nbsp;{@code&nbsp;TransportProvider}&nbsp;is&nbsp;declared&nbsp;in&nbsp;the&nbsp;provider-configuration&nbsp;file<br>
+&nbsp;*&nbsp;{@code&nbsp;META-INF/services/org.forgerock.http.spi.TransportProvider}.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;ClientImpl&nbsp;extends&nbsp;Closeable&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sends&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;a&nbsp;remote&nbsp;server&nbsp;and&nbsp;returns&nbsp;a&nbsp;{@code&nbsp;Promise}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;representing&nbsp;the&nbsp;asynchronous&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;send.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;promise&nbsp;representing&nbsp;the&nbsp;pending&nbsp;HTTP&nbsp;response.&nbsp;The&nbsp;promise<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;will&nbsp;yield&nbsp;a&nbsp;{@code&nbsp;ResponseException}&nbsp;when&nbsp;a&nbsp;non-2xx&nbsp;HTTP&nbsp;status<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;sendAsync(Request&nbsp;request);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Completes&nbsp;all&nbsp;pending&nbsp;requests&nbsp;and&nbsp;release&nbsp;resources&nbsp;associated&nbsp;with<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;underlying&nbsp;implementation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;close()&nbsp;throws&nbsp;IOException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/ClientImpl.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspiTransportProviderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/TransportProvider.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/TransportProvider.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/TransportProvider.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,44&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.spi;<br>
+<br>
+import&nbsp;org.forgerock.http.ClientOptions;<br>
+import&nbsp;org.forgerock.http.HttpApplicationException;<br>
+import&nbsp;org.forgerock.http.util.Indexed;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Interface&nbsp;for&nbsp;transport&nbsp;providers,&nbsp;which&nbsp;provide&nbsp;implementations&nbsp;of&nbsp;HTTP<br>
+&nbsp;*&nbsp;{@code&nbsp;Client}s&nbsp;using&nbsp;a&nbsp;specific&nbsp;transport.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;A&nbsp;transport&nbsp;provider&nbsp;must&nbsp;be&nbsp;declared&nbsp;in&nbsp;the&nbsp;provider-configuration&nbsp;file<br>
+&nbsp;*&nbsp;{@code&nbsp;META-INF/services/org.forgerock.http.spi.TransportProvider}&nbsp;in&nbsp;order<br>
+&nbsp;*&nbsp;to&nbsp;allow&nbsp;automatic&nbsp;loading&nbsp;of&nbsp;the&nbsp;implementation&nbsp;classes&nbsp;using&nbsp;the<br>
+&nbsp;*&nbsp;{@code&nbsp;java.util.ServiceLoader}&nbsp;facility.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;TransportProvider&nbsp;extends&nbsp;Indexed&amp;lt;String&amp;gt;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;implementation&nbsp;of&nbsp;{@code&nbsp;Client}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;options<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;client&nbsp;options&nbsp;(never&nbsp;{@code&nbsp;null}).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;implementation&nbsp;of&nbsp;{@code&nbsp;Client}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HttpApplicationException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;client&nbsp;implementation&nbsp;could&nbsp;not&nbsp;be&nbsp;configured&nbsp;using<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;provided&nbsp;set&nbsp;of&nbsp;options.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;ClientImpl&nbsp;newClientImpl(ClientOptions&nbsp;options)&nbsp;throws&nbsp;HttpApplicationException;<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/TransportProvider.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttpspipackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,20&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;HTTP&nbsp;service&nbsp;provider&nbsp;API.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.spi;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;\&nbsp;No&nbsp;newline&nbsp;at&nbsp;end&nbsp;of&nbsp;file<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/spi/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilCaseInsensitiveMapjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveMap.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveMap.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveMap.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,124&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.util.MapDecorator;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;implementation&nbsp;of&nbsp;a&nbsp;map&nbsp;whose&nbsp;keys&nbsp;are&nbsp;case-insensitive&nbsp;strings.&nbsp;All&nbsp;operations&nbsp;match<br>
+&nbsp;*&nbsp;keys&nbsp;in&nbsp;a&nbsp;case-insensitive&nbsp;manner.&nbsp;The&nbsp;original&nbsp;cases&nbsp;of&nbsp;keys&nbsp;are&nbsp;retained,&nbsp;so&nbsp;the<br>
+&nbsp;*&nbsp;{@link&nbsp;#keySet()&nbsp;keySet()}&nbsp;method&nbsp;for&nbsp;example&nbsp;returns&nbsp;the&nbsp;original&nbsp;keys.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;The&nbsp;behavior&nbsp;of&nbsp;this&nbsp;class&nbsp;is&nbsp;undefined&nbsp;when&nbsp;wrapping&nbsp;a&nbsp;map&nbsp;that<br>
+&nbsp;*&nbsp;has&nbsp;keys&nbsp;that&nbsp;would&nbsp;result&nbsp;in&nbsp;duplicate&nbsp;case-insensitive&nbsp;keys.<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;V&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;case&nbsp;insensitive&nbsp;map.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;CaseInsensitiveMap&amp;lt;V&amp;gt;&nbsp;extends&nbsp;MapDecorator&amp;lt;String,&nbsp;V&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Maps&nbsp;lowercase&nbsp;keys&nbsp;to&nbsp;the&nbsp;real&nbsp;string&nbsp;keys.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;lc&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;case-insensitive&nbsp;map.&nbsp;The&nbsp;backing&nbsp;map&nbsp;is&nbsp;a&nbsp;new&nbsp;{@link&nbsp;HashMap}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;with&nbsp;default&nbsp;initial&nbsp;capacity&nbsp;and&nbsp;load&nbsp;factor.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveMap()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;HashMap&amp;lt;String,&nbsp;V&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Wraps&nbsp;an&nbsp;existing&nbsp;map&nbsp;with&nbsp;a&nbsp;new&nbsp;case&nbsp;insensitive&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;map&nbsp;the&nbsp;map&nbsp;to&nbsp;wrap&nbsp;with&nbsp;a&nbsp;new&nbsp;case&nbsp;insensitive&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveMap(Map&amp;lt;String,&nbsp;V&amp;gt;&nbsp;map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(map);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;case-insensitive&nbsp;key&nbsp;translated&nbsp;into&nbsp;its&nbsp;mapped&nbsp;equivalent.&nbsp;If&nbsp;its&nbsp;equivalent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;cannot&nbsp;be&nbsp;found,&nbsp;then&nbsp;the&nbsp;key&nbsp;is&nbsp;returned&nbsp;untouched.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object&nbsp;translate(Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(key&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;k&nbsp;=&nbsp;lc.get(((String)&nbsp;key).toLowerCase());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(k&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;found&nbsp;a&nbsp;mapped-equivalent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;k;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;key;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Synchronizes&nbsp;the&nbsp;keys&nbsp;of&nbsp;this&nbsp;case&nbsp;insensitive&nbsp;map&nbsp;and&nbsp;those&nbsp;of&nbsp;the&nbsp;map&nbsp;it&nbsp;is&nbsp;wrapping.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;is&nbsp;necessary&nbsp;if&nbsp;the&nbsp;underlying&nbsp;map&nbsp;is&nbsp;modified&nbsp;directly&nbsp;and&nbsp;this&nbsp;map&nbsp;needs&nbsp;to&nbsp;be<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;resynchronized.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;sync()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;key&nbsp;:&nbsp;map.keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.put(key.toLowerCase(),&nbsp;key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;clear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsKey(Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.containsKey(translate(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;V&nbsp;put(String&nbsp;key,&nbsp;V&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;remove&nbsp;potentially&nbsp;differently-cased&nbsp;key<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;removed&nbsp;=&nbsp;remove(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.put(key.toLowerCase(),&nbsp;key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.put(key,&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;removed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;putAll(Map&amp;lt;?&nbsp;extends&nbsp;String,&nbsp;?&nbsp;extends&nbsp;V&amp;gt;&nbsp;m)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;key&nbsp;:&nbsp;m.keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(key,&nbsp;m.get(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;V&nbsp;get(Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.get(translate(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;V&nbsp;remove(Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;removed&nbsp;=&nbsp;super.remove(translate(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(key&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.remove(((String)&nbsp;key).toLowerCase());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;removed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveMap.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilCaseInsensitiveSetjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveSet.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveSet.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveSet.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,173&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.HashSet;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.Set;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;implementation&nbsp;of&nbsp;a&nbsp;set&nbsp;whose&nbsp;values&nbsp;are&nbsp;case-insensitive&nbsp;strings.&nbsp;All&nbsp;operations&nbsp;match<br>
+&nbsp;*&nbsp;values&nbsp;in&nbsp;a&nbsp;case-insensitive&nbsp;manner.&nbsp;The&nbsp;original&nbsp;cases&nbsp;of&nbsp;values&nbsp;are&nbsp;retained,&nbsp;so&nbsp;the<br>
+&nbsp;*&nbsp;{@link&nbsp;#iterator()&nbsp;iterator()}&nbsp;method&nbsp;for&nbsp;example&nbsp;returns&nbsp;the&nbsp;originally&nbsp;values.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;strong&amp;gt;Note:&amp;lt;/strong&amp;gt;&nbsp;The&nbsp;behavior&nbsp;of&nbsp;this&nbsp;class&nbsp;is&nbsp;undefined&nbsp;when&nbsp;wrapping&nbsp;a&nbsp;set&nbsp;that<br>
+&nbsp;*&nbsp;has&nbsp;keys&nbsp;that&nbsp;would&nbsp;result&nbsp;in&nbsp;duplicate&nbsp;case-insensitive&nbsp;values.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;CaseInsensitiveSet&nbsp;extends&nbsp;SetDecorator&amp;lt;String&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Maps&nbsp;lowercase&nbsp;elements&nbsp;to&nbsp;the&nbsp;real&nbsp;string&nbsp;elements.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;lc;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;empty&nbsp;case-insensitive&nbsp;set.&nbsp;The&nbsp;backing&nbsp;set&nbsp;is&nbsp;a&nbsp;new&nbsp;{@link&nbsp;HashSet}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;with&nbsp;default&nbsp;initial&nbsp;capacity&nbsp;and&nbsp;load&nbsp;factor.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveSet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;HashSet&amp;lt;String&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;case-insensitive&nbsp;set&nbsp;containing&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;collection.&nbsp;The&nbsp;{@code&nbsp;HashSet}&nbsp;is&nbsp;created&nbsp;with&nbsp;default&nbsp;load&nbsp;factor&nbsp;and&nbsp;an&nbsp;initial<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;capacity&nbsp;sufficient&nbsp;to&nbsp;contain&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;specified&nbsp;collection.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;c&nbsp;the&nbsp;collection&nbsp;whose&nbsp;elements&nbsp;are&nbsp;to&nbsp;be&nbsp;placed&nbsp;into&nbsp;this&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveSet(Collection&amp;lt;String&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(c&nbsp;instanceof&nbsp;Set&nbsp;?&nbsp;(Set&amp;lt;String&amp;gt;)&nbsp;c&nbsp;:&nbsp;new&nbsp;HashSet&amp;lt;String&amp;gt;(c));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;(c.size());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;e&nbsp;:&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.put(e.toLowerCase(),&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new,&nbsp;empty&nbsp;case-insensitive&nbsp;set;&nbsp;the&nbsp;backing&nbsp;{@code&nbsp;HashSet}&nbsp;instance&nbsp;has<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;specified&nbsp;initial&nbsp;capacity&nbsp;and&nbsp;the&nbsp;specified&nbsp;load&nbsp;factor.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;initialCapacity&nbsp;the&nbsp;initial&nbsp;capacity&nbsp;of&nbsp;the&nbsp;hash&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;loadFactor&nbsp;the&nbsp;load&nbsp;factor&nbsp;of&nbsp;the&nbsp;hash&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException&nbsp;if&nbsp;the&nbsp;initial&nbsp;capacity&nbsp;is&nbsp;less&nbsp;than&nbsp;zero,&nbsp;or&nbsp;if&nbsp;the&nbsp;load&nbsp;factor&nbsp;is&nbsp;nonpositive.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveSet(int&nbsp;initialCapacity,&nbsp;float&nbsp;loadFactor)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;HashSet&amp;lt;String&amp;gt;(initialCapacity,&nbsp;loadFactor));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;(initialCapacity,&nbsp;loadFactor);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new,&nbsp;empty&nbsp;case-insensitive&nbsp;set;&nbsp;the&nbsp;backing&nbsp;{@code&nbsp;HashSet}&nbsp;instance&nbsp;has<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;specified&nbsp;initial&nbsp;capacity&nbsp;and&nbsp;default&nbsp;load&nbsp;factor.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;initialCapacity&nbsp;the&nbsp;initial&nbsp;capacity&nbsp;of&nbsp;the&nbsp;hash&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException&nbsp;if&nbsp;the&nbsp;initial&nbsp;capacity&nbsp;is&nbsp;less&nbsp;than&nbsp;zero.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;CaseInsensitiveSet(int&nbsp;initialCapacity)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;HashSet&amp;lt;String&amp;gt;(initialCapacity));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;(initialCapacity);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object&nbsp;translate(Object&nbsp;element)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;e&nbsp;=&nbsp;lc.get(((String)&nbsp;element).toLowerCase());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(e&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;found&nbsp;a&nbsp;mapped-equivalent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element&nbsp;=&nbsp;e;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;element;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;contains(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.contains(translate(o));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;add(String&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(contains(e))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.put(e.toLowerCase(),&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.add(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;remove(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;removed&nbsp;=&nbsp;super.remove(translate(o));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o&nbsp;instanceof&nbsp;String)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.remove(((String)&nbsp;o).toLowerCase());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;removed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Object&nbsp;o&nbsp;:&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!contains(o))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;addAll(Collection&amp;lt;?&nbsp;extends&nbsp;String&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;changed&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;e&nbsp;:&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(add(e))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changed&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;changed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;retainAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;changed&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;e&nbsp;:&nbsp;this)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!c.contains(e))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changed&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;changed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;removeAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;changed&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;e&nbsp;:&nbsp;this)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c.contains(e))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changed&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;changed;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;clear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lc.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/CaseInsensitiveSet.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilIndexedjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Indexed.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Indexed.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Indexed.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,33&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Interface&nbsp;of&nbsp;an&nbsp;object&nbsp;that&nbsp;can&nbsp;be&nbsp;indexed&nbsp;with&nbsp;a&nbsp;unique&nbsp;key.<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;referenced&nbsp;object.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Indexed&amp;lt;T&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;unique&nbsp;key&nbsp;to&nbsp;index&nbsp;the&nbsp;object&nbsp;by.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;unique&nbsp;key&nbsp;to&nbsp;index&nbsp;the&nbsp;object&nbsp;by.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;getKey();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Indexed.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilJsonjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Json.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Json.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Json.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,250&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;com.fasterxml.jackson.core.JsonParser.Feature.*;<br>
+import&nbsp;static&nbsp;java.lang.String.*;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.io.InputStreamReader;<br>
+import&nbsp;java.io.Reader;<br>
+import&nbsp;java.io.StringReader;<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.LinkedList;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;com.fasterxml.jackson.core.JsonParser;<br>
+import&nbsp;com.fasterxml.jackson.core.JsonToken;<br>
+import&nbsp;com.fasterxml.jackson.core.type.TypeReference;<br>
+import&nbsp;com.fasterxml.jackson.databind.ObjectMapper;<br>
+<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Provides&nbsp;read&nbsp;and&nbsp;write&nbsp;JSON&nbsp;capabilities.<br>
+&nbsp;*&nbsp;Can&nbsp;check&nbsp;if&nbsp;an&nbsp;object&nbsp;reference&nbsp;is&nbsp;JSON-compatible&nbsp;(expressed&nbsp;as&nbsp;primitive&nbsp;values,&nbsp;list/array&nbsp;and&nbsp;map).<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Json&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Non&nbsp;strict&nbsp;object&nbsp;mapper&nbsp;/&nbsp;data&nbsp;binder&nbsp;used&nbsp;to&nbsp;read&nbsp;json&nbsp;configuration&nbsp;files/data.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;ObjectMapper&nbsp;LENIENT_MAPPER;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LENIENT_MAPPER&nbsp;=&nbsp;new&nbsp;ObjectMapper();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LENIENT_MAPPER.configure(ALLOW_COMMENTS,&nbsp;true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LENIENT_MAPPER.configure(ALLOW_SINGLE_QUOTES,&nbsp;true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LENIENT_MAPPER.configure(ALLOW_UNQUOTED_CONTROL_CHARS,&nbsp;true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Strict&nbsp;object&nbsp;mapper&nbsp;/&nbsp;data&nbsp;binder&nbsp;used&nbsp;to&nbsp;read&nbsp;json&nbsp;configuration&nbsp;files/data.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;ObjectMapper&nbsp;STRICT_MAPPER&nbsp;=&nbsp;new&nbsp;ObjectMapper();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Private&nbsp;constructor&nbsp;for&nbsp;utility&nbsp;class.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Json()&nbsp;{&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Verify&nbsp;that&nbsp;the&nbsp;given&nbsp;parameter&nbsp;object&nbsp;is&nbsp;of&nbsp;a&nbsp;JSON&nbsp;compatible&nbsp;type&nbsp;(recursively).&nbsp;If&nbsp;no&nbsp;exception&nbsp;is&nbsp;thrown&nbsp;that<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;means&nbsp;the&nbsp;parameter&nbsp;can&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;JWT&nbsp;session&nbsp;(that&nbsp;is&nbsp;a&nbsp;JSON&nbsp;value).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;trail<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointer&nbsp;to&nbsp;the&nbsp;verified&nbsp;object<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;to&nbsp;verify<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;checkJsonCompatibility(final&nbsp;String&nbsp;trail,&nbsp;final&nbsp;Object&nbsp;value)&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Null&nbsp;is&nbsp;OK<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Class&amp;lt;?&amp;gt;&nbsp;type&nbsp;=&nbsp;value.getClass();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;object&nbsp;=&nbsp;value;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;JSON&nbsp;supports&nbsp;Boolean<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;Boolean)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;JSON&nbsp;supports&nbsp;Chars&nbsp;(as&nbsp;String)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;Character)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;JSON&nbsp;supports&nbsp;Numbers&nbsp;(Long,&nbsp;Float,&nbsp;...)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;Number)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;JSON&nbsp;supports&nbsp;String<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;CharSequence)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Consider&nbsp;array&nbsp;like&nbsp;a&nbsp;List<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(type.isArray())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;=&nbsp;Arrays.asList((Object[])&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;List)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;?&amp;gt;&nbsp;list&nbsp;=&nbsp;(List&amp;lt;?&amp;gt;)&nbsp;object;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;list.size();&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(format(&amp;quot;%s[%d]&amp;quot;,&nbsp;trail,&nbsp;i),&nbsp;list.get(i));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;instanceof&nbsp;Map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;?,&nbsp;?&amp;gt;&nbsp;map&nbsp;=&nbsp;(Map&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;object;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Map.Entry&amp;lt;?,&nbsp;?&amp;gt;&nbsp;entry&nbsp;:&nbsp;map.entrySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(format(&amp;quot;%s/%s&amp;quot;,&nbsp;trail,&nbsp;entry.getKey()),&nbsp;entry.getValue());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(format(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;The&nbsp;object&nbsp;referenced&nbsp;through&nbsp;'%s'&nbsp;cannot&nbsp;be&nbsp;safely&nbsp;serialized&nbsp;as&nbsp;JSON&amp;quot;,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trail));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;to&nbsp;json&nbsp;the&nbsp;provided&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawData<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;data&nbsp;as&nbsp;a&nbsp;string&nbsp;to&nbsp;read&nbsp;and&nbsp;parse.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parsing&nbsp;should&nbsp;be&nbsp;as&nbsp;specified&nbsp;in&nbsp;doc.&nbsp;e.g:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;Json#readJson(Reader)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;According&nbsp;to&nbsp;its&nbsp;type,&nbsp;a&nbsp;cast&nbsp;must&nbsp;be&nbsp;necessary&nbsp;to&nbsp;extract&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;exception&nbsp;occurs&nbsp;during&nbsp;parsing&nbsp;the&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&amp;lt;T&amp;gt;&nbsp;T&nbsp;readJson(final&nbsp;String&nbsp;rawData)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(rawData&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;readJson(new&nbsp;StringReader(rawData));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;to&nbsp;json&nbsp;the&nbsp;provided&nbsp;reader.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;reader<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;data&nbsp;to&nbsp;parse.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parsing&nbsp;should&nbsp;be&nbsp;as&nbsp;specified&nbsp;in&nbsp;doc.&nbsp;e.g:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;b&amp;gt;JSON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Type&nbsp;Java&nbsp;Type&amp;lt;/b&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;------------------------------------<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;LinkedHashMap&amp;lt;String,?&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;array&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;LinkedList&amp;lt;?&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;String<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Integer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;float&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Float<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;true|false&nbsp;|&nbsp;Boolean<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;null<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parsed&nbsp;JSON&nbsp;into&nbsp;its&nbsp;corresponding&nbsp;java&nbsp;type.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;exception&nbsp;occurs&nbsp;during&nbsp;parsing&nbsp;the&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&amp;lt;T&amp;gt;&nbsp;T&nbsp;readJson(final&nbsp;Reader&nbsp;reader)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parse(STRICT_MAPPER,&nbsp;reader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;function&nbsp;it's&nbsp;only&nbsp;used&nbsp;to&nbsp;read&nbsp;our&nbsp;configuration&nbsp;files&nbsp;and&nbsp;allows<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;JSON&nbsp;files&nbsp;to&nbsp;contain&nbsp;non&nbsp;strict&nbsp;JSON&nbsp;such&nbsp;as&nbsp;comments&nbsp;or&nbsp;single&nbsp;quotes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;reader<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;stream&nbsp;of&nbsp;data&nbsp;to&nbsp;parse.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;map&nbsp;containing&nbsp;the&nbsp;parsed&nbsp;configuration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;during&nbsp;reading/parsing&nbsp;the&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;readJsonLenient(final&nbsp;Reader&nbsp;reader)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parse(LENIENT_MAPPER,&nbsp;reader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;function&nbsp;it's&nbsp;only&nbsp;used&nbsp;to&nbsp;read&nbsp;our&nbsp;configuration&nbsp;files&nbsp;and&nbsp;allows<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;JSON&nbsp;files&nbsp;to&nbsp;contain&nbsp;non&nbsp;strict&nbsp;JSON&nbsp;such&nbsp;as&nbsp;comments&nbsp;or&nbsp;single&nbsp;quotes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;input&nbsp;stream&nbsp;containing&nbsp;the&nbsp;json&nbsp;configuration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;map&nbsp;containing&nbsp;the&nbsp;parsed&nbsp;configuration.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;during&nbsp;reading/parsing&nbsp;the&nbsp;data.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;readJsonLenient(final&nbsp;InputStream&nbsp;in)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parse(LENIENT_MAPPER,&nbsp;new&nbsp;InputStreamReader(in));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;&amp;lt;T&amp;gt;&nbsp;T&nbsp;parse(ObjectMapper&nbsp;mapper,&nbsp;Reader&nbsp;reader)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reader&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;JsonParser&nbsp;jp&nbsp;=&nbsp;mapper.getFactory().createParser(reader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;JsonToken&nbsp;jToken&nbsp;=&nbsp;jp.nextToken();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jToken&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(jToken)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;START_ARRAY:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;LinkedList&amp;lt;?&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;START_OBJECT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;LinkedHashMap&amp;lt;String,&nbsp;?&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_FALSE:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_TRUE:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Boolean&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NUMBER_INT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Integer&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NUMBER_FLOAT:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mapper.readValue(jp,&nbsp;new&nbsp;TypeReference&amp;lt;Float&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VALUE_NULL:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;is&nbsp;very&nbsp;unlikely&nbsp;to&nbsp;happen.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IOException(&amp;quot;Invalid&nbsp;JSON&nbsp;content&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Writes&nbsp;the&nbsp;JSON&nbsp;content&nbsp;of&nbsp;the&nbsp;object&nbsp;passed&nbsp;in&nbsp;parameter.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;objectToWrite<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;we&nbsp;want&nbsp;to&nbsp;serialize&nbsp;as&nbsp;JSON&nbsp;output.&nbsp;The<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;Json&nbsp;output&nbsp;as&nbsp;a&nbsp;string.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IOException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;during&nbsp;writing/mapping&nbsp;content.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;byte[]&nbsp;writeJson(final&nbsp;Object&nbsp;objectToWrite)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;STRICT_MAPPER.writeValueAsBytes(objectToWrite);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Json.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilLoaderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Loader.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Loader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Loader.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,138&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;java.net.URL;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.ServiceLoader;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Provides&nbsp;methods&nbsp;for&nbsp;dynamically&nbsp;loading&nbsp;classes.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;Loader&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Static&nbsp;methods&nbsp;only.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Loader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;class&nbsp;loader&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;consistently&nbsp;throughout&nbsp;the&nbsp;application.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;class&nbsp;loader&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;consistently&nbsp;throughout&nbsp;the&nbsp;application.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ClassLoader&nbsp;getClassLoader()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Thread.currentThread().getContextClassLoader();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;{@code&nbsp;Class}&nbsp;object&nbsp;associated&nbsp;with&nbsp;the&nbsp;class&nbsp;or&nbsp;interface&nbsp;with&nbsp;the&nbsp;given<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;name,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;the&nbsp;class&nbsp;could&nbsp;not&nbsp;be&nbsp;returned&nbsp;for&nbsp;any&nbsp;reason.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;desired&nbsp;class.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;Class&nbsp;object&nbsp;for&nbsp;the&nbsp;class&nbsp;with&nbsp;the&nbsp;specified&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Class&amp;lt;?&amp;gt;&nbsp;getClass(String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Class.forName(name,&nbsp;true,&nbsp;getClassLoader());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Throwable&nbsp;t)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;a&nbsp;named&nbsp;class.&nbsp;The&nbsp;class&nbsp;is&nbsp;instantiated&nbsp;as&nbsp;if&nbsp;by&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;new}&nbsp;expression&nbsp;with&nbsp;an&nbsp;empty&nbsp;argument&nbsp;list.&nbsp;If&nbsp;the&nbsp;class&nbsp;cannot&nbsp;be&nbsp;instantiated<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;for&nbsp;any&nbsp;reason,&nbsp;{@code&nbsp;null}&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;class&nbsp;to&nbsp;instantiate.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;newly&nbsp;instantiated&nbsp;object,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;instantiated.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Object&nbsp;newInstance(String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getClass(name).newInstance();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(Throwable&nbsp;t)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;a&nbsp;named&nbsp;class.&nbsp;The&nbsp;class&nbsp;is&nbsp;instantiated&nbsp;as&nbsp;if&nbsp;by&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;new}&nbsp;expression&nbsp;with&nbsp;an&nbsp;empty&nbsp;argument&nbsp;list.&nbsp;If&nbsp;the&nbsp;class&nbsp;cannot&nbsp;be&nbsp;instantiated<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;for&nbsp;any&nbsp;reason,&nbsp;{@code&nbsp;null}&nbsp;is&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;name&nbsp;of&nbsp;the&nbsp;class&nbsp;to&nbsp;instantiate.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;type&nbsp;the&nbsp;class&nbsp;of&nbsp;the&nbsp;type&nbsp;of&nbsp;object&nbsp;to&nbsp;instantiate.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;&nbsp;class&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;newly&nbsp;instantiated&nbsp;object,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;it&nbsp;could&nbsp;not&nbsp;be&nbsp;instantiated.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&amp;lt;T&amp;gt;&nbsp;T&nbsp;newInstance(String&nbsp;name,&nbsp;Class&amp;lt;T&amp;gt;&nbsp;type)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;object&nbsp;=&nbsp;newInstance(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(object&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;!type.isInstance(object))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(T)&nbsp;object;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Loads&nbsp;services&nbsp;of&nbsp;a&nbsp;particular&nbsp;type&nbsp;into&nbsp;a&nbsp;map.&nbsp;Such&nbsp;services&nbsp;implement&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@link&nbsp;Indexed}&nbsp;interface&nbsp;to&nbsp;provide&nbsp;a&nbsp;key&nbsp;to&nbsp;index&nbsp;the&nbsp;service&nbsp;by&nbsp;in&nbsp;the&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;keyType&nbsp;the&nbsp;class&nbsp;type&nbsp;of&nbsp;the&nbsp;key&nbsp;to&nbsp;be&nbsp;indexed&nbsp;in&nbsp;the&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;serviceType&nbsp;the&nbsp;class&nbsp;type&nbsp;of&nbsp;services&nbsp;to&nbsp;load.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;K&amp;gt;&nbsp;key&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;V&amp;gt;&nbsp;service&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;map&nbsp;containing&nbsp;the&nbsp;loaded&nbsp;services,&nbsp;indexed&nbsp;by&nbsp;the&nbsp;services'&nbsp;keys.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&amp;lt;K,&nbsp;V&nbsp;extends&nbsp;Indexed&amp;lt;K&amp;gt;&amp;gt;&nbsp;Map&amp;lt;K,&nbsp;V&amp;gt;&nbsp;loadMap(Class&amp;lt;K&amp;gt;&nbsp;keyType,&nbsp;Class&amp;lt;V&amp;gt;&nbsp;serviceType)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HashMap&amp;lt;K,&nbsp;V&amp;gt;&nbsp;map&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;K,&nbsp;V&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(V&nbsp;v&nbsp;:&nbsp;ServiceLoader.load(serviceType,&nbsp;getClassLoader()))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(v.getKey(),&nbsp;v);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;map;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Loads&nbsp;services&nbsp;of&nbsp;a&nbsp;particular&nbsp;type&nbsp;into&nbsp;a&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;serviceType&nbsp;the&nbsp;class&nbsp;type&nbsp;of&nbsp;services&nbsp;to&nbsp;load.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;E&amp;gt;&nbsp;service&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;list&nbsp;containing&nbsp;the&nbsp;loaded&nbsp;services.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&amp;lt;E&amp;gt;&nbsp;List&amp;lt;E&amp;gt;&nbsp;loadList(Class&amp;lt;E&amp;gt;&nbsp;serviceType)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&amp;lt;E&amp;gt;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;E&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(E&nbsp;e&nbsp;:&nbsp;ServiceLoader.load(serviceType,&nbsp;getClassLoader()))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Finds&nbsp;the&nbsp;resource&nbsp;with&nbsp;the&nbsp;given&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;the&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;{@code&nbsp;URL}&nbsp;object&nbsp;for&nbsp;reading&nbsp;the&nbsp;resource,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;the&nbsp;resource&nbsp;could&nbsp;not&nbsp;be&nbsp;found.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;ClassLoader#getResource(java.lang.String)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;URL&nbsp;getResource(String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getClassLoader().getResource(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/Loader.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilMultiValueMapjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/MultiValueMap.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/MultiValueMap.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/MultiValueMap.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,127&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2009&nbsp;Sun&nbsp;Microsystems&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.util.MapDecorator;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Wraps&nbsp;a&nbsp;map&nbsp;for&nbsp;which&nbsp;the&nbsp;values&nbsp;are&nbsp;lists,&nbsp;providing&nbsp;a&nbsp;set&nbsp;of&nbsp;convenience&nbsp;methods&nbsp;for<br>
+&nbsp;*&nbsp;handling&nbsp;list&nbsp;values.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;K&amp;gt;&nbsp;Key&nbsp;type<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;V&amp;gt;&nbsp;Value&nbsp;type&nbsp;(of&nbsp;the&nbsp;list)<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;MultiValueMap&amp;lt;K,&nbsp;V&amp;gt;&nbsp;extends&nbsp;MapDecorator&amp;lt;K,&nbsp;List&amp;lt;V&amp;gt;&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;multi-value&nbsp;map,&nbsp;wrapping&nbsp;an&nbsp;existing&nbsp;map&nbsp;with&nbsp;list&nbsp;values.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;map&nbsp;the&nbsp;map&nbsp;to&nbsp;wrap&nbsp;with&nbsp;a&nbsp;new&nbsp;multi-value&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;MultiValueMap(Map&amp;lt;K,&nbsp;List&amp;lt;V&amp;gt;&amp;gt;&nbsp;map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(map);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;specified&nbsp;value&nbsp;to&nbsp;the&nbsp;list&nbsp;for&nbsp;the&nbsp;specified&nbsp;key.&nbsp;If&nbsp;no&nbsp;list&nbsp;for&nbsp;the&nbsp;key&nbsp;yet<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;exists&nbsp;in&nbsp;the&nbsp;map,&nbsp;a&nbsp;new&nbsp;list&nbsp;is&nbsp;created&nbsp;and&nbsp;added.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;key&nbsp;the&nbsp;key&nbsp;of&nbsp;the&nbsp;list&nbsp;to&nbsp;add&nbsp;the&nbsp;value&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;value&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;add(K&nbsp;key,&nbsp;V&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;V&amp;gt;&nbsp;list&nbsp;=&nbsp;get(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(list&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;V&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(key,&nbsp;list);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;specified&nbsp;values&nbsp;to&nbsp;the&nbsp;list&nbsp;for&nbsp;the&nbsp;specified&nbsp;key.&nbsp;If&nbsp;no&nbsp;list&nbsp;for&nbsp;the&nbsp;key<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;yet&nbsp;exists&nbsp;in&nbsp;the&nbsp;map,&nbsp;a&nbsp;new&nbsp;list&nbsp;is&nbsp;created&nbsp;and&nbsp;added.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;key&nbsp;the&nbsp;key&nbsp;of&nbsp;the&nbsp;list&nbsp;to&nbsp;add&nbsp;the&nbsp;values&nbsp;to.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;values&nbsp;the&nbsp;values&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;list.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAll(K&nbsp;key,&nbsp;Collection&amp;lt;?&nbsp;extends&nbsp;V&amp;gt;&nbsp;values)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;V&amp;gt;&nbsp;list&nbsp;=&nbsp;get(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(list&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;V&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(key,&nbsp;list);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.addAll(values);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;specified&nbsp;keys&nbsp;and&nbsp;values&nbsp;from&nbsp;the&nbsp;specified&nbsp;map&nbsp;into&nbsp;this&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;map&nbsp;the&nbsp;map&nbsp;whose&nbsp;keys&nbsp;and&nbsp;values&nbsp;are&nbsp;to&nbsp;be&nbsp;added.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAll(MultiValueMap&amp;lt;K,&nbsp;V&amp;gt;&nbsp;map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(K&nbsp;key&nbsp;:&nbsp;map.keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addAll(key,&nbsp;map.get(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;specified&nbsp;keys&nbsp;and&nbsp;values&nbsp;from&nbsp;the&nbsp;specified&nbsp;map&nbsp;into&nbsp;this&nbsp;map.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;map&nbsp;the&nbsp;map&nbsp;whose&nbsp;keys&nbsp;and&nbsp;values&nbsp;are&nbsp;to&nbsp;be&nbsp;added.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAll(Map&amp;lt;?&nbsp;extends&nbsp;K,&nbsp;Collection&amp;lt;?&nbsp;extends&nbsp;V&amp;gt;&amp;gt;&nbsp;map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(K&nbsp;key&nbsp;:&nbsp;map.keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addAll(key,&nbsp;map.get(key));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;first&nbsp;value&nbsp;in&nbsp;the&nbsp;list&nbsp;of&nbsp;values&nbsp;for&nbsp;the&nbsp;matching&nbsp;key,&nbsp;or&nbsp;{@code&nbsp;null}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;if&nbsp;no&nbsp;such&nbsp;value&nbsp;exists.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;key&nbsp;the&nbsp;key&nbsp;whose&nbsp;associated&nbsp;first&nbsp;item&nbsp;is&nbsp;to&nbsp;be&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;first&nbsp;value&nbsp;in&nbsp;the&nbsp;key's&nbsp;value&nbsp;list,&nbsp;or&nbsp;null&nbsp;if&nbsp;non-existent.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;V&nbsp;getFirst(K&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;V&amp;gt;&nbsp;list&nbsp;=&nbsp;get(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(list&nbsp;==&nbsp;null&nbsp;||&nbsp;list.size()&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list.get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Maps&nbsp;a&nbsp;single&nbsp;value&nbsp;to&nbsp;the&nbsp;specified&nbsp;key,&nbsp;replacing&nbsp;any&nbsp;value(s)&nbsp;that&nbsp;are&nbsp;already<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;mapped&nbsp;to&nbsp;that&nbsp;key.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;key&nbsp;key&nbsp;with&nbsp;which&nbsp;the&nbsp;specified&nbsp;value&nbsp;is&nbsp;to&nbsp;be&nbsp;mapped.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;single&nbsp;value&nbsp;to&nbsp;be&nbsp;mapped&nbsp;to&nbsp;the&nbsp;specified&nbsp;key.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;putSingle(K&nbsp;key,&nbsp;V&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add(key,&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/MultiValueMap.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilSetDecoratorjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/SetDecorator.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/SetDecorator.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/SetDecorator.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,227&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.Iterator;<br>
+import&nbsp;java.util.Set;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Contains&nbsp;another&nbsp;set,&nbsp;which&nbsp;is&nbsp;uses&nbsp;as&nbsp;its&nbsp;basic&nbsp;source&nbsp;of&nbsp;data,&nbsp;possibly&nbsp;transforming&nbsp;the<br>
+&nbsp;*&nbsp;data&nbsp;along&nbsp;the&nbsp;way.&nbsp;This&nbsp;class&nbsp;itself&nbsp;simply&nbsp;overrides&nbsp;all&nbsp;methods&nbsp;of&nbsp;{@link&nbsp;Set}&nbsp;with<br>
+&nbsp;*&nbsp;versions&nbsp;that&nbsp;pass&nbsp;all&nbsp;requests&nbsp;to&nbsp;the&nbsp;contained&nbsp;set.&nbsp;Subclasses&nbsp;may&nbsp;further&nbsp;override<br>
+&nbsp;*&nbsp;some&nbsp;of&nbsp;these&nbsp;methods&nbsp;and&nbsp;may&nbsp;also&nbsp;provide&nbsp;additional&nbsp;methods&nbsp;and&nbsp;fields.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;E&amp;gt;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;set&nbsp;decorator.<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;SetDecorator&amp;lt;E&amp;gt;&nbsp;implements&nbsp;Set&amp;lt;E&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;set&nbsp;wrapped&nbsp;by&nbsp;this&nbsp;decorator.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;final&nbsp;Set&amp;lt;E&amp;gt;&nbsp;set;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;set&nbsp;decorator,&nbsp;wrapping&nbsp;the&nbsp;specified&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;set&nbsp;the&nbsp;set&nbsp;to&nbsp;wrap&nbsp;with&nbsp;the&nbsp;decorator.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;SetDecorator(Set&amp;lt;E&amp;gt;&nbsp;set)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(set&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;NullPointerException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.set&nbsp;=&nbsp;set;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;size()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.size();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;the&nbsp;specified&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;o&nbsp;element&nbsp;whose&nbsp;presence&nbsp;in&nbsp;the&nbsp;set&nbsp;is&nbsp;to&nbsp;be&nbsp;tested.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;the&nbsp;specified&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;specified&nbsp;element&nbsp;is&nbsp;incompatible&nbsp;with&nbsp;the&nbsp;set&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;element&nbsp;is&nbsp;{@code&nbsp;null}&nbsp;and&nbsp;the&nbsp;set&nbsp;does&nbsp;not&nbsp;permit&nbsp;null<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;elements&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;contains(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.contains(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Iterator&amp;lt;E&amp;gt;&nbsp;iterator()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.iterator();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object[]&nbsp;toArray()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.toArray();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;array&nbsp;containing&nbsp;all&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;set;&nbsp;the&nbsp;runtime&nbsp;type&nbsp;of&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;returned&nbsp;array&nbsp;is&nbsp;that&nbsp;of&nbsp;the&nbsp;specified&nbsp;array.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;a&nbsp;the&nbsp;array&nbsp;into&nbsp;which&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;set&nbsp;are&nbsp;to&nbsp;be&nbsp;stored,&nbsp;if&nbsp;it&nbsp;is&nbsp;big&nbsp;enough;&nbsp;otherwise,&nbsp;a&nbsp;new<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;array&nbsp;of&nbsp;the&nbsp;same&nbsp;runtime&nbsp;type&nbsp;is&nbsp;allocated&nbsp;for&nbsp;this&nbsp;purpose.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;&nbsp;runtime&nbsp;type&nbsp;of&nbsp;the&nbsp;array<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;an&nbsp;array&nbsp;containing&nbsp;all&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ArrayStoreException&nbsp;if&nbsp;the&nbsp;runtime&nbsp;type&nbsp;of&nbsp;the&nbsp;specified&nbsp;array&nbsp;is&nbsp;not&nbsp;a&nbsp;supertype&nbsp;of&nbsp;the&nbsp;runtime&nbsp;type<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;of&nbsp;every&nbsp;element&nbsp;in&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;array&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;&amp;lt;T&amp;gt;&nbsp;T[]&nbsp;toArray(T[]&nbsp;a)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.toArray(a);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;the&nbsp;specified&nbsp;element&nbsp;to&nbsp;the&nbsp;set&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;already&nbsp;present&nbsp;(optional<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;e&nbsp;element&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;did&nbsp;not&nbsp;already&nbsp;contain&nbsp;the&nbsp;specified&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;{@code&nbsp;add}&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;class&nbsp;of&nbsp;the&nbsp;specified&nbsp;element&nbsp;prevents&nbsp;it&nbsp;from&nbsp;being&nbsp;added&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;element&nbsp;is&nbsp;{@code&nbsp;null}&nbsp;and&nbsp;the&nbsp;set&nbsp;does&nbsp;not&nbsp;permit&nbsp;null&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException&nbsp;if&nbsp;some&nbsp;property&nbsp;of&nbsp;the&nbsp;specified&nbsp;element&nbsp;prevents&nbsp;it&nbsp;from&nbsp;being&nbsp;added&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;add(E&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.add(e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;the&nbsp;specified&nbsp;element&nbsp;from&nbsp;the&nbsp;set&nbsp;if&nbsp;it&nbsp;is&nbsp;present&nbsp;(optional&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;o&nbsp;object&nbsp;to&nbsp;be&nbsp;removed&nbsp;from&nbsp;the&nbsp;set,&nbsp;if&nbsp;present.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;contained&nbsp;the&nbsp;specified&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;specified&nbsp;element&nbsp;is&nbsp;incompatible&nbsp;with&nbsp;the&nbsp;set&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;element&nbsp;is&nbsp;{@code&nbsp;null}&nbsp;and&nbsp;the&nbsp;set&nbsp;does&nbsp;not&nbsp;permit&nbsp;null<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;elements&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;{@code&nbsp;remove}&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;remove(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.remove(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;all&nbsp;of&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;collection.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;c&nbsp;collection&nbsp;to&nbsp;be&nbsp;checked&nbsp;for&nbsp;containment&nbsp;in&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;all&nbsp;of&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;specified&nbsp;collection.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;types&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;elements&nbsp;in&nbsp;the&nbsp;specified&nbsp;collection&nbsp;are&nbsp;incompatible<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;with&nbsp;the&nbsp;set&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;contains&nbsp;one&nbsp;or&nbsp;more&nbsp;{@code&nbsp;null}&nbsp;elements&nbsp;and&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;set&nbsp;does&nbsp;not&nbsp;permit&nbsp;null&nbsp;elements&nbsp;(optional),&nbsp;or&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.containsAll(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;all&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;specified&nbsp;collection&nbsp;to&nbsp;the&nbsp;set&nbsp;if&nbsp;they're&nbsp;not&nbsp;already<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;present&nbsp;(optional&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;c&nbsp;collection&nbsp;containing&nbsp;elements&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;changed&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;the&nbsp;call.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;{@code&nbsp;addAll}&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;class&nbsp;of&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;specified&nbsp;collection&nbsp;prevents&nbsp;it&nbsp;from&nbsp;being<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;added&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;contains&nbsp;one&nbsp;or&nbsp;more&nbsp;{@code&nbsp;null}&nbsp;elements&nbsp;and&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;set&nbsp;does&nbsp;not&nbsp;permit&nbsp;null&nbsp;elements,&nbsp;or&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException&nbsp;if&nbsp;some&nbsp;property&nbsp;of&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;specified&nbsp;collection&nbsp;prevents&nbsp;it&nbsp;from<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;being&nbsp;added&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;addAll(Collection&amp;lt;?&nbsp;extends&nbsp;E&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.addAll(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Retains&nbsp;only&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;set&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;the&nbsp;specified&nbsp;collection<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;(optional&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;c&nbsp;collection&nbsp;containing&nbsp;elements&nbsp;to&nbsp;be&nbsp;retained&nbsp;in&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;changed&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;the&nbsp;call.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;retainAll&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;class&nbsp;of&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;set&nbsp;is&nbsp;incompatible&nbsp;with&nbsp;the&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;collection&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;element&nbsp;and&nbsp;the&nbsp;specified&nbsp;collection&nbsp;does<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;not&nbsp;permit&nbsp;null&nbsp;elements&nbsp;(optional),&nbsp;or&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;retainAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.retainAll(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;from&nbsp;the&nbsp;set&nbsp;all&nbsp;of&nbsp;its&nbsp;elements&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;the&nbsp;specified&nbsp;collection<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;(optional&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;c&nbsp;collection&nbsp;containing&nbsp;elements&nbsp;to&nbsp;be&nbsp;removed&nbsp;from&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;set&nbsp;changed&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;the&nbsp;call.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;{@code&nbsp;removeAll}&nbsp;operation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;ClassCastException&nbsp;if&nbsp;the&nbsp;class&nbsp;of&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;set&nbsp;is&nbsp;incompatible&nbsp;with&nbsp;the&nbsp;specified<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;collection&nbsp;(optional).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;NullPointerException&nbsp;if&nbsp;the&nbsp;set&nbsp;contains&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;element&nbsp;and&nbsp;the&nbsp;specified&nbsp;collection&nbsp;does<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;not&nbsp;permit&nbsp;null&nbsp;elements&nbsp;(optional),&nbsp;or&nbsp;if&nbsp;the&nbsp;specified&nbsp;collection&nbsp;is&nbsp;{@code&nbsp;null}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;removeAll(Collection&amp;lt;?&amp;gt;&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.removeAll(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;all&nbsp;of&nbsp;the&nbsp;elements&nbsp;from&nbsp;the&nbsp;set&nbsp;(optional&nbsp;operation).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;UnsupportedOperationException&nbsp;if&nbsp;the&nbsp;{@code&nbsp;clear}&nbsp;method&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;clear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Compares&nbsp;the&nbsp;specified&nbsp;object&nbsp;with&nbsp;the&nbsp;set&nbsp;for&nbsp;equality.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;o&nbsp;object&nbsp;to&nbsp;be&nbsp;compared&nbsp;for&nbsp;equality&nbsp;with&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;the&nbsp;specified&nbsp;object&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;set.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;equals(Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.equals(o);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;hashCode()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;set.hashCode();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/SetDecorator.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilStandardCharsetsjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/StandardCharsets.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/StandardCharsets.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/StandardCharsets.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,37&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;java.nio.charset.Charset.*;<br>
+<br>
+import&nbsp;java.nio.charset.Charset;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Defines&nbsp;standards&nbsp;charsets&nbsp;used&nbsp;in&nbsp;OpenIG.&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;b&amp;gt;Note&nbsp;for&nbsp;Java&nbsp;7&nbsp;and&nbsp;later:&amp;lt;/b&amp;gt;<br>
+&nbsp;*&nbsp;this&nbsp;class&nbsp;will&nbsp;be&nbsp;removed&nbsp;and&nbsp;all&nbsp;references&nbsp;should&nbsp;be<br>
+&nbsp;*&nbsp;updated&nbsp;to&nbsp;{@link&nbsp;java.nio.charset.StandardCharsets}&nbsp;instead.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;StandardCharsets&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;UTF-8&nbsp;Charset.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;Charset&nbsp;UTF_8&nbsp;=&nbsp;forName(&amp;quot;UTF-8&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;ISO-8859-1&nbsp;Charset.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;Charset&nbsp;ISO_8859_1&nbsp;=&nbsp;forName(&amp;quot;ISO-8859-1&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;StandardCharsets()&nbsp;{&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/StandardCharsets.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilUnmodifiableCollectionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/UnmodifiableCollection.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/UnmodifiableCollection.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/UnmodifiableCollection.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,23&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;marker&nbsp;interface&nbsp;for&nbsp;tagging&nbsp;collection&nbsp;implementations&nbsp;as&nbsp;read-only.<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;UnmodifiableCollection&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;No&nbsp;methods.<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/UnmodifiableCollection.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavaorgforgerockhttputilpackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,21&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Miscellaneous&nbsp;utility&nbsp;classes.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.util;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/java/org/forgerock/http/util/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainjavadocoverviewhtml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/javadoc/overview.html&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/javadoc/overview.html&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/javadoc/overview.html&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,24&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&amp;quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN&amp;quot;&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;html&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;body&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;core&nbsp;functionality&nbsp;of&nbsp;the&nbsp;Open&nbsp;Identity&nbsp;Gateway.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/body&amp;gt;<br>
+&amp;lt;/html&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/main/javadoc/overview.html<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrcmainresourcesMETAINFservicesorgforgerockhttpdecoderDecoder&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/services/org.forgerock.http.decoder.Decoder&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/services/org.forgerock.http.decoder.Decoder&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/main/resources/META-INF/services/org.forgerock.http.decoder.Decoder&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,2&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+org.forgerock.http.decoder.GzipDecoder<br>
+org.forgerock.http.decoder.DeflateDecoder<br>
&lt;/ins&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpEntityTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/EntityTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/EntityTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/EntityTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,342&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.entry;<br>
+import&nbsp;static&nbsp;org.forgerock.http.Entity.APPLICATION_JSON_CHARSET_UTF_8;<br>
+import&nbsp;static&nbsp;org.mockito.AdditionalAnswers.delegatesTo;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.*;<br>
+<br>
+import&nbsp;org.forgerock.http.header.ContentLengthHeader;<br>
+import&nbsp;org.forgerock.http.header.ContentTypeHeader;<br>
+import&nbsp;org.forgerock.http.io.BranchingInputStream;<br>
+import&nbsp;org.forgerock.http.io.IO;<br>
+import&nbsp;org.testng.annotations.BeforeMethod;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.UnsupportedEncodingException;<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;EntityTest&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;INVALID_JSON&nbsp;=&nbsp;&amp;quot;invalid&nbsp;json&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;JSON_CONTENT1&nbsp;=&nbsp;singleQuotesToDouble(&amp;quot;{'a':1,'b':2}&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;JSON_CONTENT2&nbsp;=&nbsp;singleQuotesToDouble(&amp;quot;{'c':3,'d':4}&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Entity&nbsp;entity;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Request&nbsp;message;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;mockJsonContent1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;mockJsonContent2;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@BeforeMethod<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;beforeMethod()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity&nbsp;=&nbsp;message.getEntity();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mockJsonContent1&nbsp;=&nbsp;mockContent(JSON_CONTENT1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mockJsonContent2&nbsp;=&nbsp;mockContent(JSON_CONTENT2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;entityIsEmptyByDefault()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.newDecodedContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.newDecodedContentReader(null).readLine()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getBytes()).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getString()).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.toString()).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.push();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.pop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getBytes()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getBytes()).isEqualTo(bytes(JSON_CONTENT1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mockJsonContent1.available()).isEqualTo(JSON_CONTENT1.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1,&nbsp;never()).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getJson()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isInstanceOf(Map.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;?,&nbsp;?&amp;gt;&nbsp;jsonEntity&nbsp;=&nbsp;((Map&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;entity.getJson());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).contains(entry(&amp;quot;a&amp;quot;,&nbsp;1),&nbsp;entry(&amp;quot;b&amp;quot;,&nbsp;2));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1,&nbsp;never()).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getJsonWhenEntityContainsInvalidJsonThrowsIOException()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mockJsonContent1&nbsp;=&nbsp;mockContent(INVALID_JSON);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.getJson();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;stream&nbsp;should&nbsp;be&nbsp;untouched&nbsp;despite&nbsp;the&nbsp;error.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mockJsonContent1.available()).isEqualTo(INVALID_JSON.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1,&nbsp;never()).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getJsonWhenEntityIsEmpty()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getPushAndPop()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;We&nbsp;cannot&nbsp;use&nbsp;the&nbsp;mock&nbsp;content&nbsp;here&nbsp;because&nbsp;it&nbsp;is&nbsp;bypassed&nbsp;during<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;calling&nbsp;getParent()&nbsp;on&nbsp;the&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;BranchingInputStream&nbsp;content&nbsp;=&nbsp;IO.newBranchingInputStream(bytes(JSON_CONTENT1));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(content);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.push();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream()).isNotSameAs(content);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.getRawContentInputStream().close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream()).isNotSameAs(content);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.pop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream()).isSameAs(content);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(content.available()).isEqualTo(JSON_CONTENT1.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getRawInputStream()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream()).isSameAs(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mockJsonContent1.available()).isEqualTo(JSON_CONTENT1.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1,&nbsp;never()).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getString()).isEqualTo(JSON_CONTENT1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mockJsonContent1.available()).isEqualTo(JSON_CONTENT1.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1,&nbsp;never()).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setBytes()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setBytes(bytes(JSON_CONTENT2));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentLengthHeaderIsPresentForJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentyTypeHeaderIsNotPresent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setBytesNullBecomesEmptyStream()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setBytes(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setJson()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jsonEntity&nbsp;=&nbsp;new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;Object&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsonEntity.put(&amp;quot;c&amp;quot;,&nbsp;3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsonEntity.put(&amp;quot;d&amp;quot;,&nbsp;4);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setJson(jsonEntity);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentLengthHeaderIsPresentForJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentTypeHeaderIsPresent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setJsonAsBean()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&nbsp;MyBean&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;name;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MyBean(final&nbsp;String&nbsp;mName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;mName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@SuppressWarnings(&amp;quot;unused&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@SuppressWarnings(&amp;quot;unused&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setName(String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;json&nbsp;=&nbsp;singleQuotesToDouble(&amp;quot;{'name':'Jackson'}&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;MyBean&nbsp;mybean&nbsp;=&nbsp;new&nbsp;MyBean(&amp;quot;Jackson&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setJson(mybean);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isSameAs(mybean);&nbsp;//&nbsp;Shouldn't&nbsp;this&nbsp;to&nbsp;be&nbsp;the&nbsp;json&nbsp;representation&nbsp;?<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getString()).isEqualTo(json);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setJsonNullIsJsonNull()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setJson(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(&amp;quot;null&amp;quot;.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawInputStream()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentLengthHeaderIsNotPresent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentyTypeHeaderIsNotPresent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setRawInputStreamNullBecomesEmptyStream()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setString(JSON_CONTENT2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentLengthHeaderIsPresentForJsonContent2();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentyTypeHeaderIsNotPresent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setStringNullBecomesEmptyStream()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThatContentIsJsonContent1();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setString(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParseJsonObjectReturnsLinkedHashMap()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setRawContentInputStream(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isInstanceOf(LinkedHashMap.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldMarkTheEntityAsEmpty()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;entity&nbsp;is&nbsp;initialized&nbsp;with&nbsp;some&nbsp;content&nbsp;by&nbsp;default<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setJson(new&nbsp;HashMap&amp;lt;String,&nbsp;Object&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.setEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldBeEmptyEvenInPushMode()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.push();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.mayContainData()).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.pop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentIsJsonContent1()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getString()).isEqualTo(JSON_CONTENT1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getBytes()).isEqualTo(bytes(JSON_CONTENT1));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isInstanceOf(LinkedHashMap.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;?,&nbsp;?&amp;gt;&nbsp;jsonEntity&nbsp;=&nbsp;((LinkedHashMap&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;entity.getJson());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).contains(entry(&amp;quot;a&amp;quot;,&nbsp;1),&nbsp;entry(&amp;quot;b&amp;quot;,&nbsp;2));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mockJsonContent1.available()).isEqualTo(JSON_CONTENT1.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentIsJsonContent2()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream()).isNotSameAs(mockJsonContent1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getBytes()).isEqualTo(bytes(JSON_CONTENT2));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getJson()).isInstanceOf(LinkedHashMap.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;?,&nbsp;?&amp;gt;&nbsp;jsonEntity&nbsp;=&nbsp;((LinkedHashMap&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;entity.getJson());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonEntity).contains(entry(&amp;quot;c&amp;quot;,&nbsp;3),&nbsp;entry(&amp;quot;d&amp;quot;,&nbsp;4));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(entity.getRawContentInputStream().available()).isEqualTo(JSON_CONTENT2.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verify(mockJsonContent1).close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentLengthHeaderIsNotPresent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(message.getHeaders().get(ContentLengthHeader.NAME)).isNullOrEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentLengthHeaderIsPresentForJsonContent2()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(message.getHeaders()).containsEntry(ContentLengthHeader.NAME,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays.asList(String.valueOf(JSON_CONTENT2.length())));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentTypeHeaderIsPresent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(message.getHeaders()).containsEntry(ContentTypeHeader.NAME,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays.asList(APPLICATION_JSON_CHARSET_UTF_8));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;assertThatContentyTypeHeaderIsNotPresent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(message.getHeaders().get(ContentTypeHeader.NAME)).isNullOrEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;byte[]&nbsp;bytes(final&nbsp;String&nbsp;s)&nbsp;throws&nbsp;UnsupportedEncodingException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s.getBytes(&amp;quot;UTF-8&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;mockContent(final&nbsp;byte[]&nbsp;bytes)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mock(BranchingInputStream.class,&nbsp;delegatesTo(IO.newBranchingInputStream(bytes)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Input&nbsp;streams&nbsp;are&nbsp;painful&nbsp;to&nbsp;mock,&nbsp;so&nbsp;we'll&nbsp;use&nbsp;the&nbsp;new&nbsp;delegating&nbsp;answer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;support&nbsp;in&nbsp;1.9.5&nbsp;to&nbsp;monitor&nbsp;and&nbsp;proxy&nbsp;calls&nbsp;to&nbsp;a&nbsp;real&nbsp;input&nbsp;stream.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingInputStream&nbsp;mockContent(final&nbsp;String&nbsp;content)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;UnsupportedEncodingException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mockContent(content.getBytes(&amp;quot;UTF-8&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Remove&nbsp;single&nbsp;quotes&nbsp;from&nbsp;a&nbsp;string.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;singleQuotesToDouble(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value.replace('\'',&nbsp;'\&amp;quot;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/EntityTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpFormTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/FormTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/FormTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/FormTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,82&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;java.net.URISyntaxException;<br>
+<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;FormTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;fromString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;f&nbsp;=&nbsp;new&nbsp;Form().fromString(&amp;quot;x=%3D&amp;amp;y=z&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;x&amp;quot;).get(0)).isEqualTo(&amp;quot;=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;y&amp;quot;).get(0)).isEqualTo(&amp;quot;z&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;fromStringAndBack()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;s1&nbsp;=&nbsp;&amp;quot;x=%3D&amp;amp;y=%3F&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;s2&nbsp;=&nbsp;new&nbsp;Form().fromString(s1).toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(s1).isEqualTo(s2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;fromRequestQuery()&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setUri(&amp;quot;http://www.example.com/?x=%3D&amp;amp;y=%3F&amp;amp;z=a&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;f&nbsp;=&nbsp;new&nbsp;Form().fromRequestQuery(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;x&amp;quot;).get(0)).isEqualTo(&amp;quot;=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;y&amp;quot;).get(0)).isEqualTo(&amp;quot;?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;z&amp;quot;).get(0)).isEqualTo(&amp;quot;a&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;toRequestQuery()&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setUri(&amp;quot;http://www.example.com/?x=%3D&amp;amp;y=%3F&amp;amp;z=a&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;f&nbsp;=&nbsp;new&nbsp;Form();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.add(&amp;quot;foo&amp;quot;,&nbsp;&amp;quot;bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.toRequestQuery(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;x&amp;quot;)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;y&amp;quot;)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;z&amp;quot;)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;foo&amp;quot;).get(0)).isEqualTo(&amp;quot;bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getUri().toString()).isEqualTo(&amp;quot;http://www.example.com/?foo=bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;appendRequestQuery()&nbsp;throws&nbsp;URISyntaxException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setUri(&amp;quot;http://www.example.com/?x=%3D&amp;amp;y=%3F&amp;amp;z=a&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;f&nbsp;=&nbsp;new&nbsp;Form();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.add(&amp;quot;foo&amp;quot;,&nbsp;&amp;quot;bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.appendRequestQuery(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.fromRequestQuery(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;x&amp;quot;).get(0)).isEqualTo(&amp;quot;=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;y&amp;quot;).get(0)).isEqualTo(&amp;quot;?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;z&amp;quot;).get(0)).isEqualTo(&amp;quot;a&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(f.get(&amp;quot;foo&amp;quot;).get(0)).isEqualTo(&amp;quot;bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;predictable&nbsp;iteration&nbsp;order&nbsp;should&nbsp;ensure&nbsp;added&nbsp;params&nbsp;appear&nbsp;at&nbsp;the&nbsp;end<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getUri().toASCIIString()).isEqualTo(&amp;quot;http://www.example.com/?x=%3D&amp;amp;y=%3F&amp;amp;z=a&amp;amp;foo=bar&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/FormTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpHandlersTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/HandlersTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/HandlersTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/HandlersTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,202&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2013-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.mockito.Matchers.any;<br>
+import&nbsp;static&nbsp;org.mockito.Matchers.same;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.doAnswer;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.inOrder;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.mock;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.verifyZeroInteractions;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.RootContext;<br>
+import&nbsp;org.forgerock.util.promise.AsyncFunction;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+import&nbsp;org.forgerock.util.promise.Promises;<br>
+import&nbsp;org.mockito.InOrder;<br>
+import&nbsp;org.mockito.invocation.InvocationOnMock;<br>
+import&nbsp;org.mockito.stubbing.Answer;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Tests&nbsp;the&nbsp;Handlers#chain&nbsp;method.<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;HandlersTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Response&nbsp;RESPONSE&nbsp;=&nbsp;new&nbsp;Response();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFilterCanInvokeAllFiltersAndHandler()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;target&nbsp;=&nbsp;target();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter1&nbsp;=&nbsp;mock(Filter.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(invoke()).when(filter1).filter(any(Context.class),&nbsp;any(Request.class),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter2&nbsp;=&nbsp;filter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;chain&nbsp;=&nbsp;Http.chainOf(target,&nbsp;filter1,&nbsp;filter2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;context();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;handler&nbsp;will&nbsp;be&nbsp;invoked&nbsp;twice&nbsp;which&nbsp;is&nbsp;obviously&nbsp;unrealistic.&nbsp;In&nbsp;practice,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;filter1&nbsp;will&nbsp;wrap&nbsp;the&nbsp;result&nbsp;handler&nbsp;and&nbsp;combine/reduce&nbsp;the&nbsp;result&nbsp;of&nbsp;the&nbsp;two<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;sub-reads&nbsp;to&nbsp;produce&nbsp;a&nbsp;single&nbsp;read&nbsp;response.&nbsp;We&nbsp;won't&nbsp;do&nbsp;that&nbsp;here&nbsp;in&nbsp;order<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;to&nbsp;keep&nbsp;the&nbsp;test&nbsp;simple.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.handle(context,&nbsp;request);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOrder&nbsp;inOrder&nbsp;=&nbsp;inOrder(filter1,&nbsp;filter2,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter1).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter2).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(target).handle(context,&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Tests&nbsp;that&nbsp;a&nbsp;filter&nbsp;can&nbsp;call&nbsp;next&nbsp;filter&nbsp;multiple&nbsp;times.&nbsp;If&nbsp;the&nbsp;cursoring<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;mechanism&nbsp;increments&nbsp;the&nbsp;index&nbsp;for&nbsp;each&nbsp;call&nbsp;then&nbsp;the&nbsp;first&nbsp;invocation<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;will&nbsp;iterate&nbsp;to&nbsp;the&nbsp;target&nbsp;causing&nbsp;the&nbsp;second&nbsp;invocation&nbsp;to&nbsp;go&nbsp;direct&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;target&nbsp;rather&nbsp;than&nbsp;the&nbsp;next&nbsp;filter.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFilterCanInvokeMultipleSubRequests()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;target&nbsp;=&nbsp;target();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter1&nbsp;=&nbsp;mock(Filter.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(invoke(2)).when(filter1).filter(any(Context.class),&nbsp;any(Request.class),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter2&nbsp;=&nbsp;filter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;chain&nbsp;=&nbsp;Http.chainOf(target,&nbsp;filter1,&nbsp;filter2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;context();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;handler&nbsp;will&nbsp;be&nbsp;invoked&nbsp;twice&nbsp;which&nbsp;is&nbsp;obviously&nbsp;unrealistic.&nbsp;In&nbsp;practice,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;filter1&nbsp;will&nbsp;wrap&nbsp;the&nbsp;result&nbsp;handler&nbsp;and&nbsp;combine/reduce&nbsp;the&nbsp;result&nbsp;of&nbsp;the&nbsp;two<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;sub-reads&nbsp;to&nbsp;produce&nbsp;a&nbsp;single&nbsp;read&nbsp;response.&nbsp;We&nbsp;won't&nbsp;do&nbsp;that&nbsp;here&nbsp;in&nbsp;order<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;to&nbsp;keep&nbsp;the&nbsp;test&nbsp;simple.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.handle(context,&nbsp;request);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOrder&nbsp;inOrder&nbsp;=&nbsp;inOrder(filter1,&nbsp;filter2,&nbsp;target,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter1).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;First&nbsp;read&nbsp;of&nbsp;next&nbsp;filter<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter2).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(target).handle(context,&nbsp;request);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Second&nbsp;read&nbsp;of&nbsp;next&nbsp;filter<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter2).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(target).handle(context,&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFilterCanStopProcessingWithError()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;target&nbsp;=&nbsp;target();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter1&nbsp;=&nbsp;mock(Filter.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(new&nbsp;Answer&amp;lt;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;answer(final&nbsp;InvocationOnMock&nbsp;invocation)&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newFailedPromise(new&nbsp;ResponseException(RESPONSE));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}).when(filter1).filter(any(Context.class),&nbsp;any(Request.class),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter2&nbsp;=&nbsp;filter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;chain&nbsp;=&nbsp;Http.chainOf(target,&nbsp;filter1,&nbsp;filter2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;context();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response&nbsp;response&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.handle(context,&nbsp;request).getOrThrowUninterruptibly();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(ResponseException&nbsp;error)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;error.getResponse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOrder&nbsp;inOrder&nbsp;=&nbsp;inOrder(filter1,&nbsp;filter2,&nbsp;target,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter1).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response).isEqualTo(RESPONSE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verifyZeroInteractions(filter2,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFilterCanStopProcessingWithResult()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;target&nbsp;=&nbsp;target();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter1&nbsp;=&nbsp;mock(Filter.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(new&nbsp;Answer&amp;lt;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;answer(final&nbsp;InvocationOnMock&nbsp;invocation)&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newSuccessfulPromise(RESPONSE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}).when(filter1).filter(any(Context.class),&nbsp;any(Request.class),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter2&nbsp;=&nbsp;filter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;chain&nbsp;=&nbsp;Http.chainOf(target,&nbsp;filter1,&nbsp;filter2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;context();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response&nbsp;response&nbsp;=&nbsp;chain.handle(context,&nbsp;request).getOrThrowUninterruptibly();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InOrder&nbsp;inOrder&nbsp;=&nbsp;inOrder(filter1,&nbsp;filter2,&nbsp;target,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inOrder.verify(filter1).filter(same(context),&nbsp;same(request),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response).isEqualTo(RESPONSE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;verifyZeroInteractions(filter2,&nbsp;target);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Context&nbsp;context()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Session&nbsp;session&nbsp;=&nbsp;mock(Session.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;HttpContext(new&nbsp;RootContext(),&nbsp;session);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Filter&nbsp;filter()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filter&nbsp;filter&nbsp;=&nbsp;mock(Filter.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(invoke()).when(filter).filter(any(Context.class),&nbsp;any(Request.class),&nbsp;any(Handler.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;filter;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Answer&amp;lt;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&amp;gt;&nbsp;invoke()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;invoke(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Answer&amp;lt;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&amp;gt;&nbsp;invoke(final&nbsp;int&nbsp;count)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Answer&amp;lt;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;answer(final&nbsp;InvocationOnMock&nbsp;invocation)&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object[]&nbsp;args&nbsp;=&nbsp;invocation.getArguments();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Context&nbsp;context&nbsp;=&nbsp;(Context)&nbsp;args[0];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;(Request)&nbsp;args[1];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Handler&nbsp;next&nbsp;=&nbsp;(Handler)&nbsp;args[2];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;promise&nbsp;=&nbsp;Promises.newSuccessfulPromise(new&nbsp;Response());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;count;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;promise.thenAsync(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;AsyncFunction&amp;lt;Response,&nbsp;Response,&nbsp;ResponseException&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;apply(Response&nbsp;o)&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;next.handle(context,&nbsp;request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;promise;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Answer&amp;lt;Response&amp;gt;&nbsp;result()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Answer&amp;lt;Response&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Response&nbsp;answer(final&nbsp;InvocationOnMock&nbsp;invocation)&nbsp;throws&nbsp;Throwable&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RESPONSE;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Handler&nbsp;target()&nbsp;throws&nbsp;ResponseException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;target&nbsp;=&nbsp;mock(Handler.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doAnswer(result()).when(target).handle(any(Context.class),&nbsp;any(Request.class));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;target;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/HandlersTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpRequestTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/RequestTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/RequestTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/RequestTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,31&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;RequestTest&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testMethodChaining()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request().setVersion(&amp;quot;123&amp;quot;).setMethod(&amp;quot;GET&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getVersion()).isEqualTo(&amp;quot;123&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getMethod()).isEqualTo(&amp;quot;GET&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/RequestTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpResponseTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/ResponseTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/ResponseTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/ResponseTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,31&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;ResponseTest&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testMethodChaining()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response().setVersion(&amp;quot;123&amp;quot;).setStatus(200);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getVersion()).isEqualTo(&amp;quot;123&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getStatus()).isEqualTo(200);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/ResponseTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderConnectionHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ConnectionHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ConnectionHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ConnectionHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,140&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.ConnectionHeader.NAME;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertEquals;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNotNull;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNull;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Unit&nbsp;tests&nbsp;for&nbsp;the&nbsp;connection&nbsp;header&nbsp;class.<br>
+&nbsp;*&nbsp;Header&nbsp;field&nbsp;example&nbsp;:&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;Connection:&nbsp;close<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;ConnectionHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;ESCAPED_KEEP_ALIVE_VALUE&nbsp;=&nbsp;&amp;quot;\\\&amp;quot;Keep-Alive\\\&amp;quot;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;QUOTED_KEEP_ALIVE_VALUE&nbsp;=&nbsp;&amp;quot;'Keep-Alive'&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;connectionHeaders()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;Keep-Alive&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;close&amp;quot;&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderAllowsNullOrEmptyString(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;connectionHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromMessageResponse(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(response.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.getName()).isEqualTo(NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().get(0),&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;connectionHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromMessageRequest(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(request.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().get(0),&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromEmptyMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;connectionHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromString(final&nbsp;String&nbsp;connectionHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().get(0),&nbsp;connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromEscapedString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(ESCAPED_KEEP_ALIVE_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().get(0),&nbsp;ESCAPED_KEEP_ALIVE_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderFromQuotedString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(QUOTED_KEEP_ALIVE_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getTokens().get(0),&nbsp;QUOTED_KEEP_ALIVE_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;connectionHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderToMessageRequest(final&nbsp;String&nbsp;connectionHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(ch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(request.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(request.getHeaders().getFirst(NAME),&nbsp;connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderToMessageNullOrEmptyDoesNothing(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(ch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;connectionHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testConnectionHeaderToMessageResponse(final&nbsp;String&nbsp;connectionHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ConnectionHeader&nbsp;ch&nbsp;=&nbsp;ConnectionHeader.valueOf(connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(ch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(response.getHeaders().getFirst(NAME),&nbsp;connectionHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ConnectionHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentEncodingHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentEncodingHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentEncodingHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentEncodingHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,176&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.*;<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.ContentEncodingHeader.*;<br>
+import&nbsp;static&nbsp;org.forgerock.util.Utils.*;<br>
+<br>
+import&nbsp;java.io.BufferedReader;<br>
+import&nbsp;java.io.ByteArrayInputStream;<br>
+import&nbsp;java.io.ByteArrayOutputStream;<br>
+import&nbsp;java.io.InputStream;<br>
+import&nbsp;java.io.InputStreamReader;<br>
+import&nbsp;java.io.OutputStream;<br>
+import&nbsp;java.io.UnsupportedEncodingException;<br>
+import&nbsp;java.util.zip.GZIPOutputStream;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;This&nbsp;class&nbsp;is&nbsp;unit&nbsp;testing&nbsp;the&nbsp;content&nbsp;encoding&nbsp;class.<br>
+&nbsp;*&nbsp;See&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;<br>
+&nbsp;*&nbsp;§14.11<br>
+&nbsp;*&nbsp;Header&nbsp;field&nbsp;example&nbsp;:<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;Content-Encoding:&nbsp;gzip<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;ContentEncodingHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;STRING_TO_DECODE&nbsp;=&nbsp;&amp;quot;People&nbsp;have&nbsp;forgotten&nbsp;this&nbsp;truth,&nbsp;the&nbsp;fox&nbsp;said.&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;&nbsp;But&nbsp;you&nbsp;mustn't&nbsp;forget&nbsp;it.&nbsp;You&nbsp;become&nbsp;responsible&nbsp;forever&nbsp;for&nbsp;what&nbsp;you've&nbsp;tamed.&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;See&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://en.wikipedia.org/wiki/HTTP_compression&amp;quot;&amp;gt;List&nbsp;of&nbsp;content&nbsp;encoding&amp;lt;/a&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;contentEncodingHeaders()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;gzip&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;deflate&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;identity&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;pack200-gzip&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;compress&amp;quot;&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderAllowsNullOrEmptyString(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentEncodingHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderFromMessageResponse(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.getName()).isEqualTo(NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.getCodings().size()).isEqualTo(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.getCodings().get(0)).isEqualTo(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentEncodingHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderFromMessageRequest(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.getCodings().size()).isEqualTo(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ceh.getCodings().get(0)).isEqualTo(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderFromEmptyMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ch&nbsp;=&nbsp;ContentEncodingHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.getCodings()).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.getCodings().size()).isEqualTo(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentEncodingHeaders&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderToMessageRequest(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(ceh);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isEqualTo(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentEncodingHeaderToMessageNullOrEmptyDoesNothing(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(ceh);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testDecodeWithNullOrEmptyDecoderHasNoEffectOnInputStream(final&nbsp;String&nbsp;cheader)&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;in&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;out&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;=&nbsp;new&nbsp;ByteArrayInputStream(getStringToDecodeToCompressedBytes());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;=&nbsp;ceh.decode(in);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;decode&nbsp;has&nbsp;no&nbsp;effects.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(in).isEqualTo(out);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(in,&nbsp;out);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testDecodeSucceedEncodingGzipHeader()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader&nbsp;br&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[]&nbsp;compressedBytes&nbsp;=&nbsp;getStringToDecodeToCompressedBytes();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentEncodingHeader&nbsp;ceh&nbsp;=&nbsp;ContentEncodingHeader.valueOf(&amp;quot;gzip&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;br&nbsp;=&nbsp;new&nbsp;BufferedReader(new&nbsp;InputStreamReader(ceh.decode(new&nbsp;ByteArrayInputStream(compressedBytes))));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;line;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;((line&nbsp;=&nbsp;br.readLine())&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(line).isEqualTo(STRING_TO_DECODE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(br);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;byte[]&nbsp;getStringToDecodeToCompressedBytes()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ByteArrayOutputStream&nbsp;baostream&nbsp;=&nbsp;new&nbsp;ByteArrayOutputStream();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;OutputStream&nbsp;outStream&nbsp;=&nbsp;new&nbsp;GZIPOutputStream(baostream);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outStream.write(STRING_TO_DECODE.getBytes(&amp;quot;UTF-8&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outStream.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;baostream.toByteArray();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(baostream,&nbsp;outStream);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;UnsupportedEncodingException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testDecodeDoesNotSupportCompressContentEncoding()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;toDecode&nbsp;=&nbsp;&amp;quot;The&nbsp;'compress'&nbsp;content&nbsp;encoding&nbsp;header&nbsp;is&nbsp;not&nbsp;supported.&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;InputStream&nbsp;is&nbsp;=&nbsp;new&nbsp;ByteArrayInputStream(toDecode.getBytes());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentEncodingHeader.valueOf(&amp;quot;compress&amp;quot;).decode(is);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentEncodingHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentLengthHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentLengthHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentLengthHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentLengthHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,131&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.ContentLengthHeader.NAME;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;This&nbsp;class&nbsp;is&nbsp;unit&nbsp;testing&nbsp;the&nbsp;Content&nbsp;length&nbsp;header&nbsp;class.<br>
+&nbsp;*&nbsp;The&nbsp;Content&nbsp;length&nbsp;header&nbsp;represents&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;request&nbsp;body&nbsp;in&nbsp;octets&nbsp;(8-bit&nbsp;bytes).<br>
+&nbsp;*&nbsp;Header&nbsp;field&nbsp;example&nbsp;:&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;Content-Length:&nbsp;348<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;ContentLengthHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;int&nbsp;LENGTH_DEFAULT_VALUE&nbsp;=&nbsp;1024;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;validDataProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;10&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;10&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;LENGTH_DEFAULT_VALUE&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;invalidDataProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;-1&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;-99&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;invalid_length_header&amp;quot;&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderAllowsNullOrEmptyString(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderSucceedParsingStringValue()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(&amp;quot;1024&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(1024);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getName()).isEqualTo(NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderFailsParsingStringValue()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(&amp;quot;invalidContentLengthHeader&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderFromMessageResponse()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;String.valueOf(LENGTH_DEFAULT_VALUE));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getName()).isEqualTo(NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(LENGTH_DEFAULT_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderFromMessageResponseFails()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;&amp;quot;invalid&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getName()).isEqualTo(NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderToMessageRequest()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentLengthHeader.valueOf(String.valueOf(LENGTH_DEFAULT_VALUE));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Inserts&nbsp;the&nbsp;content&nbsp;length&nbsp;header&nbsp;to&nbsp;the&nbsp;request&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(clh);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isEqualTo(String.valueOf(LENGTH_DEFAULT_VALUE));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderToMessageRequestFails()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(&amp;quot;invalid_value&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Inserts&nbsp;the&nbsp;content&nbsp;length&nbsp;header&nbsp;to&nbsp;the&nbsp;request&nbsp;header.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(clh);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isNullOrEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;validDataProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderToStringSucceed(final&nbsp;Object&nbsp;cth)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(String.valueOf(cth));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.toString()).isEqualTo(String.valueOf(cth));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(&nbsp;dataProvider&nbsp;=&nbsp;&amp;quot;invalidDataProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentLengthHeaderToStringIsNullWithInvalidValues(final&nbsp;Object&nbsp;cth)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentLengthHeader&nbsp;clh&nbsp;=&nbsp;ContentLengthHeader.valueOf(String.valueOf(cth));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.getLength()).isEqualTo(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(clh.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentLengthHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderContentTypeHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentTypeHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentTypeHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentTypeHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,131&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.ContentTypeHeader.NAME;<br>
+<br>
+import&nbsp;java.nio.charset.Charset;<br>
+<br>
+import&nbsp;org.forgerock.http.Message;<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;This&nbsp;class&nbsp;tests&nbsp;the&nbsp;content&nbsp;type&nbsp;header.&nbsp;see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://www.ietf.org/rfc/rfc2616.txt&amp;quot;&amp;gt;RFC&nbsp;2616&amp;lt;/a&amp;gt;&nbsp;§14.17.<br>
+&nbsp;*&nbsp;boundary&nbsp;see&nbsp;http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2&nbsp;.<br>
+&nbsp;*&nbsp;Header&nbsp;field&nbsp;example&nbsp;:<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;Content-Type:&nbsp;text/html;&nbsp;charset=utf-8<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;ContentTypeHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;An&nbsp;invalid&nbsp;content&nbsp;type&nbsp;header&nbsp;-&nbsp;The&nbsp;separator&nbsp;is&nbsp;not&nbsp;correct.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;INVALID_CT_HEADER&nbsp;=&nbsp;&amp;quot;text/html#&nbsp;charset=ISO-8859-4&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;contentTypeHeaderProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;content-type&nbsp;|&nbsp;type&nbsp;|&nbsp;charset&nbsp;|&nbsp;boundary<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;image/gif&amp;quot;,&nbsp;&amp;quot;image/gif&amp;quot;,&nbsp;null,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;text/html;&nbsp;charset=ISO-8859-4&amp;quot;,&nbsp;&amp;quot;text/html&amp;quot;,&nbsp;&amp;quot;ISO-8859-4&amp;quot;,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;multipart/mixed;&nbsp;boundary=gc0p4Jq0M2Yt08jU534c0p&amp;quot;,&nbsp;&amp;quot;multipart/mixed&amp;quot;,&nbsp;null,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;gc0p4Jq0M2Yt08jU534c0p&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;text/html;&nbsp;charset=utf-8&amp;quot;,&nbsp;&amp;quot;text/html&amp;quot;,&nbsp;&amp;quot;UTF-8&amp;quot;,&nbsp;null&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderAllowsNullOrEmptyString(final&nbsp;String&nbsp;cheader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderFromNullMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf((Message)&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.toString()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentTypeHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderFromString(final&nbsp;String&nbsp;cheader,&nbsp;final&nbsp;String&nbsp;type,&nbsp;final&nbsp;String&nbsp;charset,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;boundary)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isEqualTo(type);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isEqualTo(charset&nbsp;!=&nbsp;null&nbsp;?&nbsp;Charset.forName(charset)&nbsp;:&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isEqualTo(boundary);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentTypeHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderToMessageRequest(final&nbsp;String&nbsp;cheader,&nbsp;final&nbsp;String&nbsp;type,&nbsp;final&nbsp;String&nbsp;charset,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;boundary)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(cth);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().get(NAME)).isNotEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().getFirst(NAME)).isEqualTo(cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderFromInvalidString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(INVALID_CT_HEADER);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isEqualTo(INVALID_CT_HEADER);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isEqualTo(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isEqualTo(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentTypeHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderFromMessageResponse(final&nbsp;String&nbsp;cheader,&nbsp;final&nbsp;String&nbsp;type,&nbsp;final&nbsp;String&nbsp;charset,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;boundary)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Creates&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(response.getHeaders().get(NAME)).isNotNull();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Creates&nbsp;content-type&nbsp;header&nbsp;from&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isEqualTo(type);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isEqualTo(charset&nbsp;!=&nbsp;null&nbsp;?&nbsp;Charset.forName(charset)&nbsp;:&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isEqualTo(boundary);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;contentTypeHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContentTypeHeaderFromMessageRequest(final&nbsp;String&nbsp;cheader,&nbsp;final&nbsp;String&nbsp;type,&nbsp;final&nbsp;String&nbsp;charset,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;boundary)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Creates&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().get(NAME)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(NAME,&nbsp;cheader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(request.getHeaders().get(NAME)).isNotNull();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Creates&nbsp;content-type&nbsp;header&nbsp;from&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ContentTypeHeader&nbsp;cth&nbsp;=&nbsp;ContentTypeHeader.valueOf(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getType()).isEqualTo(type);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getCharset()).isEqualTo(charset&nbsp;!=&nbsp;null&nbsp;?&nbsp;Charset.forName(charset)&nbsp;:&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(cth.getBoundary()).isEqualTo(boundary);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/ContentTypeHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderCookieHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/CookieHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/CookieHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/CookieHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,168&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.CookieHeader.NAME;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertEquals;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNotNull;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNull;<br>
+<br>
+import&nbsp;org.forgerock.http.Cookie;<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Unit&nbsp;tests&nbsp;for&nbsp;the&nbsp;cookie&nbsp;header&nbsp;class.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;See&nbsp;&amp;lt;link&amp;gt;http://www.ietf.org/rfc/rfc2109.txt&amp;lt;/link&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;/p&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;CookieHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;CHEADER_1&nbsp;=&nbsp;&amp;quot;$Version=1;&nbsp;Customer=\&amp;quot;BAB_JENSEN\&amp;quot;;&nbsp;$Path=\&amp;quot;/example\&amp;quot;;&nbsp;$Port=\&amp;quot;42,13\&amp;quot;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;CHEADER_2&nbsp;=&nbsp;&amp;quot;$Version=2;&nbsp;Customer=\&amp;quot;SAM_CARTER\&amp;quot;;&nbsp;$Path=\&amp;quot;/example\&amp;quot;;&nbsp;&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;$Domain=\&amp;quot;example.com\&amp;quot;&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;ch.getCookies().get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getVersion().intValue(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getValue(),&nbsp;&amp;quot;BAB_JENSEN&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPath(),&nbsp;&amp;quot;/example&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPort().size(),&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPort().get(0).intValue(),&nbsp;42);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPort().get(1).intValue(),&nbsp;13);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromString2()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(CHEADER_2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;ch.getCookies().get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getVersion().intValue(),&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getValue(),&nbsp;&amp;quot;SAM_CARTER&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPath(),&nbsp;&amp;quot;/example&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPort().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getDomain(),&nbsp;&amp;quot;example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromStringAllowsNullVersion()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(&amp;quot;Customer=\&amp;quot;BAB_JENSEN\&amp;quot;;&nbsp;$Path=\&amp;quot;/example\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;ch.getCookies().get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(cookie.getVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getValue(),&nbsp;&amp;quot;BAB_JENSEN&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromStringAllowsInvalidVersion()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CookieHeader<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.valueOf(&amp;quot;$Version=invalid;&nbsp;Customer=\&amp;quot;BAB_JENSEN\&amp;quot;;&nbsp;$Path=\&amp;quot;/example\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;ch.getCookies().get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(cookie.getVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getValue(),&nbsp;&amp;quot;BAB_JENSEN&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromStringAllowsNullString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf((String)&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderFromStringAllowsNullMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf((Response)&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderToString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(CookieHeader.valueOf(CHEADER_1).toString(),&nbsp;CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderToStringInsertVersionWhenPathOrDomainArePresent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(&amp;quot;Customer=\&amp;quot;SAM_CARTER\&amp;quot;;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(ch.getCookies().get(0).getVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.toString()).doesNotContain(&amp;quot;$Version=1;&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(&amp;quot;Customer=\&amp;quot;SAM_CARTER\&amp;quot;;&nbsp;$Path=\&amp;quot;/example\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(ch.getCookies().get(0).getVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.toString()).contains(&amp;quot;$Version=1;&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(&amp;quot;Customer=\&amp;quot;SAM_CARTER\&amp;quot;;&nbsp;$Domain=\&amp;quot;example.com\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(ch.getCookies().get(0).getVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.toString()).contains(&amp;quot;$Version=1;&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(&amp;quot;Customer=\&amp;quot;SAM_CARTER\&amp;quot;;&nbsp;$Domain=\&amp;quot;example.com\&amp;quot;;&nbsp;$Version=2&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().get(0).getVersion().intValue(),&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(ch.toString()).doesNotContain(&amp;quot;$Version=1;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderToResponseMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(&amp;quot;cookie&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(&amp;quot;Customer&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(ch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(response.getHeaders().get(&amp;quot;cookie&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(&amp;quot;Customer&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(response.getHeaders().get(&amp;quot;cookie&amp;quot;).get(0),&nbsp;CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderToRequestMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getCookies().get(&amp;quot;cookie&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getCookies().get(&amp;quot;Customer&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(ch);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(request.getCookies());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getCookies().get(&amp;quot;cookie&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(request.getCookies().get(&amp;quot;Customer&amp;quot;));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Cookie&nbsp;cookie&nbsp;=&nbsp;request.getCookies().get(&amp;quot;Customer&amp;quot;).get(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getName(),&nbsp;&amp;quot;Customer&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getVersion().intValue(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getPort().size(),&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(cookie.getValue(),&nbsp;&amp;quot;BAB_JENSEN&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testCookieHeaderClearCookies()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;CookieHeader&nbsp;ch&nbsp;=&nbsp;CookieHeader.valueOf(CHEADER_1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch.getCookies().clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(ch.getCookies().size(),&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
+<br>
+<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/CookieHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderHeaderUtilTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/HeaderUtilTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/HeaderUtilTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/HeaderUtilTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,108&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.List;<br>
+<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;This&nbsp;class&nbsp;contains&nbsp;some&nbsp;unit&nbsp;tests&nbsp;for&nbsp;the&nbsp;header&nbsp;utility&nbsp;class.<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;HeaderUtilTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;ACCEPT_CHARSET_SAMPLE&nbsp;=&nbsp;&amp;quot;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;ESCAPING_TYPE_SAMPLE&nbsp;=&nbsp;&amp;quot;Etag:&nbsp;\&amp;quot;\\pub1259380237;gz\\\&amp;quot;&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;invalidSeparatorProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;'&amp;quot;'&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;'\\'&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;validSeparatorProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;','&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;';'&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;invalidSeparatorProvider&amp;quot;,&nbsp;expectedExceptions&nbsp;=&nbsp;IllegalArgumentException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testSplitDoesntAllowSpecificSeparators(final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HeaderUtil.split(&amp;quot;Invalid&nbsp;separators&nbsp;throw&nbsp;an&nbsp;exception&amp;quot;,&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;validSeparatorProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testSplitSucceed(final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;result&nbsp;=&nbsp;HeaderUtil.split(ACCEPT_CHARSET_SAMPLE,&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).hasSize(ACCEPT_CHARSET_SAMPLE.split(String.valueOf(separator)).length);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;validSeparatorProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testSplitSucceedEscaping(final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;result&nbsp;=&nbsp;HeaderUtil.split(ESCAPING_TYPE_SAMPLE,&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJoinOnNullChainReturnsNull()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;result&nbsp;=&nbsp;HeaderUtil.join(null,&nbsp;';');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;invalidSeparatorProvider&amp;quot;,&nbsp;expectedExceptions&nbsp;=&nbsp;IllegalArgumentException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJoinDoesntAllowSpecificSeparators(final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ArrayList&amp;lt;String&amp;gt;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(ACCEPT_CHARSET_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(ESCAPING_TYPE_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HeaderUtil.join(list,&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;validSeparatorProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJoinSucceed(final&nbsp;char&nbsp;separator)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ArrayList&amp;lt;String&amp;gt;&nbsp;list&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(ACCEPT_CHARSET_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(ESCAPING_TYPE_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;result&nbsp;=&nbsp;HeaderUtil.join(list,&nbsp;separator);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;2&nbsp;=&amp;gt;&nbsp;separator&nbsp;char&nbsp;+&nbsp;space<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).contains(ACCEPT_CHARSET_SAMPLE).contains(ESCAPING_TYPE_SAMPLE)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.hasSize(ACCEPT_CHARSET_SAMPLE.length()&nbsp;+&nbsp;ESCAPING_TYPE_SAMPLE.length()&nbsp;+&nbsp;2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testQuoteOnNullChainReturnsNull()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;result&nbsp;=&nbsp;HeaderUtil.quote(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testQuoteString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;result&nbsp;=&nbsp;HeaderUtil.quote(ACCEPT_CHARSET_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).isEqualTo(&amp;quot;\&amp;quot;&amp;quot;&nbsp;+&nbsp;ACCEPT_CHARSET_SAMPLE&nbsp;+&nbsp;&amp;quot;\&amp;quot;&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testQuoteAlreadyQuotedChainSucceed()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;result&nbsp;=&nbsp;HeaderUtil.quote(ESCAPING_TYPE_SAMPLE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(result).contains(&amp;quot;\\\\&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/HeaderUtilTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderLocationHeaderTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/LocationHeaderTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/LocationHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/LocationHeaderTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,117&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.header.LocationHeader.NAME;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertEquals;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNotNull;<br>
+import&nbsp;static&nbsp;org.testng.Assert.assertNull;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Unit&nbsp;tests&nbsp;for&nbsp;the&nbsp;location&nbsp;header&nbsp;class.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;See&nbsp;&amp;lt;link&amp;gt;http://www.ietf.org/rfc/rfc2616.txt&amp;lt;/link&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;/p&amp;gt;.&nbsp;Header&nbsp;field&nbsp;example&nbsp;:<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;Location:&nbsp;http://www.example.org/index.php<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;LocationHeaderTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;locationHeaderProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;http://www.example.org/index.php&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;This&nbsp;example,&nbsp;is&nbsp;incorrect&nbsp;according&nbsp;to&nbsp;the&nbsp;RFC,&nbsp;however,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;all&nbsp;popular&nbsp;browsers&nbsp;will&nbsp;accept&nbsp;a&nbsp;relative&nbsp;URL,&nbsp;and&nbsp;it&nbsp;is&nbsp;correct<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;according&nbsp;to&nbsp;the&nbsp;current&nbsp;revision&nbsp;of&nbsp;HTTP/1.1*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;/blog/&amp;quot;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderAllowsEmptyOrNullString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf((String)&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(lh.getLocationUri());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;nullOrEmptyDataProvider&amp;quot;,&nbsp;dataProviderClass&nbsp;=&nbsp;StaticProvider.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderAllowsNullOrEmptyString(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(lh.getLocationUri());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;locationHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderFromMessage(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(NAME,&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(response.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(lh.getLocationUri(),&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderFromEmptyMessage()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(lh.getLocationUri());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;locationHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderFromString(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(lh.getLocationUri(),&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(lh.getName(),&nbsp;NAME);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;locationHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderToMessageRequest(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(request.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().putSingle(lh);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(request.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(request.getHeaders().getFirst(NAME),&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;locationHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderToMessageResponse(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Response&nbsp;response&nbsp;=&nbsp;new&nbsp;Response();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNull(response.getHeaders().get(NAME));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getHeaders().putSingle(lh);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertNotNull(response.getHeaders().get(NAME));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(response.getHeaders().get(NAME).get(0),&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;locationHeaderProvider&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testLocationHeaderToString(final&nbsp;String&nbsp;lHeader)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LocationHeader&nbsp;lh&nbsp;=&nbsp;LocationHeader.valueOf(lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals(lh.toString(),&nbsp;lHeader);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/LocationHeaderTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpheaderStaticProviderjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/StaticProvider.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/StaticProvider.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/StaticProvider.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,31&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.header;<br>
+<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;This&nbsp;class&nbsp;contains&nbsp;static&nbsp;provider(s)&nbsp;used&nbsp;in&nbsp;this&nbsp;package.<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;StaticProvider&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Object[][]&nbsp;nullOrEmptyDataProvider()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;null&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/header/StaticProvider.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttpioBranchingStreamWrapperTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/BranchingStreamWrapperTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/BranchingStreamWrapperTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/BranchingStreamWrapperTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,309&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.io;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;java.io.ByteArrayInputStream;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.Random;<br>
+<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+import&nbsp;org.testng.annotations.AfterMethod;<br>
+import&nbsp;org.testng.annotations.BeforeClass;<br>
+import&nbsp;org.testng.annotations.BeforeMethod;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;BranchingStreamWrapperTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;read&nbsp;buffer.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;int&nbsp;BUFSIZE&nbsp;=&nbsp;8192;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Number&nbsp;of&nbsp;concurrent&nbsp;branches&nbsp;to&nbsp;test&nbsp;against.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;int&nbsp;BRANCHES&nbsp;=&nbsp;17;&nbsp;//&nbsp;prime&nbsp;number&nbsp;of&nbsp;branches<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Read&nbsp;lengths,&nbsp;randomly&nbsp;generated&nbsp;and&nbsp;hard-coded&nbsp;here&nbsp;for&nbsp;deterministic&nbsp;results.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;int[]&nbsp;LENGTHS&nbsp;=&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;@Checkstyle:ignoreFor&nbsp;3<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;125,&nbsp;42,&nbsp;185,&nbsp;249,&nbsp;177,&nbsp;74,&nbsp;98,&nbsp;124,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;42,&nbsp;160,&nbsp;73,&nbsp;176,&nbsp;41,&nbsp;110,&nbsp;43,&nbsp;2,&nbsp;179,&nbsp;151,&nbsp;115,&nbsp;117,&nbsp;235,&nbsp;15,&nbsp;80,&nbsp;219,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;91,&nbsp;38,&nbsp;191,&nbsp;154,&nbsp;78,&nbsp;146,&nbsp;194<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;//&nbsp;prime&nbsp;number&nbsp;of&nbsp;lengths<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Original&nbsp;bytes&nbsp;to&nbsp;use&nbsp;to&nbsp;read&nbsp;from&nbsp;branches.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;byte[]&nbsp;BYTES&nbsp;=&nbsp;new&nbsp;byte[BUFSIZE];<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Buffer&nbsp;factory,&nbsp;which&nbsp;will&nbsp;switch&nbsp;from&nbsp;memory&nbsp;to&nbsp;file&nbsp;storage&nbsp;in&nbsp;each&nbsp;test.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;STORAGE&nbsp;=&nbsp;IO.newTemporaryStorage();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Stores&nbsp;content&nbsp;read&nbsp;in&nbsp;concurrent&nbsp;branches&nbsp;for&nbsp;comparison.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;byte[][]&nbsp;BUFFERS&nbsp;=&nbsp;new&nbsp;byte[BRANCHES][BUFSIZE];<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Current&nbsp;read&nbsp;length&nbsp;offset.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;int&nbsp;currentLengthCounter&nbsp;=&nbsp;0;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;BranchingStreamWrapper&nbsp;trunk;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;nextReadLength()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;LENGTHS[(currentLengthCounter++)&nbsp;%&nbsp;LENGTHS.length];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;context&nbsp;-----------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@BeforeClass<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;beforeClass()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;Random().nextBytes(BYTES);&nbsp;//&nbsp;fill&nbsp;bytes&nbsp;with&nbsp;random&nbsp;data<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@BeforeMethod<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;beforeMethod()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream&nbsp;in&nbsp;=&nbsp;new&nbsp;ByteArrayInputStream(BYTES);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk&nbsp;=&nbsp;new&nbsp;BranchingStreamWrapper(in,&nbsp;STORAGE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;n++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays.fill(BUFFERS[n],&nbsp;(byte)&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@AfterMethod<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;afterMethod()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trunk.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;no&nbsp;branch&nbsp;---------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;noBranchByteAtATime()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&amp;lt;&nbsp;BUFSIZE;&nbsp;n++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(BYTES[n]&nbsp;&amp;amp;&nbsp;0xff);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;noBranchAllBytes()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;noBranchBytesLength()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;noBranchTwoReads()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length1&nbsp;=&nbsp;BUFSIZE&nbsp;/&nbsp;2;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length2&nbsp;=&nbsp;BUFSIZE&nbsp;-&nbsp;length1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;length1)).isEqualTo(length1);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;length1,&nbsp;length2)).isEqualTo(length2);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;one&nbsp;branch,&nbsp;sequential&nbsp;reads&nbsp;--------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchSequentialByteAtATime()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&amp;lt;&nbsp;BUFSIZE;&nbsp;n++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(BYTES[n]&nbsp;&amp;amp;&nbsp;0xff);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&amp;lt;&nbsp;BUFSIZE;&nbsp;n++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(BYTES[n]&nbsp;&amp;amp;&nbsp;0xff);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchSequentialAllBytes()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1])).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[1]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1])).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchSequentialBytesLength()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchSequentialTwoReads()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length1&nbsp;=&nbsp;BUFSIZE&nbsp;/&nbsp;2;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length2&nbsp;=&nbsp;BUFSIZE&nbsp;-&nbsp;length1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;length1)).isEqualTo(length1);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;length1,&nbsp;length2)).isEqualTo(length2);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1],&nbsp;0,&nbsp;length1)).isEqualTo(length1);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1],&nbsp;length1,&nbsp;length2)).isEqualTo(length2);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[1]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;one&nbsp;branch,&nbsp;interleaved&nbsp;reads&nbsp;-------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchInterleavedByteAtATime()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&amp;lt;&nbsp;BUFSIZE;&nbsp;n++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(BYTES[n]&nbsp;&amp;amp;&nbsp;0xff);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(BYTES[n]&nbsp;&amp;amp;&nbsp;0xff);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchInterleavedAllBytes()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1])).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[1]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0])).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1])).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchInterleavedBytesLength()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(BUFSIZE);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[0],&nbsp;0,&nbsp;BUFSIZE)).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;oneBranchInterleavedTwoReads()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length1&nbsp;=&nbsp;BUFSIZE&nbsp;/&nbsp;2;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length2&nbsp;=&nbsp;BUFSIZE&nbsp;-&nbsp;length1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper&nbsp;branch&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;0,&nbsp;length1)).isEqualTo(length1);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1],&nbsp;0,&nbsp;length1)).isEqualTo(length1);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read(BUFFERS[0],&nbsp;length1,&nbsp;length2)).isEqualTo(length2);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read(BUFFERS[1],&nbsp;length1,&nbsp;length2)).isEqualTo(length2);&nbsp;//&nbsp;correct&nbsp;read&nbsp;length<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[0]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(BUFFERS[1]).isEqualTo(BYTES);&nbsp;//&nbsp;identical&nbsp;content<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(trunk.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branch.read()).isEqualTo(-1);&nbsp;//&nbsp;end&nbsp;of&nbsp;stream<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branch.close();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;n&nbsp;branches,&nbsp;interleaved&nbsp;reads&nbsp;-------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;nBranchesReadInterleavedAllFromTrunk()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int[]&nbsp;offsets&nbsp;=&nbsp;new&nbsp;int[BRANCHES];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper[]&nbsp;branches&nbsp;=&nbsp;new&nbsp;BranchingStreamWrapper[BRANCHES];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;b++)&nbsp;{&nbsp;//&nbsp;all&nbsp;branch&nbsp;at&nbsp;the&nbsp;beginning<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches[b]&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;still&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(still)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;still&nbsp;=&nbsp;false;&nbsp;//&nbsp;start&nbsp;assuming&nbsp;there&nbsp;is&nbsp;no&nbsp;work&nbsp;done<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;b++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(offsets[b]&nbsp;&amp;lt;&nbsp;BUFSIZE)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;still&nbsp;=&nbsp;true;&nbsp;//&nbsp;there&nbsp;is&nbsp;work&nbsp;done,&nbsp;so&nbsp;loop&nbsp;again<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;branches[b].read(BUFFERS[b],&nbsp;0,&nbsp;nextReadLength());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(length).isPositive();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(Arrays.copyOfRange(BUFFERS[b],&nbsp;0,&nbsp;length))<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.isEqualTo(Arrays.copyOfRange(BYTES,&nbsp;offsets[b],&nbsp;offsets[b]&nbsp;+&nbsp;length));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets[b]&nbsp;+=&nbsp;length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branches[b].read()&nbsp;&amp;lt;&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;b++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branches[b].read()&nbsp;==&nbsp;-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;purposely&nbsp;leave&nbsp;branches&nbsp;open&nbsp;to&nbsp;let&nbsp;trunk&nbsp;close&nbsp;them&nbsp;recursively<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;nBranchesReadInterleavedBranchAndCloseMany()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int[]&nbsp;offsets&nbsp;=&nbsp;new&nbsp;int[BRANCHES];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BranchingStreamWrapper[]&nbsp;branches&nbsp;=&nbsp;new&nbsp;BranchingStreamWrapper[BRANCHES];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;still&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;counter&nbsp;=&nbsp;0;&nbsp;//&nbsp;counts&nbsp;number&nbsp;of&nbsp;reads<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(still)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;still&nbsp;=&nbsp;false;&nbsp;//&nbsp;start&nbsp;assuming&nbsp;there&nbsp;is&nbsp;no&nbsp;work&nbsp;done<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;b++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branches[b]&nbsp;==&nbsp;null&nbsp;||&nbsp;branches[b].isClosed())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches[b]&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;n&nbsp;=&nbsp;b&nbsp;-&nbsp;1;&nbsp;n&nbsp;&amp;gt;=&nbsp;0&nbsp;&amp;amp;&amp;amp;&nbsp;branches[b]&nbsp;==&nbsp;null;&nbsp;n--)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branches[n]&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;!branches[n].isClosed())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches[b]&nbsp;=&nbsp;branches[n].branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets[b]&nbsp;=&nbsp;offsets[n];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branches[b]&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches[b]&nbsp;=&nbsp;trunk.branch();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets[b]&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(offsets[b]&nbsp;&amp;lt;&nbsp;BUFSIZE)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;still&nbsp;=&nbsp;true;&nbsp;//&nbsp;there&nbsp;is&nbsp;work&nbsp;done,&nbsp;so&nbsp;loop&nbsp;again<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;branches[b].read(BUFFERS[b],&nbsp;0,&nbsp;nextReadLength());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(length).isPositive();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(Arrays.copyOfRange(BUFFERS[b],&nbsp;0,&nbsp;length))<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.isEqualTo(Arrays.copyOfRange(BYTES,&nbsp;offsets[b],&nbsp;offsets[b]&nbsp;+&nbsp;length));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offsets[b]&nbsp;+=&nbsp;length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(++counter&nbsp;&amp;gt;=&nbsp;51&nbsp;&amp;amp;&amp;amp;&nbsp;branches[b].parent()&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;branches[b].close();&nbsp;//&nbsp;every&nbsp;51st&nbsp;read&nbsp;closes&nbsp;stream&nbsp;and&nbsp;its&nbsp;children<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;counter&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branches[b].read()&nbsp;&amp;lt;&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&amp;lt;&nbsp;BRANCHES;&nbsp;b++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(branches[b]&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(branches[b].read()&nbsp;==&nbsp;-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;purposely&nbsp;leave&nbsp;branches&nbsp;open&nbsp;to&nbsp;let&nbsp;trunk&nbsp;close&nbsp;them&nbsp;recursively<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/io/BranchingStreamWrapperTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilCaseInsensitiveMapTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveMapTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveMapTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveMapTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,225&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.UUID;<br>
+<br>
+import&nbsp;org.testng.annotations.BeforeMethod;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;CaseInsensitiveMapTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;CaseInsensitiveMap&amp;lt;String&amp;gt;&nbsp;map;&nbsp;//&nbsp;map&nbsp;to&nbsp;perform&nbsp;tests&nbsp;on<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;upper;&nbsp;//&nbsp;key&nbsp;as&nbsp;an&nbsp;upper-case&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;lower;&nbsp;//&nbsp;key&nbsp;as&nbsp;a&nbsp;lower-case&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;value1;&nbsp;//&nbsp;value&nbsp;to&nbsp;store&nbsp;and&nbsp;check&nbsp;for&nbsp;in&nbsp;mapping<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;value2;&nbsp;//&nbsp;value&nbsp;to&nbsp;replace&nbsp;original&nbsp;with&nbsp;to&nbsp;see&nbsp;that&nbsp;replacement&nbsp;sticks<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;spurious;&nbsp;//&nbsp;key&nbsp;to&nbsp;use&nbsp;to&nbsp;test&nbsp;spurious&nbsp;lookup<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;context&nbsp;-----------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@BeforeMethod<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;before()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;=&nbsp;new&nbsp;CaseInsensitiveMap&amp;lt;String&amp;gt;(new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upper&nbsp;=&nbsp;&amp;quot;AAA-&amp;quot;&nbsp;+&nbsp;UUID.randomUUID().toString().toUpperCase()&nbsp;+&nbsp;&amp;quot;-BBB&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lower&nbsp;=&nbsp;upper.toLowerCase();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value1&nbsp;=&nbsp;UUID.randomUUID().toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value2&nbsp;=&nbsp;UUID.randomUUID().toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spurious&nbsp;=&nbsp;&amp;quot;aaa-&amp;quot;&nbsp;+&nbsp;UUID.randomUUID().toString()&nbsp;+&nbsp;&amp;quot;-BBB&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;upper&nbsp;case&nbsp;--------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutKeyRetainsCase()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.keySet().iterator().next()).isEqualTo(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isEqualTo(value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutUpperContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutSpuriousContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(spurious)).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutSpuriousGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(spurious)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutUpperRemoveUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;lower&nbsp;case&nbsp;--------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutKeyRetainsCase()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.keySet().iterator().next()).isEqualTo(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isEqualTo(value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutLowerContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutSpuriousContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(spurious)).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutSpuriousGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(spurious)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutLowerRemoveLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;upper&nbsp;then&nbsp;lower&nbsp;case&nbsp;---------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isEqualTo(value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutUpperRemoveLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerRemoveUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerRemoveLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerPutUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isEqualTo(value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;upperPutLowerPutLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isEqualTo(value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-----&nbsp;lower&nbsp;then&nbsp;upper&nbsp;case&nbsp;---------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isEqualTo(value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.containsKey(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutLowerRemoveUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperRemoveLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperRemoveUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.remove(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperPutLowerGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(lower)).isEqualTo(value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;lowerPutUpperPutUpperGet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(lower,&nbsp;value1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(upper,&nbsp;value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(map.get(upper)).isEqualTo(value2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveMapTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilCaseInsensitiveSetTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveSetTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveSetTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveSetTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,233&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.*;<br>
+<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.HashSet;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Set;<br>
+import&nbsp;java.util.UUID;<br>
+<br>
+import&nbsp;org.testng.annotations.BeforeMethod;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;CaseInsensitiveSetTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;CaseInsensitiveSet&nbsp;set;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;upper;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;lower;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@BeforeMethod<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;before()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upper&nbsp;=&nbsp;&amp;quot;AAA-&amp;quot;&nbsp;+&nbsp;UUID.randomUUID().toString().toUpperCase()&nbsp;+&nbsp;&amp;quot;-BBB&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lower&nbsp;=&nbsp;upper.toLowerCase();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperKey()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.iterator().next()).isEqualTo(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperContains()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).contains(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperTwice()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isAdded&nbsp;=&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isAdded).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isAdded&nbsp;=&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isAdded).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).containsOnly(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperRemove()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddLowerKey()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.iterator().next()).isEqualTo(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1).containsOnly(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddLowerRemove()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperLowerRemove()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isAdded&nbsp;=&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isAdded).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isAdded&nbsp;=&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isAdded).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddUpperLowerClear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO&nbsp;Stg&nbsp;wrong&nbsp;here&nbsp;:&nbsp;the&nbsp;set&nbsp;should&nbsp;contain&nbsp;only&nbsp;one&nbsp;entry&nbsp;as&nbsp;the&nbsp;addAll&nbsp;function&nbsp;did.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddFromListCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;listOfValues&nbsp;=&nbsp;createRegularListWithUpperAndLowerCasedKeys();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet(createRegularListWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(listOfValues.size());&nbsp;//&nbsp;2?<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).contains(upper,&nbsp;lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddFromListCollection2()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.addAll(createRegularListWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;FIXME&nbsp;Looks&nbsp;horrible&nbsp;but&nbsp;it&nbsp;seems&nbsp;assertj&nbsp;doesn't&nbsp;use&nbsp;the&nbsp;right&nbsp;contains&nbsp;method.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;assertThat(set).contains(upper).contains(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO&nbsp;Stg&nbsp;wrong&nbsp;here&nbsp;:&nbsp;the&nbsp;set&nbsp;should&nbsp;contain&nbsp;only&nbsp;one&nbsp;entry&nbsp;as&nbsp;the&nbsp;addAll&nbsp;function&nbsp;did.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddFromSetCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;listOfValues&nbsp;=&nbsp;createRegularSetWithUpperAndLowerCasedKeys();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet(listOfValues);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(listOfValues.size());&nbsp;//&nbsp;2?<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAddFromSetCollection2()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.addAll(createRegularSetWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.remove(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContainsAllFromSetCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;mySet&nbsp;=&nbsp;createRegularSetWithUpperAndLowerCasedKeys();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.addAll(mySet);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(upper)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.containsAll(mySet)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testContainsAllFromSetCollectionDoesNothing()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.addAll(createRegularSetWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(upper)).isTrue();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Set&amp;lt;String&amp;gt;&nbsp;another&nbsp;=&nbsp;new&nbsp;HashSet&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;another.add(&amp;quot;OpenIG&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.containsAll(another)).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;TODO&nbsp;This&nbsp;one&nbsp;throw&nbsp;a&nbsp;ConcurrentModificationException&nbsp;-&nbsp;The&nbsp;retain&nbsp;method&nbsp;needs&nbsp;to&nbsp;be&nbsp;rewrited&nbsp;with&nbsp;iterator.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testRetainAllFromSetCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Contained&nbsp;in&nbsp;getSet()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(&amp;quot;OpenIG&amp;quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Not&nbsp;contained&nbsp;in&nbsp;the&nbsp;getSet()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(&amp;quot;OpenIG2&amp;quot;);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Not&nbsp;contained&nbsp;in&nbsp;the&nbsp;getSet()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.retainAll(createRegularSetWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).contains(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).doesNotContain(&amp;quot;OpenIG&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testRetainAllFromSetCollectionDoesNothing()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Contained&nbsp;in&nbsp;getSet()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(&amp;quot;OpenIG&amp;quot;);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Not&nbsp;contained&nbsp;in&nbsp;the&nbsp;getSet()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.retainAll(createRegularSetWithUpperAndLowerCasedKeys());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).contains(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;TODO&nbsp;This&nbsp;one&nbsp;throw&nbsp;a&nbsp;ConcurrentModificationException&nbsp;-<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;removeAll&nbsp;method&nbsp;needs&nbsp;to&nbsp;be&nbsp;rewrited&nbsp;with&nbsp;iterator.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testRemoveAllFromSetCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;mySet&nbsp;=&nbsp;createRegularSetWithUpperAndLowerCasedKeys();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;boolean&nbsp;isChanged&nbsp;=&nbsp;set.removeAll(mySet);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(isChanged).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set).hasSize(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(lower)).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.contains(&amp;quot;OpenIG&amp;quot;)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(set.containsAll(mySet)).isFalse();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;createRegularListWithUpperAndLowerCasedKeys()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;sample&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sample;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Collection&amp;lt;String&amp;gt;&nbsp;createRegularSetWithUpperAndLowerCasedKeys()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Set&amp;lt;String&amp;gt;&nbsp;hashSet&nbsp;=&nbsp;new&nbsp;HashSet&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hashSet.add(upper);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hashSet.add(lower);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;hashSet;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/CaseInsensitiveSetTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilJsonTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/JsonTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/JsonTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/JsonTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,304&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;java.lang.Long.*;<br>
+import&nbsp;static&nbsp;java.util.Arrays.*;<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.util.Json.*;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.io.Reader;<br>
+import&nbsp;java.io.StringReader;<br>
+import&nbsp;java.util.HashMap;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;JsonTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;INVALID_JSON&nbsp;=&nbsp;&amp;quot;invalid&nbsp;json&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;JSON_CONTENT&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;emptyJson()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;\n&amp;quot;&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;newLine()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;\r\n&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;\n&amp;quot;&nbsp;}&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Object[][]&nbsp;invalidJson()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;{&nbsp;'name':'outputHandler',&nbsp;'type':&nbsp;'ClientHandler&nbsp;},&amp;quot;&nbsp;},&nbsp;//&nbsp;Missing&nbsp;quote&nbsp;within&nbsp;the&nbsp;sample.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;{&nbsp;'name':,&nbsp;'type':&nbsp;'ClientHandler'&nbsp;},&amp;quot;&nbsp;},&nbsp;//&nbsp;A&nbsp;comma&nbsp;too&nbsp;many.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;{&nbsp;'name':,&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&amp;quot;&nbsp;},&nbsp;//&nbsp;Missing&nbsp;attribute&nbsp;value.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&amp;quot;{&nbsp;:'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&amp;quot;&nbsp;}};&nbsp;//&nbsp;Missing&nbsp;attribute&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;emptyJson&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldReturnsNullWhenSerializingEmptyString(final&nbsp;String&nbsp;json)&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(readJson(from(json))).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldFailToReadInvalidJson()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJson(from(INVALID_JSON));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;invalidJson&amp;quot;,&nbsp;expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFailParsingInvalidJson(final&nbsp;String&nbsp;invalid)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJson(from(invalid));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParsingSucceedWhenCommentsEnabledBlockommentInsideBlock()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;/*&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&nbsp;*/&nbsp;}&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;json&nbsp;=&nbsp;readJsonLenient(from(sample));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;name&amp;quot;)).isEqualTo(&amp;quot;outputHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;type&amp;quot;)).isEqualTo(&amp;quot;ClientHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParsingSucceedWhenCommentsEnabledBlockCommentOutsideBlock()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&nbsp;/*&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&nbsp;*/&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;json&nbsp;=&nbsp;readJsonLenient(from(sample));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;name&amp;quot;)).isEqualTo(&amp;quot;outputHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;type&amp;quot;)).isEqualTo(&amp;quot;ClientHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParsingSucceedWhenCommentsEnabledLineCommentOutsideBlock()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&nbsp;//&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;json&nbsp;=&nbsp;readJsonLenient(from(sample));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;name&amp;quot;)).isEqualTo(&amp;quot;outputHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(json.get(&amp;quot;type&amp;quot;)).isEqualTo(&amp;quot;ClientHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParsingFailWhenCommentsEnabledLineCommentInsideBlock()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;//&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&nbsp;}&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJsonLenient(from(sample));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldParsingFailWhenCommentsDisabled()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;/*&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&nbsp;*/&nbsp;}&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJson(from(sample));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldCommentsIgnoredByParsing()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;/*&nbsp;This&nbsp;is&nbsp;a&nbsp;comment&nbsp;*/&nbsp;}&nbsp;&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample2&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;{&nbsp;'name':&nbsp;'outputHandler',&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&nbsp;&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(readJsonLenient(from(sample))).isEqualTo(readJson(from(sample2)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;newLine&amp;quot;,&nbsp;expectedExceptions&nbsp;=&nbsp;IOException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldThrowIoExceptionWhenContainingEol(final&nbsp;String&nbsp;newLine)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJson(singleQuotesToDouble(&amp;quot;{&nbsp;'comment':&nbsp;'Two&nbsp;lines&nbsp;&amp;quot;&nbsp;+&nbsp;newLine&nbsp;+&nbsp;&amp;quot;of&nbsp;comment'&nbsp;}&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;lenient&nbsp;parser&nbsp;should&nbsp;allow&nbsp;use&nbsp;of&nbsp;EOL&nbsp;(included&nbsp;in&nbsp;the&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;value).&nbsp;It&nbsp;also&nbsp;allows&nbsp;use&nbsp;of&nbsp;ASCII&nbsp;chars&nbsp;&amp;lt;&nbsp;32.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;e.g.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;quot;source&amp;quot;:&nbsp;&amp;quot;import&nbsp;org.forgerock.json.fluent.JsonValue;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logger.info(exchange.token.asJsonValue()&nbsp;as&nbsp;String);&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;newLine&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldSucceedWhenContainingEol(final&nbsp;String&nbsp;newLine)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readJsonLenient(from(&amp;quot;{&nbsp;'comment':&nbsp;'Two&nbsp;lines&nbsp;&amp;quot;&nbsp;+&nbsp;newLine&nbsp;+&nbsp;&amp;quot;of&nbsp;comment'&nbsp;}&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat((String)&nbsp;jackson.get(&amp;quot;comment&amp;quot;)).matches(&amp;quot;Two&nbsp;lines&nbsp;[\r\n]{1,2}of&nbsp;comment$&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testAllowsSimpleQuote()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;sample&nbsp;=&nbsp;&amp;quot;{&nbsp;'condition':&nbsp;true&nbsp;}&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=&nbsp;readJsonLenient(new&nbsp;StringReader(sample));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat((Boolean)&nbsp;jackson.get(&amp;quot;condition&amp;quot;)).isTrue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testFromString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=&nbsp;readJson(from(JSON_CONTENT));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;name&amp;quot;)).isEqualTo(&amp;quot;outputHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;type&amp;quot;)).isEqualTo(&amp;quot;ClientHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testStringAllowNullAttributeValue()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;rawJson&nbsp;=&nbsp;&amp;quot;{&nbsp;'name':&nbsp;null,&nbsp;'type':&nbsp;'ClientHandler'&nbsp;}&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=&nbsp;readJson(from(rawJson));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;name&amp;quot;)).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;type&amp;quot;)).isEqualTo(&amp;quot;ClientHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonValueNumber()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;rawJson&nbsp;=&nbsp;&amp;quot;{&nbsp;'number':&nbsp;23,&nbsp;'other':&nbsp;'27'&nbsp;}&nbsp;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=&nbsp;readJson(from(rawJson));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;number&amp;quot;)).isEqualTo(23);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jackson.get(&amp;quot;other&amp;quot;)).isEqualTo(&amp;quot;27&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonValueSupportsLong()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;rawJson&nbsp;=&nbsp;&amp;quot;{&nbsp;'long':&nbsp;'&amp;quot;&nbsp;+&nbsp;MAX_VALUE&nbsp;+&nbsp;&amp;quot;'}&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;jackson&nbsp;=&nbsp;readJson(from(rawJson));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(parseLong(jackson.get(&amp;quot;long&amp;quot;).toString())).isEqualTo(MAX_VALUE);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldSucceedToParseArray()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;rawJson&nbsp;=&nbsp;singleQuotesToDouble(&amp;quot;['The',&nbsp;100&nbsp;]&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Object&nbsp;jsonNode&nbsp;=&nbsp;readJson(rawJson);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonNode).isInstanceOf(List.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;?&amp;gt;&nbsp;values&nbsp;=&nbsp;(List&amp;lt;?&amp;gt;)&nbsp;jsonNode;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(values.get(0)).isEqualTo(&amp;quot;The&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(values.get(1)).isEqualTo(100);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldSucceedToParseArray2()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;rawJson&nbsp;=&nbsp;singleQuotesToDouble(&amp;quot;['The',&nbsp;{&nbsp;'data':'outputHandler'}&nbsp;]&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Object&nbsp;jsonNode&nbsp;=&nbsp;readJson(rawJson);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonNode).isInstanceOf(List.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;?&amp;gt;&nbsp;values&nbsp;=&nbsp;(List&amp;lt;?&amp;gt;)&nbsp;jsonNode;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(values.get(0)).isEqualTo(&amp;quot;The&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(values.get(1)).isInstanceOf(LinkedHashMap.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@SuppressWarnings(&amp;quot;unchecked&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;LinkedHashMap&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;val2&nbsp;=&nbsp;(LinkedHashMap&amp;lt;String,&nbsp;Object&amp;gt;)&nbsp;values.get(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(val2.get(&amp;quot;data&amp;quot;)).isEqualTo(&amp;quot;outputHandler&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testParsesBoolean()&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Object&nbsp;jsonNode&nbsp;=&nbsp;readJson(&amp;quot;true&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(jsonNode).isInstanceOf(Boolean.class).isEqualTo(true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;string&nbsp;reader&nbsp;from&nbsp;the&nbsp;rawJson&nbsp;attribute.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;rawJson<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Json&nbsp;string&nbsp;to&nbsp;read&nbsp;(can&nbsp;be&nbsp;single&nbsp;quoted).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;a&nbsp;string&nbsp;reader.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Reader&nbsp;from(final&nbsp;String&nbsp;rawJson)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;StringReader(singleQuotesToDouble(rawJson));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Remove&nbsp;single&nbsp;quotes&nbsp;from&nbsp;a&nbsp;given&nbsp;string.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;singleQuotesToDouble(final&nbsp;String&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value.replace('\'',&nbsp;'\&amp;quot;');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonCompatibilityBoxedPrimitiveType()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;boolean&amp;quot;,&nbsp;true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;integer&amp;quot;,&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;short&amp;quot;,&nbsp;(short)&nbsp;12);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;long&amp;quot;,&nbsp;-42L);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;float&amp;quot;,&nbsp;42.3F);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;double&amp;quot;,&nbsp;3.14159D);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;char&amp;quot;,&nbsp;'a');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;byte&amp;quot;,&nbsp;(byte)&nbsp;'c');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonCompatibilityWithCharSequences()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;string&amp;quot;,&nbsp;&amp;quot;a&nbsp;string&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;string-buffer&amp;quot;,&nbsp;new&nbsp;StringBuffer(&amp;quot;a&nbsp;string&nbsp;buffer&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;string-builder&amp;quot;,&nbsp;new&nbsp;StringBuilder(&amp;quot;a&nbsp;string&nbsp;builder&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonCompatibilityWithArrayOfString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;strings&nbsp;=&nbsp;{&amp;quot;one&amp;quot;,&nbsp;&amp;quot;two&amp;quot;,&nbsp;&amp;quot;three&amp;quot;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;array&amp;quot;,&nbsp;strings);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonCompatibilityWithListOfString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;strings&nbsp;=&nbsp;{&amp;quot;one&amp;quot;,&nbsp;&amp;quot;two&amp;quot;,&nbsp;&amp;quot;three&amp;quot;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;array&amp;quot;,&nbsp;asList(strings));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testJsonCompatibilityWithMapOfString()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;map&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(&amp;quot;one&amp;quot;,&nbsp;&amp;quot;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(&amp;quot;two&amp;quot;,&nbsp;&amp;quot;two&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(&amp;quot;three&amp;quot;,&nbsp;&amp;quot;three&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;map&amp;quot;,&nbsp;map);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IllegalArgumentException.class)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldNotAcceptUnsupportedTypes()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;object&amp;quot;,&nbsp;new&nbsp;Object());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IllegalArgumentException.class,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expectedExceptionsMessageRegExp&nbsp;=&nbsp;&amp;quot;.*'list\\[1\\]'.*&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldWriteErrorTrailForIncorrectList()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;list&amp;quot;,&nbsp;asList(&amp;quot;one&amp;quot;,&nbsp;new&nbsp;Object(),&nbsp;&amp;quot;three&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(expectedExceptions&nbsp;=&nbsp;IllegalArgumentException.class,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expectedExceptionsMessageRegExp&nbsp;=&nbsp;&amp;quot;.*'map/object'.*&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldWriteErrorTrailForIncorrectMap()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;map&nbsp;=&nbsp;new&nbsp;HashMap&amp;lt;String,&nbsp;Object&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(&amp;quot;one&amp;quot;,&nbsp;&amp;quot;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.put(&amp;quot;object&amp;quot;,&nbsp;new&nbsp;Object());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkJsonCompatibility(&amp;quot;map&amp;quot;,&nbsp;map);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/JsonTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilMultiValuedMapTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MultiValuedMapTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MultiValuedMapTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MultiValuedMapTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,144&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.*;<br>
+<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.LinkedList;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;MultiValuedMapTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAllowsNull()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.add(null,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;add()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).contains(&amp;quot;Half-and-half&amp;quot;,&nbsp;&amp;quot;Plus&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;coffee&amp;quot;)).contains(&amp;quot;Arabica&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.add(&amp;quot;syrup-type&amp;quot;,&nbsp;&amp;quot;Vanilla&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;syrup-type&amp;quot;)).containsOnly(&amp;quot;Vanilla&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addToExistingValues()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).hasSize(2);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.add(&amp;quot;milk-type&amp;quot;,&nbsp;&amp;quot;Steamed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).containsExactly(&amp;quot;Half-and-half&amp;quot;,&nbsp;&amp;quot;Plus&amp;quot;,&nbsp;&amp;quot;Steamed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAll()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.addAll(&amp;quot;syrup-type&amp;quot;,&nbsp;Arrays.asList(&amp;quot;Vanilla&amp;quot;,&nbsp;&amp;quot;Raspberry&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;syrup-type&amp;quot;)).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAllMultivaluedMap()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getIcedCreamCoffee());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.addAll(new&nbsp;Coffee(getStandard()));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(4);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).containsOnly(&amp;quot;Half-and-half&amp;quot;,&nbsp;&amp;quot;Plus&amp;quot;,&nbsp;&amp;quot;Cream&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;coffee&amp;quot;)).containsOnly(&amp;quot;Arabica&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;brew&amp;quot;)).containsOnly(&amp;quot;Iced&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;sugar&amp;quot;)).containsOnly(&amp;quot;None&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;addAllKeyCollection()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getIcedCreamCoffee());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.addAll(&amp;quot;milk-type&amp;quot;,&nbsp;Arrays.asList(&amp;quot;Steamed&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).containsOnly(&amp;quot;Cream&amp;quot;,&nbsp;&amp;quot;Steamed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;brew&amp;quot;)).containsOnly(&amp;quot;Iced&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;sugar&amp;quot;)).containsOnly(&amp;quot;None&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;getFirst()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.getFirst(&amp;quot;milk-type&amp;quot;)).isEqualTo(&amp;quot;Half-and-half&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;putSingleAllowsNull()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.putSingle(null,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;putSingle()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.putSingle(&amp;quot;syrup-type&amp;quot;,&nbsp;&amp;quot;Caramel&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.getFirst(&amp;quot;syrup-type&amp;quot;)).isEqualTo(&amp;quot;Caramel&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;putSingleOverridesExistingValues()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Coffee&nbsp;mine&nbsp;=&nbsp;new&nbsp;Coffee(getStandard());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine).hasSize(2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).containsOnly(&amp;quot;Half-and-half&amp;quot;,&nbsp;&amp;quot;Plus&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mine.putSingle(&amp;quot;milk-type&amp;quot;,&nbsp;&amp;quot;Steamed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(mine.get(&amp;quot;milk-type&amp;quot;)).containsOnly(&amp;quot;Steamed&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;&nbsp;getStandard()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;&nbsp;custom&nbsp;=&nbsp;new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom.put(&amp;quot;milk-type&amp;quot;,&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;(Arrays.asList(&amp;quot;Half-and-half&amp;quot;,&nbsp;&amp;quot;Plus&amp;quot;)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom.put(&amp;quot;coffee&amp;quot;,&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;(Arrays.asList(&amp;quot;Arabica&amp;quot;)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;custom;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;&nbsp;getIcedCreamCoffee()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;&nbsp;custom&nbsp;=&nbsp;new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom.put(&amp;quot;milk-type&amp;quot;,&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;(Arrays.asList(&amp;quot;Cream&amp;quot;)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom.put(&amp;quot;brew&amp;quot;,&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;(Arrays.asList(&amp;quot;Iced&amp;quot;)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;custom.put(&amp;quot;sugar&amp;quot;,&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;(Arrays.asList(&amp;quot;None&amp;quot;)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;custom;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;class&nbsp;Coffee&nbsp;extends&nbsp;MultiValueMap&amp;lt;String,&nbsp;String&amp;gt;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coffee(Map&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;&nbsp;map)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;List&amp;lt;String&amp;gt;&amp;gt;(map));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MultiValuedMapTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilMutableUriTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MutableUriTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MutableUriTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MutableUriTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,300&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.http.MutableUri.uri;<br>
+<br>
+import&nbsp;java.net.URI;<br>
+<br>
+import&nbsp;org.forgerock.http.MutableUri;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;MutableUriTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Test&nbsp;for&nbsp;un-encoded&nbsp;values<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;----------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldUpdateScheme()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setScheme(&amp;quot;https&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;https://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getScheme()).isEqualTo(&amp;quot;https&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldUpdateHost()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setHost(&amp;quot;openig.forgerock.org&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://openig.forgerock.org&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getHost()).isEqualTo(&amp;quot;openig.forgerock.org&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldUpdatePort()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPort(8080);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com:8080&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPort()).isEqualTo(8080);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemovePort()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com:8080&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPort(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPort()).isEqualTo(-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setUserInfo(&amp;quot;bjensen:s3cr3t&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://bjensen:s3cr3t@www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getUserInfo()).isEqualTo(&amp;quot;bjensen:s3cr3t&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldModifyUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://bjensen:s3cr3t@www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setUserInfo(&amp;quot;guillaume:password&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://guillaume:password@www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getUserInfo()).isEqualTo(&amp;quot;guillaume:password&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://bjensen:s3cr3t@www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setUserInfo(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getUserInfo()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddPath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPath(&amp;quot;/openig&nbsp;space/fr&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com/openig%20space/fr&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPath()).isEqualTo(&amp;quot;/openig&nbsp;space/fr&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldModifyPath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com/openig&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPath(&amp;quot;/forgerock&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com/forgerock&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPath()).isEqualTo(&amp;quot;/forgerock&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemovePath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com/openig&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPath(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Note:&nbsp;because&nbsp;we&nbsp;rebuild&nbsp;the&nbsp;full&nbsp;URL&nbsp;at&nbsp;each&nbsp;modification,&nbsp;it&nbsp;seems&nbsp;the&nbsp;underlying&nbsp;URI&nbsp;find&nbsp;an&nbsp;empty&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;instead&nbsp;of&nbsp;a&nbsp;null&nbsp;pah<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPath()).isNullOrEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setQuery(&amp;quot;one=two&nbsp;three&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com?one=two%20three&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getQuery()).isEqualTo(&amp;quot;one=two&nbsp;three&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldModifyQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com?one=two%20three&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setQuery(&amp;quot;a=b&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com?a=b&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getQuery()).isEqualTo(&amp;quot;a=b&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com?a=b&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setQuery(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getQuery()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setFragment(&amp;quot;marker&nbsp;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com#marker%20one&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getFragment()).isEqualTo(&amp;quot;marker&nbsp;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldModifyFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com#other&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setFragment(&amp;quot;marker&nbsp;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com#marker%20one&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getFragment()).isEqualTo(&amp;quot;marker&nbsp;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com#marker&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setFragment(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getFragment()).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Test&nbsp;for&nbsp;encoded&nbsp;values&nbsp;(URL&nbsp;encoded)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;----------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddRawUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawUserInfo(&amp;quot;bjen%20sen:s3c%3Dr3t&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://bjen%20sen:s3c%3Dr3t@www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveRawUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://bjensen:s3cr3t@www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawUserInfo(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddRawPath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawPath(&amp;quot;/openig%20space/fr&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com/openig%20space/fr&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveRawPath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com/openig&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawPath(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddRawQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawQuery(&amp;quot;one=two%20three&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com?one=two%20three&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveRawQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com?a=b&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawQuery(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAddRawFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawFragment(&amp;quot;marker%20one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com#marker%20one&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRemoveRawFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com#marker&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setRawFragment(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri).isEqualTo(uri(&amp;quot;http://www.example.com&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Test&nbsp;for&nbsp;getter&nbsp;(raw&nbsp;and&nbsp;normal)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;----------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testGetters()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://my%20user:pass%3Fword@www.example.com:80/path%20space/fr?x=%3D#marker%20one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getScheme()).isEqualTo(&amp;quot;http&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getUserInfo()).isEqualTo(&amp;quot;my&nbsp;user:pass?word&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawUserInfo()).isEqualTo(&amp;quot;my%20user:pass%3Fword&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getHost()).isEqualTo(&amp;quot;www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPort()).isEqualTo(80);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getAuthority()).isEqualTo(&amp;quot;my&nbsp;user:pass?word@www.example.com:80&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawAuthority()).isEqualTo(&amp;quot;my%20user:pass%3Fword@www.example.com:80&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPath()).isEqualTo(&amp;quot;/path&nbsp;space/fr&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawPath()).isEqualTo(&amp;quot;/path%20space/fr&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getQuery()).isEqualTo(&amp;quot;x==&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawQuery()).isEqualTo(&amp;quot;x=%3D&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getFragment()).isEqualTo(&amp;quot;marker&nbsp;one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawFragment()).isEqualTo(&amp;quot;marker%20one&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Other&nbsp;methods<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;---------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRebaseSchemeHostAndPort()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;https://doot.doot.doo.org/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.rebase(new&nbsp;URI(&amp;quot;http://www.example.com:8080&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.toString())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.isEqualTo(&amp;quot;http://www.example.com:8080/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldRebaseSchemeHostAndPortAndIgnoringOtherElements()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;https://doot.doot.doo.org/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.rebase(new&nbsp;URI(&amp;quot;http://www.example.com:8080/mypath?a=b#marker&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.toString())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.isEqualTo(&amp;quot;http://www.example.com:8080/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Tests&nbsp;for&nbsp;correct&nbsp;encoding&nbsp;of&nbsp;clear&nbsp;values&nbsp;with&nbsp;reserved&nbsp;characters&nbsp;in&nbsp;URI&nbsp;components<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-------------------------------------------------------------------------------------------<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Note:&nbsp;It&nbsp;appears&nbsp;that&nbsp;when&nbsp;we&nbsp;re-create&nbsp;a&nbsp;URI&nbsp;with&nbsp;decoded&nbsp;values&nbsp;that&nbsp;contains&nbsp;reserved<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;characters&nbsp;('=',&nbsp;'?',&nbsp;...)&nbsp;the&nbsp;URI&nbsp;inner&nbsp;parser&nbsp;doesn't&nbsp;re-encode&nbsp;properly&nbsp;the&nbsp;reserved&nbsp;char<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;for&nbsp;some&nbsp;components.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;-------------------------------------------------------------------------------------------<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAcceptReservedCharactersInSetQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setQuery(&amp;quot;x=?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getQuery()).isEqualTo(&amp;quot;x=?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawQuery()).isEqualTo(&amp;quot;x=%3F&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAcceptReservedCharactersInSetPath()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setPath(&amp;quot;/=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getPath()).isEqualTo(&amp;quot;/=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawPath()).isEqualTo(&amp;quot;/%3F&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(enabled&nbsp;=&nbsp;false)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAcceptReservedCharactersInSetFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setFragment(&amp;quot;marker=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getFragment()).isEqualTo(&amp;quot;marker=&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawFragment()).isEqualTo(&amp;quot;marker%3F&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;shouldAcceptReservedCharactersInSetUserInfo()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MutableUri&nbsp;uri&nbsp;=&nbsp;uri(&amp;quot;http://www.example.com&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.setUserInfo(&amp;quot;test:pass?word&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getUserInfo()).isEqualTo(&amp;quot;test:pass?word&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.getRawUserInfo()).isEqualTo(&amp;quot;test:pass%3Fword&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/MutableUriTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpcoresrctestjavaorgforgerockhttputilURIUtilTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/URIUtilTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/URIUtilTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/URIUtilTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,75&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.util;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+<br>
+import&nbsp;java.net.URI;<br>
+<br>
+import&nbsp;org.forgerock.http.Form;<br>
+import&nbsp;org.forgerock.http.URIUtil;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;class&nbsp;URIUtilTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;toURIandBack()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;u1&nbsp;=&nbsp;URIUtil.create(&amp;quot;a&amp;quot;,&nbsp;&amp;quot;b&amp;quot;,&nbsp;&amp;quot;c&amp;quot;,&nbsp;4,&nbsp;&amp;quot;/e%3D&amp;quot;,&nbsp;&amp;quot;x=%3D&amp;quot;,&nbsp;&amp;quot;g%3D&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;u2&nbsp;=&nbsp;URIUtil.create(u1.getScheme(),&nbsp;u1.getRawUserInfo(),&nbsp;u1.getHost(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u1.getPort(),&nbsp;u1.getRawPath(),&nbsp;u1.getRawQuery(),&nbsp;u1.getRawFragment());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(u1).isEqualTo(u2);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;rawParams()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;uri&nbsp;=&nbsp;URIUtil.create(&amp;quot;http&amp;quot;,&nbsp;&amp;quot;user&amp;quot;,&nbsp;&amp;quot;example.com&amp;quot;,&nbsp;80,&nbsp;&amp;quot;/raw%3Dpath&amp;quot;,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;x=%3D&amp;quot;,&nbsp;&amp;quot;frag%3Dment&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(uri.toString()).isEqualTo(&amp;quot;http://user@example.com:80/raw%3Dpath?x=%3D#frag%3Dment&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;rebase()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(&amp;quot;https://doot.doot.doo.org/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;base&nbsp;=&nbsp;new&nbsp;URI(&amp;quot;http://www.example.com/&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;rebased&nbsp;=&nbsp;URIUtil.rebase(uri,&nbsp;base);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(rebased.toString()).isEqualTo(&amp;quot;http://www.example.com/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testWithQuery()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(&amp;quot;https://doot.doot.doo.org/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;form&nbsp;=&nbsp;new&nbsp;Form();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.add(&amp;quot;goto&amp;quot;,&nbsp;&amp;quot;http://some.url&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.add(&amp;quot;state&amp;quot;,&nbsp;&amp;quot;1234567890&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;withQuery&nbsp;=&nbsp;URIUtil.withQuery(uri,&nbsp;form);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Form&nbsp;uses&nbsp;LinkedHashMap&nbsp;so&nbsp;parameter&nbsp;order&nbsp;is&nbsp;guaranteed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(withQuery.toString()).isEqualTo(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;https://doot.doot.doo.org/all/good/things?goto=http%3A%2F%2Fsome.url&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;&amp;amp;state=1234567890#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testWithoutQueryAndFragment()&nbsp;throws&nbsp;Exception&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(&amp;quot;https://doot.doot.doo.org/all/good/things?come=to&amp;amp;those=who#breakdance&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;withoutQueryAndFragment&nbsp;=&nbsp;URIUtil.withoutQueryAndFragment(uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(withoutQueryAndFragment.toString()).isEqualTo(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;https://doot.doot.doo.org/all/good/things&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-core/src/test/java/org/forgerock/http/util/URIUtilTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservlet&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;propset&quot;&gt;&lt;h4&gt;Property&nbsp;changes:&nbsp;forgerock-http-framework/trunk/http-servlet&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svnignore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:ignore&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletpomxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/pom.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,65&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;project&nbsp;xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;parent&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-http-framework&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/parent&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;http-servlet&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;packaging&amp;gt;bundle&amp;lt;/packaging&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;name&amp;gt;HTTP&nbsp;Servlet&nbsp;integration&nbsp;library&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;dependencies&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;http-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;${project.version}&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;javax.servlet&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;javax.servlet-api&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;3.0.1&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.assertj&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;assertj-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.mockito&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;mockito-all&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.testng&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;testng&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/dependencies&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;build&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugins&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;extensions&amp;gt;true&amp;lt;/extensions&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugins&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/build&amp;gt;<br>
+&amp;lt;/project&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/pom.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletDefaultRouteHandlerjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/DefaultRouteHandler.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/DefaultRouteHandler.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/DefaultRouteHandler.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,136&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;Spring&nbsp;spring-framework/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/DefaultServletHttpRequestHandler&nbsp;TODO<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;javax.servlet.RequestDispatcher;<br>
+import&nbsp;javax.servlet.ServletContext;<br>
+import&nbsp;javax.servlet.ServletException;<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpServletResponse;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.regex.Pattern;<br>
+<br>
+import&nbsp;org.forgerock.http.Handler;<br>
+import&nbsp;org.forgerock.http.HttpContext;<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.forgerock.http.ResponseException;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+import&nbsp;org.forgerock.util.promise.Promises;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;{@code&nbsp;Handler}&nbsp;implementation&nbsp;to&nbsp;handle&nbsp;the&nbsp;default&nbsp;route&nbsp;for&nbsp;Servlet&nbsp;containers.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;This&nbsp;{@code&nbsp;Handler}&nbsp;should&nbsp;be&nbsp;used&nbsp;to&nbsp;handle&nbsp;requests&nbsp;to&nbsp;static&nbsp;resources.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;DefaultRouteHandler&nbsp;implements&nbsp;Handler&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;Servlet&nbsp;name&nbsp;used&nbsp;by&nbsp;Tomcat,&nbsp;Jetty,&nbsp;JBoss,&nbsp;and&nbsp;GlassFish&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;COMMON_DEFAULT_SERVLET_NAME&nbsp;=&nbsp;&amp;quot;default&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;Servlet&nbsp;name&nbsp;used&nbsp;by&nbsp;Google&nbsp;App&nbsp;Engine&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;GAE_DEFAULT_SERVLET_NAME&nbsp;=&nbsp;&amp;quot;_ah_default&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;Servlet&nbsp;name&nbsp;used&nbsp;by&nbsp;Resin&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;RESIN_DEFAULT_SERVLET_NAME&nbsp;=&nbsp;&amp;quot;resin-file&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;Servlet&nbsp;name&nbsp;used&nbsp;by&nbsp;WebLogic&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;WEBLOGIC_DEFAULT_SERVLET_NAME&nbsp;=&nbsp;&amp;quot;FileServlet&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Default&nbsp;Servlet&nbsp;name&nbsp;used&nbsp;by&nbsp;WebSphere&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;WEBSPHERE_DEFAULT_SERVLET_NAME&nbsp;=&nbsp;&amp;quot;SimpleFileServlet&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;ServletContext&nbsp;servletContext;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;defaultServletName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Map&amp;lt;Pattern,&nbsp;String&amp;gt;&nbsp;staticRouteServlets;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;DefaultRouteHandler(ServletContext&nbsp;servletContext,&nbsp;String&nbsp;defaultServletName,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;Pattern,&nbsp;String&amp;gt;&nbsp;staticRouteServlets)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.servletContext&nbsp;=&nbsp;servletContext;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.staticRouteServlets&nbsp;=&nbsp;staticRouteServlets;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(defaultServletName&nbsp;==&nbsp;null&nbsp;||&nbsp;defaultServletName.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.servletContext.getNamedDispatcher(COMMON_DEFAULT_SERVLET_NAME)&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;COMMON_DEFAULT_SERVLET_NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(this.servletContext.getNamedDispatcher(GAE_DEFAULT_SERVLET_NAME)&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;GAE_DEFAULT_SERVLET_NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(this.servletContext.getNamedDispatcher(RESIN_DEFAULT_SERVLET_NAME)&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;RESIN_DEFAULT_SERVLET_NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(this.servletContext.getNamedDispatcher(WEBLOGIC_DEFAULT_SERVLET_NAME)&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;WEBLOGIC_DEFAULT_SERVLET_NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(this.servletContext.getNamedDispatcher(WEBSPHERE_DEFAULT_SERVLET_NAME)&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;WEBSPHERE_DEFAULT_SERVLET_NAME;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(&amp;quot;Unable&nbsp;to&nbsp;locate&nbsp;the&nbsp;default&nbsp;servlet&nbsp;for&nbsp;serving&nbsp;static&nbsp;content.&nbsp;&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;Please&nbsp;set&nbsp;the&nbsp;'defaultServletName'&nbsp;property&nbsp;explicitly.&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultServletName&nbsp;=&nbsp;defaultServletName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Dispatches&nbsp;the&nbsp;request&nbsp;to&nbsp;be&nbsp;handled&nbsp;by&nbsp;a&nbsp;different&nbsp;Servlet.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;context&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;request&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;successful&nbsp;promise&nbsp;with&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;{@code&nbsp;Response}&nbsp;to&nbsp;signify&nbsp;that&nbsp;the&nbsp;container&nbsp;has&nbsp;already<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;handled&nbsp;the&nbsp;response&nbsp;or&nbsp;a&nbsp;Internal&nbsp;Server&nbsp;Error&nbsp;response&nbsp;if&nbsp;the&nbsp;request&nbsp;could&nbsp;not&nbsp;be&nbsp;dispatched.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;handle(Context&nbsp;context,&nbsp;Request&nbsp;request)&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpContext&nbsp;httpContext&nbsp;=&nbsp;context.asContext(HttpContext.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletRequest&nbsp;req&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(HttpServletRequest)&nbsp;httpContext.getAttributes().get(HttpServletRequest.class.getName());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse&nbsp;resp&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(HttpServletResponse)&nbsp;httpContext.getAttributes().get(HttpServletResponse.class.getName());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;servletName&nbsp;=&nbsp;getServletName(request);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RequestDispatcher&nbsp;dispatcher&nbsp;=&nbsp;servletContext.getNamedDispatcher(servletName);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(dispatcher&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalStateException(&amp;quot;A&nbsp;RequestDispatcher&nbsp;could&nbsp;not&nbsp;be&nbsp;located&nbsp;for&nbsp;the&nbsp;default&nbsp;servlet&nbsp;'&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;servletName&nbsp;+&nbsp;&amp;quot;'&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispatcher.forward(req,&nbsp;resp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(ServletException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newFailedPromise(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;ResponseException(new&nbsp;Response().setStatusAndReason(500),&nbsp;e.getMessage(),&nbsp;e));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newFailedPromise(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;ResponseException(new&nbsp;Response().setStatusAndReason(500),&nbsp;e.getMessage(),&nbsp;e));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Returns&nbsp;null&nbsp;as&nbsp;the&nbsp;container&nbsp;has&nbsp;already&nbsp;handled&nbsp;the&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Promises.newSuccessfulPromise(null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;getServletName(Request&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;servletName&nbsp;=&nbsp;defaultServletName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Map.Entry&amp;lt;Pattern,&nbsp;String&amp;gt;&nbsp;staticRouteServlet&nbsp;:&nbsp;staticRouteServlets.entrySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(staticRouteServlet.getKey().matcher(request.getUri().getPath()).matches())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;servletName&nbsp;=&nbsp;staticRouteServlet.getValue();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;servletName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/DefaultRouteHandler.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletHttpFrameworkServletjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/HttpFrameworkServlet.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/HttpFrameworkServlet.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/HttpFrameworkServlet.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,318&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.http.io.IO.newBranchingInputStream;<br>
+import&nbsp;static&nbsp;org.forgerock.http.io.IO.newTemporaryStorage;<br>
+import&nbsp;static&nbsp;org.forgerock.util.Utils.closeSilently;<br>
+<br>
+import&nbsp;javax.servlet.ServletContext;<br>
+import&nbsp;javax.servlet.ServletException;<br>
+import&nbsp;javax.servlet.http.HttpServlet;<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpServletResponse;<br>
+import&nbsp;java.io.File;<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.net.URISyntaxException;<br>
+import&nbsp;java.security.cert.X509Certificate;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Arrays;<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.Enumeration;<br>
+import&nbsp;java.util.Iterator;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.ServiceLoader;<br>
+<br>
+import&nbsp;org.forgerock.http.ClientInfoContext;<br>
+import&nbsp;org.forgerock.http.Handler;<br>
+import&nbsp;org.forgerock.http.HttpApplication;<br>
+import&nbsp;org.forgerock.http.HttpApplicationException;<br>
+import&nbsp;org.forgerock.http.HttpContext;<br>
+import&nbsp;org.forgerock.http.Request;<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.forgerock.http.ResponseException;<br>
+import&nbsp;org.forgerock.http.Session;<br>
+import&nbsp;org.forgerock.http.URIUtil;<br>
+import&nbsp;org.forgerock.http.io.Buffer;<br>
+import&nbsp;org.forgerock.http.util.CaseInsensitiveSet;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.ResourceName;<br>
+import&nbsp;org.forgerock.resource.core.RootContext;<br>
+import&nbsp;org.forgerock.resource.core.routing.RouterContext;<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+import&nbsp;org.forgerock.util.promise.FailureHandler;<br>
+import&nbsp;org.forgerock.util.promise.Promise;<br>
+import&nbsp;org.forgerock.util.promise.SuccessHandler;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;An&nbsp;HTTP&nbsp;servlet&nbsp;implementation&nbsp;which&nbsp;provides&nbsp;integration&nbsp;between&nbsp;the&nbsp;Servlet<br>
+&nbsp;*&nbsp;API&nbsp;and&nbsp;the&nbsp;common&nbsp;HTTP&nbsp;Framework.<br>
+&nbsp;*&nbsp;&amp;lt;/p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;A&nbsp;{@link&nbsp;HttpApplication}&nbsp;implementation&nbsp;must&nbsp;be&nbsp;registered&nbsp;in&nbsp;the<br>
+&nbsp;*&nbsp;{@link&nbsp;ServiceLoader}&nbsp;framework<br>
+&nbsp;*&nbsp;&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;HttpApplication<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;HttpFrameworkServlet&nbsp;extends&nbsp;HttpServlet&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;3524182656424860912L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Standard&nbsp;specified&nbsp;request&nbsp;attribute&nbsp;name&nbsp;for&nbsp;retrieving&nbsp;X509&nbsp;Certificates.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;SERVLET_REQUEST_X509_ATTRIBUTE&nbsp;=&nbsp;&amp;quot;javax.servlet.request.X509Certificate&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;Methods&nbsp;that&nbsp;should&nbsp;not&nbsp;include&nbsp;an&nbsp;entity&nbsp;body.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;CaseInsensitiveSet&nbsp;NON_ENTITY_METHODS&nbsp;=&nbsp;new&nbsp;CaseInsensitiveSet(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays.asList(&amp;quot;GET&amp;quot;,&nbsp;&amp;quot;HEAD&amp;quot;,&nbsp;&amp;quot;TRACE&amp;quot;,&nbsp;&amp;quot;DELETE&amp;quot;));<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Servlet&nbsp;3.x&nbsp;defines&nbsp;ServletContext.TEMPDIR&nbsp;constant,&nbsp;but&nbsp;this&nbsp;does&nbsp;not<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;exist&nbsp;in&nbsp;Servlet&nbsp;2.5,&nbsp;hence&nbsp;the&nbsp;constant&nbsp;redefined&nbsp;here.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String&nbsp;SERVLET_TEMP_DIR&nbsp;=&nbsp;&amp;quot;javax.servlet.context.tempdir&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ServletVersionAdapter&nbsp;adapter;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;HttpApplication&nbsp;application;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;storage;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Handler&nbsp;handler;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;init()&nbsp;throws&nbsp;ServletException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adapter&nbsp;=&nbsp;getAdapter(getServletContext());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;=&nbsp;new&nbsp;ServletHttpApplicationWrapper(getApplication(),&nbsp;getServletContext());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;storage&nbsp;=&nbsp;application.getBufferFactory();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(storage&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;File&nbsp;tmpDir&nbsp;=&nbsp;(File)&nbsp;getServletContext().getAttribute(SERVLET_TEMP_DIR);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;storage&nbsp;=&nbsp;newTemporaryStorage(tmpDir);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handler&nbsp;=&nbsp;application.start();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(HttpApplicationException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(&amp;quot;Failed&nbsp;to&nbsp;start&nbsp;HTTP&nbsp;Application&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ServletVersionAdapter&nbsp;getAdapter(ServletContext&nbsp;servletContext)&nbsp;throws&nbsp;ServletException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(servletContext.getMajorVersion())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;FIXME:&nbsp;i18n.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(&amp;quot;Unsupported&nbsp;Servlet&nbsp;version&nbsp;&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;servletContext.getMajorVersion());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;2:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Servlet2Adapter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Servlet3Adapter();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;HttpApplication&nbsp;getApplication()&nbsp;throws&nbsp;ServletException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServiceLoader&amp;lt;HttpApplication&amp;gt;&nbsp;configurations&nbsp;=&nbsp;ServiceLoader.load(HttpApplication.class);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterator&amp;lt;HttpApplication&amp;gt;&nbsp;iterator&nbsp;=&nbsp;configurations.iterator();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!iterator.hasNext())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(&amp;quot;No&nbsp;ServletConfiguration&nbsp;implementation&nbsp;registered.&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpApplication&nbsp;configuration&nbsp;=&nbsp;iterator.next();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(iterator.hasNext())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Multiple&nbsp;ServletConfigurations&nbsp;registered!<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&amp;lt;Object&amp;gt;&nbsp;messageParams&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;Object&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messageParams.add(iterator.next().getClass().getName());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;message&nbsp;=&nbsp;&amp;quot;Multiple&nbsp;ServletConfiguration&nbsp;implementations&nbsp;registered.\n%d&nbsp;configurations&nbsp;found:&nbsp;%s&amp;quot;;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(iterator.hasNext())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messageParams.add(iterator.next().getClass().getName());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;+=&nbsp;&amp;quot;,&nbsp;%s&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messageParams.add(0,&nbsp;messageParams.size());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(String.format(message,&nbsp;messageParams.toArray()));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;configuration;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;void&nbsp;service(final&nbsp;HttpServletRequest&nbsp;req,&nbsp;final&nbsp;HttpServletResponse&nbsp;resp)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;ServletException,&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Request&nbsp;request&nbsp;=&nbsp;createRequest(req);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Session&nbsp;session&nbsp;=&nbsp;new&nbsp;ServletSession(req);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;HttpContext&nbsp;httpContext&nbsp;=&nbsp;new&nbsp;HttpContext(new&nbsp;RootContext(),&nbsp;session)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setPrincipal(req.getUserPrincipal());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enumeration&amp;lt;String&amp;gt;&nbsp;attributeNames&nbsp;=&nbsp;req.getAttributeNames();&nbsp;//TODO&nbsp;add&nbsp;comment&nbsp;on&nbsp;why&nbsp;this&nbsp;was&nbsp;added&nbsp;as&nbsp;probably&nbsp;shouldn't&nbsp;stick&nbsp;around&nbsp;as&nbsp;only&nbsp;to&nbsp;fix&nbsp;AM's&nbsp;case&nbsp;of&nbsp;forwarding&nbsp;the&nbsp;request&nbsp;from&nbsp;a&nbsp;different&nbsp;servlet?....<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(attributeNames.hasMoreElements())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;attributeName&nbsp;=&nbsp;attributeNames.nextElement();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpContext.getAttributes().put(attributeName,&nbsp;req.getAttribute(attributeName));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//FIXME&nbsp;ideally&nbsp;we&nbsp;don't&nbsp;want&nbsp;to&nbsp;expose&nbsp;the&nbsp;HttpServlet&nbsp;Request&nbsp;and&nbsp;Response<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;handy&nbsp;servlet-specific&nbsp;attributes,&nbsp;sure&nbsp;to&nbsp;be&nbsp;abused&nbsp;by&nbsp;downstream&nbsp;filters<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpContext.getAttributes().put(HttpServletRequest.class.getName(),&nbsp;req);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpContext.getAttributes().put(HttpServletResponse.class.getName(),&nbsp;resp);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;createRouterContext(createClientInfoContext(httpContext,&nbsp;req),&nbsp;req);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;handle&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;ServletSynchronizer&nbsp;sync&nbsp;=&nbsp;adapter.createServletSynchronizer(req,&nbsp;resp);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Promise&amp;lt;Response,&nbsp;ResponseException&amp;gt;&nbsp;promise&nbsp;=&nbsp;handler.handle(context,&nbsp;request)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.onSuccess(new&nbsp;SuccessHandler&amp;lt;Response&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;handleResult(Response&nbsp;response)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeResponse(httpContext,&nbsp;resp,&nbsp;response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(&amp;quot;Failed&nbsp;to&nbsp;write&nbsp;success&nbsp;response&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(request,&nbsp;response);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.signalAndComplete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.onFailure(new&nbsp;FailureHandler&amp;lt;ResponseException&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;handleError(ResponseException&nbsp;error)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeResponse(httpContext,&nbsp;resp,&nbsp;error.getResponse());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(&amp;quot;Failed&nbsp;to&nbsp;write&nbsp;success&nbsp;response&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(request,&nbsp;error.getResponse());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.signalAndComplete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.setAsyncListener(new&nbsp;Runnable()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;run()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;promise.cancel(true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//TODO&nbsp;is&nbsp;this&nbsp;needed?&nbsp;Not&nbsp;sure&nbsp;if&nbsp;the&nbsp;latch&nbsp;would&nbsp;have&nbsp;been&nbsp;freed&nbsp;by&nbsp;now.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.signalAndComplete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(ResponseException&nbsp;error)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeResponse(httpContext,&nbsp;resp,&nbsp;error.getResponse());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(&amp;quot;Failed&nbsp;to&nbsp;write&nbsp;success&nbsp;response&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closeSilently(request,&nbsp;error.getResponse());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.signalAndComplete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync.awaitIfNeeded();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(InterruptedException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(&amp;quot;Awaiting&nbsp;asynchronous&nbsp;request&nbsp;was&nbsp;interrupted.&amp;quot;,&nbsp;e);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Request&nbsp;createRequest(HttpServletRequest&nbsp;req)&nbsp;throws&nbsp;ServletException,&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;populate&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request&nbsp;request&nbsp;=&nbsp;new&nbsp;Request();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setMethod(req.getMethod());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setUri(URIUtil.create(req.getScheme(),&nbsp;null,&nbsp;req.getServerName(),<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.getServerPort(),&nbsp;req.getRequestURI(),&nbsp;req.getQueryString(),&nbsp;null));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(URISyntaxException&nbsp;use)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ServletException(use);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;request&nbsp;headers<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Enumeration&amp;lt;String&amp;gt;&nbsp;e&nbsp;=&nbsp;req.getHeaderNames();&nbsp;e.hasMoreElements();)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;name&nbsp;=&nbsp;e.nextElement();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.getHeaders().addAll(name,&nbsp;Collections.list(req.getHeaders(name)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;include&nbsp;request&nbsp;entity&nbsp;if&nbsp;appears&nbsp;to&nbsp;be&nbsp;provided&nbsp;with&nbsp;request<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((req.getContentLength()&nbsp;&amp;gt;&nbsp;0&nbsp;||&nbsp;req.getHeader(&amp;quot;Transfer-Encoding&amp;quot;)&nbsp;!=&nbsp;null)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;!NON_ENTITY_METHODS.contains(request.getMethod()))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.setEntity(newBranchingInputStream(req.getInputStream(),&nbsp;storage));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;request;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ClientInfoContext&nbsp;createClientInfoContext(Context&nbsp;parent,&nbsp;HttpServletRequest&nbsp;req)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClientInfoContext.builder(parent)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.remoteUser(req.getRemoteUser())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.remoteAddress(req.getRemoteAddr())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.remoteHost(req.getRemoteHost())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.remotePort(req.getRemotePort())<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.certificates((X509Certificate[])&nbsp;req.getAttribute(SERVLET_REQUEST_X509_ATTRIBUTE))<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.userAgent(req.getHeader(&amp;quot;User-Agent&amp;quot;))<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.build();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;RouterContext&nbsp;createRouterContext(Context&nbsp;parent,&nbsp;HttpServletRequest&nbsp;req)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;contextPath&nbsp;=&nbsp;forceEmptyIfNull(req.getContextPath());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contextPath&nbsp;=&nbsp;contextPath.startsWith(&amp;quot;/&amp;quot;)&nbsp;?&nbsp;contextPath.substring(1)&nbsp;:&nbsp;contextPath;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;matchedUri&nbsp;=&nbsp;contextPath&nbsp;+&nbsp;forceEmptyIfNull(req.getServletPath());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ResourceName.valueOf(matchedUri).equals(ResourceName.valueOf(req.getRequestURI())))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Must&nbsp;be&nbsp;registered&nbsp;at&nbsp;'/'&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matchedUri&nbsp;=&nbsp;contextPath;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;RouterContext(parent,&nbsp;matchedUri,&nbsp;Collections.&amp;lt;String,&nbsp;String&amp;gt;emptyMap());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;forceEmptyIfNull(final&nbsp;String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s&nbsp;!=&nbsp;null&nbsp;?&nbsp;s&nbsp;:&nbsp;&amp;quot;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;writeResponse(HttpContext&nbsp;context,&nbsp;HttpServletResponse&nbsp;resp,&nbsp;Response&nbsp;response)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Support&nbsp;for&nbsp;OPENIG-94/95&nbsp;-&nbsp;The&nbsp;wrapped&nbsp;servlet&nbsp;may&nbsp;have&nbsp;already<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;committed&nbsp;its&nbsp;response&nbsp;w/o&nbsp;creating&nbsp;a&nbsp;new&nbsp;OpenIG&nbsp;Response&nbsp;instance&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;exchange.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(response&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;response&nbsp;status-code&nbsp;(reason-phrase&nbsp;deprecated&nbsp;in&nbsp;Servlet&nbsp;API)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resp.setStatus(response.getStatus());<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ensure&nbsp;that&nbsp;the&nbsp;session&nbsp;has&nbsp;been&nbsp;written&nbsp;back&nbsp;to&nbsp;the&nbsp;response<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.getSession().save(response);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;response&nbsp;headers<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;name&nbsp;:&nbsp;response.getHeaders().keySet())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(String&nbsp;value&nbsp;:&nbsp;response.getHeaders().get(name))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;value.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resp.addHeader(name,&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;response&nbsp;entity&nbsp;(if&nbsp;applicable)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO&nbsp;does&nbsp;this&nbsp;also&nbsp;set&nbsp;content&nbsp;length?<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.getEntity().copyRawContentTo(resp.getOutputStream());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;destroy()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application.stop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/HttpFrameworkServlet.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServlet2Adapterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet2Adapter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet2Adapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet2Adapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,70&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpServletResponse;<br>
+import&nbsp;java.util.concurrent.CountDownLatch;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;adapter&nbsp;for&nbsp;use&nbsp;in&nbsp;Servlet&nbsp;2.x&nbsp;containers.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;Servlet2Adapter&nbsp;implements&nbsp;ServletVersionAdapter&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Synchronization&nbsp;implementation.&nbsp;Package&nbsp;private&nbsp;because&nbsp;it&nbsp;is&nbsp;used&nbsp;as&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;fall-back&nbsp;implementation&nbsp;in&nbsp;Servlet&nbsp;3&nbsp;when&nbsp;async&nbsp;is&nbsp;not&nbsp;supported.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;static&nbsp;class&nbsp;Servlet2Synchronizer&nbsp;implements&nbsp;ServletSynchronizer&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;CountDownLatch&nbsp;requestCompletionLatch&nbsp;=&nbsp;new&nbsp;CountDownLatch(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Runnable&nbsp;listener;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Servlet2Synchronizer()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setAsyncListener(Runnable&nbsp;runnable)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listener&nbsp;=&nbsp;runnable;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;awaitIfNeeded()&nbsp;throws&nbsp;InterruptedException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requestCompletionLatch.await();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(listener&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listener.run();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;signalAndComplete()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requestCompletionLatch.countDown();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Servlet2Adapter()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServletSynchronizer&nbsp;createServletSynchronizer(HttpServletRequest&nbsp;httpRequest,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse&nbsp;httpResponse)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Servlet2Synchronizer();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet2Adapter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServlet3Adapterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet3Adapter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet3Adapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet3Adapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,105&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+import&nbsp;javax.servlet.AsyncContext;<br>
+import&nbsp;javax.servlet.AsyncEvent;<br>
+import&nbsp;javax.servlet.AsyncListener;<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpServletResponse;<br>
+<br>
+import&nbsp;org.forgerock.http.servlet.Servlet2Adapter.Servlet2Synchronizer;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;adapter&nbsp;for&nbsp;use&nbsp;in&nbsp;Servlet&nbsp;3.x&nbsp;containers.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;Servlet3Adapter&nbsp;implements&nbsp;ServletVersionAdapter&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Synchronization&nbsp;implementation&nbsp;-&nbsp;only&nbsp;used&nbsp;when&nbsp;the&nbsp;container&nbsp;supports<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;asynchronous&nbsp;processing.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;static&nbsp;class&nbsp;Servlet3Synchronizer&nbsp;implements&nbsp;ServletSynchronizer&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;AsyncContext&nbsp;asyncContext;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Servlet3Synchronizer(HttpServletRequest&nbsp;httpRequest)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpRequest.isAsyncStarted())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.asyncContext&nbsp;=&nbsp;httpRequest.getAsyncContext();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.asyncContext&nbsp;=&nbsp;httpRequest.startAsync();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Disable&nbsp;timeouts&nbsp;for&nbsp;certain&nbsp;containers&nbsp;-&nbsp;see&nbsp;http://java.net/jira/browse/GRIZZLY-1325<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asyncContext.setTimeout(0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setAsyncListener(final&nbsp;Runnable&nbsp;runnable)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asyncContext.addListener(new&nbsp;AsyncListener()&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onComplete(AsyncEvent&nbsp;event)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runnable.run();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onError(AsyncEvent&nbsp;event)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runnable.run();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onStartAsync(AsyncEvent&nbsp;event)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reregister.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;event.getAsyncContext().addListener(this);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;onTimeout(AsyncEvent&nbsp;event)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runnable.run();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;awaitIfNeeded()&nbsp;throws&nbsp;InterruptedException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;signal:&nbsp;this&nbsp;dispatcher&nbsp;is&nbsp;non-blocking.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;signalAndComplete()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asyncContext.complete();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Servlet3Adapter()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServletSynchronizer&nbsp;createServletSynchronizer(HttpServletRequest&nbsp;httpRequest,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpServletResponse&nbsp;httpResponse)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpRequest.isAsyncSupported())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Servlet3Synchronizer(httpRequest);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Fall-back&nbsp;to&nbsp;Servlet&nbsp;2&nbsp;blocking&nbsp;implementation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Servlet2Synchronizer();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/Servlet3Adapter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletHttpApplicationjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplication.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplication.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplication.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,55&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.regex.Pattern;<br>
+<br>
+import&nbsp;org.forgerock.http.HttpApplication;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;Servlet&nbsp;specific&nbsp;configuration&nbsp;class&nbsp;to&nbsp;configure&nbsp;the&nbsp;{@code&nbsp;HttpApplication}&nbsp;instance.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;It&nbsp;is&nbsp;preferred&nbsp;to&nbsp;use&nbsp;the&nbsp;{@link&nbsp;HttpApplication}&nbsp;interface&nbsp;over&nbsp;this&nbsp;implementation&nbsp;specific&nbsp;interface,&nbsp;as<br>
+&nbsp;*&nbsp;this&nbsp;ties&nbsp;the&nbsp;application&nbsp;to&nbsp;being&nbsp;run&nbsp;in&nbsp;a&nbsp;Servlet&nbsp;container.&amp;lt;/p&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;HttpApplication<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;ServletHttpApplication&nbsp;extends&nbsp;HttpApplication&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Gets&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;Servlet&nbsp;that&nbsp;handles&nbsp;all&nbsp;default&nbsp;routes&nbsp;for&nbsp;the&nbsp;container.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Only&nbsp;set&nbsp;if&nbsp;differs&nbsp;from&nbsp;the&nbsp;default&nbsp;for&nbsp;Tomcat,&nbsp;Jetty,&nbsp;GlassFish,&nbsp;Google&nbsp;App&nbsp;Engine,&nbsp;Resin,&nbsp;WebLogic&nbsp;or<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;WebSphere&nbsp;default&nbsp;Servlet.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;container's&nbsp;default&nbsp;Servlet.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getDefaultServletName();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Gets&nbsp;the&nbsp;static&nbsp;route&nbsp;Servlets&nbsp;for&nbsp;specific&nbsp;paths.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Maps&nbsp;routes&nbsp;to&nbsp;specific&nbsp;static&nbsp;resource&nbsp;and&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;Servlet&nbsp;that&nbsp;will&nbsp;handle&nbsp;requests&nbsp;for&nbsp;them.&nbsp;By<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;default&nbsp;the&nbsp;container's&nbsp;default&nbsp;Servlet&nbsp;will&nbsp;handle&nbsp;all&nbsp;requests&nbsp;to&nbsp;static&nbsp;resources,&nbsp;use&nbsp;this&nbsp;method&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;override&nbsp;this&nbsp;behaviour.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;{@code&nbsp;Map}&nbsp;of&nbsp;static&nbsp;route&nbsp;Servlet.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;Pattern,&nbsp;String&amp;gt;&nbsp;getStaticRouteServlets();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplication.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletHttpApplicationWrapperjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplicationWrapper.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplicationWrapper.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplicationWrapper.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,88&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;org.forgerock.http.Handler;<br>
+import&nbsp;org.forgerock.http.HttpApplication;<br>
+import&nbsp;org.forgerock.http.HttpApplicationException;<br>
+import&nbsp;org.forgerock.http.io.Buffer;<br>
+import&nbsp;org.forgerock.http.routing.UriRouter;<br>
+import&nbsp;org.forgerock.util.Factory;<br>
+<br>
+import&nbsp;javax.servlet.ServletContext;<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.regex.Pattern;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Wraps&nbsp;a&nbsp;{@link&nbsp;HttpApplication}&nbsp;instance&nbsp;and&nbsp;encapsulates&nbsp;Servlet&nbsp;specific&nbsp;application&nbsp;handling&nbsp;logic.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;ServletHttpApplicationWrapper&nbsp;implements&nbsp;HttpApplication&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;HttpApplication&nbsp;application;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;ServletContext&nbsp;servletContext;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;ServletHttpApplicationWrapper(HttpApplication&nbsp;application,&nbsp;ServletContext&nbsp;servletContext)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.application&nbsp;=&nbsp;application;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.servletContext&nbsp;=&nbsp;servletContext;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;Starts&nbsp;the&nbsp;Http&nbsp;Application&nbsp;by&nbsp;getting&nbsp;the&nbsp;root&nbsp;{@link&nbsp;Handler}&nbsp;that&nbsp;will&nbsp;handle&nbsp;all&nbsp;HTTP&nbsp;Requests.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;This&nbsp;method&nbsp;also&nbsp;performs&nbsp;extra&nbsp;processing&nbsp;that&nbsp;is&nbsp;specific&nbsp;to&nbsp;the&nbsp;application&nbsp;being&nbsp;deployed&nbsp;in&nbsp;a&nbsp;Servlet<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;container.&nbsp;If&nbsp;the&nbsp;wrapped&nbsp;{@code&nbsp;HttpApplication}&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;{@link&nbsp;ServletHttpApplication}&nbsp;then<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;configured&nbsp;{@code&nbsp;Map}&nbsp;of&nbsp;static&nbsp;route&nbsp;handlers&nbsp;will&nbsp;be&nbsp;loaded.&nbsp;If&nbsp;the&nbsp;root&nbsp;{@code&nbsp;Handler}&nbsp;is&nbsp;an&nbsp;instance<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;of&nbsp;{@link&nbsp;UriRouter}&nbsp;then&nbsp;a&nbsp;default&nbsp;route&nbsp;will&nbsp;be&nbsp;set&nbsp;for&nbsp;the&nbsp;container&nbsp;to&nbsp;handler&nbsp;requests&nbsp;to&nbsp;static&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;using&nbsp;it's&nbsp;default&nbsp;Servlet&nbsp;and/or&nbsp;the&nbsp;{@code&nbsp;Map}&nbsp;of&nbsp;configured&nbsp;static&nbsp;route&nbsp;handlers.&amp;lt;/p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;HttpApplicationException&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Handler&nbsp;start()&nbsp;throws&nbsp;HttpApplicationException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;defaultServletName&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;Pattern,&nbsp;String&amp;gt;&nbsp;staticRouteServlets&nbsp;=&nbsp;Collections.emptyMap();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(application&nbsp;instanceof&nbsp;ServletHttpApplication)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServletHttpApplication&nbsp;servletApplication&nbsp;=&nbsp;(ServletHttpApplication)&nbsp;application;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultServletName&nbsp;=&nbsp;servletApplication.getDefaultServletName();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticRouteServlets&nbsp;=&nbsp;servletApplication.getStaticRouteServlets();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handler&nbsp;handler&nbsp;=&nbsp;application.start();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(handler&nbsp;instanceof&nbsp;UriRouter)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UriRouter&nbsp;router&nbsp;=&nbsp;(UriRouter)&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(router.getDefaultRoute()&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;router.setDefaultRoute(new&nbsp;DefaultRouteHandler(servletContext,&nbsp;defaultServletName,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticRouteServlets));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Factory&amp;lt;Buffer&amp;gt;&nbsp;getBufferFactory()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;application.getBufferFactory();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;stop()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application.stop();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletHttpApplicationWrapper.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletSessionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSession.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSession.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSession.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,200&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+import&nbsp;java.util.AbstractMap;<br>
+import&nbsp;java.util.AbstractSet;<br>
+import&nbsp;java.util.ArrayList;<br>
+import&nbsp;java.util.Enumeration;<br>
+import&nbsp;java.util.Iterator;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.NoSuchElementException;<br>
+import&nbsp;java.util.Set;<br>
+<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpSession;<br>
+<br>
+import&nbsp;org.forgerock.http.Response;<br>
+import&nbsp;org.forgerock.http.Session;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Exposes&nbsp;the&nbsp;session&nbsp;managed&nbsp;by&nbsp;the&nbsp;servlet&nbsp;container&nbsp;as&nbsp;an&nbsp;exchange&nbsp;session.<br>
+&nbsp;*&nbsp;This&nbsp;implementation&nbsp;will&nbsp;get&nbsp;a&nbsp;servlet&nbsp;session&nbsp;if&nbsp;already&nbsp;allocated,<br>
+&nbsp;*&nbsp;otherwise&nbsp;will&nbsp;not&nbsp;create&nbsp;one&nbsp;until&nbsp;an&nbsp;attempt&nbsp;is&nbsp;made&nbsp;to&nbsp;put&nbsp;an&nbsp;attribute&nbsp;in<br>
+&nbsp;*&nbsp;it.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+final&nbsp;class&nbsp;ServletSession&nbsp;extends&nbsp;AbstractMap&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;implements&nbsp;Session&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;servlet&nbsp;request&nbsp;from&nbsp;which&nbsp;to&nbsp;get&nbsp;a&nbsp;servlet&nbsp;session&nbsp;object.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;HttpServletRequest&nbsp;request;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;servlet&nbsp;session&nbsp;object,&nbsp;if&nbsp;available.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;volatile&nbsp;HttpSession&nbsp;httpSession;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**&nbsp;The&nbsp;Map&nbsp;entrySet&nbsp;view&nbsp;of&nbsp;the&nbsp;session&nbsp;attributes.&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Set&amp;lt;Entry&amp;lt;String,&nbsp;Object&amp;gt;&amp;gt;&nbsp;attributes&nbsp;=&nbsp;new&nbsp;AbstractSet&amp;lt;Entry&amp;lt;String,&nbsp;Object&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;clear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServletSession.this.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;contains(final&nbsp;Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(o&nbsp;instanceof&nbsp;Entry)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;ServletSession.this.containsKey(((Entry&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;o).getKey());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ServletSession.this.isEmpty();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Iterator&amp;lt;Entry&amp;lt;String,&nbsp;Object&amp;gt;&amp;gt;&nbsp;iterator()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Iterator&amp;lt;Entry&amp;lt;String,&nbsp;Object&amp;gt;&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Enumeration&amp;lt;String&amp;gt;&nbsp;names&nbsp;=&nbsp;httpSession&nbsp;!=&nbsp;null&nbsp;?&nbsp;httpSession<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getAttributeNames()&nbsp;:&nbsp;null;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;hasNext()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;names&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;names.hasMoreElements();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Entry&amp;lt;String,&nbsp;Object&amp;gt;&nbsp;next()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(names&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;NoSuchElementException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;name&nbsp;=&nbsp;names.nextElement();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;SimpleEntry&amp;lt;String,&nbsp;Object&amp;gt;(name,&nbsp;httpSession.getAttribute(name))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;long&nbsp;serialVersionUID&nbsp;=&nbsp;-2957899005221454275L;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object&nbsp;setValue(final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(getKey(),&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;super.setValue(value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;remove()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Enumerations&nbsp;do&nbsp;not&nbsp;support&nbsp;concurrent&nbsp;removals.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;UnsupportedOperationException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;remove(final&nbsp;Object&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(o&nbsp;instanceof&nbsp;Entry)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;ServletSession.this.remove(((Entry&amp;lt;?,&nbsp;?&amp;gt;)&nbsp;o).getKey())&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;size()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ServletSession.this.size();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;ServletSession(final&nbsp;HttpServletRequest&nbsp;request)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.request&nbsp;=&nbsp;request;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;get&nbsp;session&nbsp;if&nbsp;already&nbsp;allocated<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.httpSession&nbsp;=&nbsp;request.getSession(false);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;clear()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpSession&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Do&nbsp;in&nbsp;2&nbsp;steps&nbsp;to&nbsp;avoid&nbsp;CME.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Enumeration&amp;lt;String&amp;gt;&nbsp;attributes&nbsp;=&nbsp;httpSession.getAttributeNames();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;names&nbsp;=&nbsp;new&nbsp;ArrayList&amp;lt;String&amp;gt;();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(attributes.hasMoreElements())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names.add(attributes.nextElement());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;String&nbsp;name&nbsp;:&nbsp;names)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpSession.removeAttribute(name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;containsKey(final&nbsp;Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;get(key)&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Set&amp;lt;Entry&amp;lt;String,&nbsp;Object&amp;gt;&amp;gt;&nbsp;entrySet()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;attributes;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object&nbsp;get(final&nbsp;Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;value&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(key&nbsp;instanceof&nbsp;String&nbsp;&amp;amp;&amp;amp;&nbsp;httpSession&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;httpSession.getAttribute((String)&nbsp;key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;httpSession&nbsp;==&nbsp;null&nbsp;||&nbsp;!httpSession.getAttributeNames().hasMoreElements();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;synchronized&nbsp;Object&nbsp;put(final&nbsp;String&nbsp;key,&nbsp;final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Object&nbsp;old&nbsp;=&nbsp;get(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpSession&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;session&nbsp;just-in-time<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpSession&nbsp;=&nbsp;request.getSession(true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpSession.setAttribute(key,&nbsp;value);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;old;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object&nbsp;remove(final&nbsp;Object&nbsp;key)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Object&nbsp;old&nbsp;=&nbsp;get(key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(key&nbsp;instanceof&nbsp;String&nbsp;&amp;amp;&amp;amp;&nbsp;httpSession&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpSession.removeAttribute((String)&nbsp;key);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;old;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;size()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;size&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(httpSession&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Enumeration&amp;lt;?&amp;gt;&nbsp;attributes&nbsp;=&nbsp;httpSession.getAttributeNames();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(attributes.hasMoreElements())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attributes.nextElement();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size++;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;size;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;save(Response&nbsp;response)&nbsp;throws&nbsp;IOException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;when&nbsp;using&nbsp;HttpSession<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSession.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletSynchronizerjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSynchronizer.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSynchronizer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSynchronizer.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,69&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;interface&nbsp;for&nbsp;implementing&nbsp;different&nbsp;synchronization&nbsp;strategies&nbsp;depending<br>
+&nbsp;*&nbsp;on&nbsp;the&nbsp;available&nbsp;Servlet&nbsp;container&nbsp;version&nbsp;and/or&nbsp;capabilities.&nbsp;These&nbsp;include:<br>
+&nbsp;*&nbsp;&amp;lt;ul&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;2.5&nbsp;(JavaEE&nbsp;5)&nbsp;-&nbsp;synchronous&nbsp;processing&nbsp;and&nbsp;synchronous&nbsp;IO<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;3.0&nbsp;(JavaEE&nbsp;6)&nbsp;-&nbsp;asynchronous&nbsp;(non-blocking)&nbsp;processing&nbsp;and&nbsp;synchronous<br>
+&nbsp;*&nbsp;IO<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;3.1&nbsp;(JavaEE&nbsp;7)&nbsp;-&nbsp;asynchronous&nbsp;(non-blocking)&nbsp;processing&nbsp;and&nbsp;asynchronous<br>
+&nbsp;*&nbsp;IO&nbsp;(NIO)<br>
+&nbsp;*&nbsp;&amp;lt;/ul&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;ServletVersionAdapter#createServletSynchronizer(javax.servlet.http.HttpServletRequest,<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javax.servlet.http.HttpServletResponse)<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+interface&nbsp;ServletSynchronizer&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;this&nbsp;synchronizer&nbsp;is&nbsp;non-blocking&nbsp;then&nbsp;this&nbsp;method&nbsp;registers&nbsp;an<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@link&nbsp;javax.servlet.AsyncListener&nbsp;call-back}&nbsp;which&nbsp;will&nbsp;be&nbsp;invoked&nbsp;once<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;request&nbsp;has&nbsp;completed,&nbsp;failed,&nbsp;or&nbsp;timed&nbsp;out.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;should&nbsp;be&nbsp;used&nbsp;to&nbsp;register&nbsp;call-backs&nbsp;for&nbsp;releasing&nbsp;resources<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;after&nbsp;a&nbsp;request&nbsp;has&nbsp;been&nbsp;processed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Calls&nbsp;to&nbsp;this&nbsp;method&nbsp;when&nbsp;the&nbsp;synchronizer&nbsp;is&nbsp;blocking&nbsp;have&nbsp;no&nbsp;effect.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;runnable<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;call-back&nbsp;to&nbsp;be&nbsp;invoked&nbsp;once&nbsp;the&nbsp;request&nbsp;has&nbsp;completed,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failed,&nbsp;or&nbsp;timed&nbsp;out.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;setAsyncListener(Runnable&nbsp;runnable);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Waits&nbsp;for&nbsp;this&nbsp;synchronizer&nbsp;to&nbsp;be&nbsp;signalled&nbsp;but&nbsp;only&nbsp;if&nbsp;this&nbsp;synchronizer<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;a&nbsp;blocking&nbsp;implementation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;InterruptedException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;an&nbsp;unexpected&nbsp;error&nbsp;occurred&nbsp;while&nbsp;waiting&nbsp;to&nbsp;be<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signalled.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;awaitIfNeeded()&nbsp;throws&nbsp;InterruptedException;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Releases&nbsp;any&nbsp;waiting&nbsp;threads&nbsp;blocked&nbsp;on&nbsp;{@link&nbsp;#awaitIfNeeded()},&nbsp;as&nbsp;well<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;as&nbsp;completing&nbsp;the&nbsp;underlying&nbsp;{@link&nbsp;javax.servlet.AsyncContext<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;AsyncContext}&nbsp;if&nbsp;this&nbsp;synchronizer&nbsp;is&nbsp;non-blocking.&nbsp;This&nbsp;method&nbsp;should&nbsp;be<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;called&nbsp;after&nbsp;a&nbsp;writing&nbsp;out&nbsp;content&nbsp;and&nbsp;setting&nbsp;the&nbsp;response&nbsp;status.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;signalAndComplete();<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletSynchronizer.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletServletVersionAdapterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletVersionAdapter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletVersionAdapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletVersionAdapter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,43&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.servlet;<br>
+<br>
+import&nbsp;javax.servlet.http.HttpServletRequest;<br>
+import&nbsp;javax.servlet.http.HttpServletResponse;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;Servlet&nbsp;API&nbsp;version&nbsp;adapter&nbsp;provides&nbsp;an&nbsp;abstraction&nbsp;which&nbsp;allows&nbsp;Servlet<br>
+&nbsp;*&nbsp;and&nbsp;Filter&nbsp;implementations&nbsp;to&nbsp;interact&nbsp;with&nbsp;the&nbsp;Servlet&nbsp;container<br>
+&nbsp;*&nbsp;independently&nbsp;of&nbsp;the&nbsp;Servlet&nbsp;API&nbsp;version.&nbsp;At&nbsp;the&nbsp;moment&nbsp;the&nbsp;adapter&nbsp;only<br>
+&nbsp;*&nbsp;provides&nbsp;an&nbsp;abstraction&nbsp;for&nbsp;performing&nbsp;asynchronous&nbsp;processing,&nbsp;but&nbsp;other&nbsp;API<br>
+&nbsp;*&nbsp;features&nbsp;could&nbsp;be&nbsp;added&nbsp;in&nbsp;future&nbsp;(such&nbsp;as&nbsp;async&nbsp;IO).<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+interface&nbsp;ServletVersionAdapter&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;synchronizer&nbsp;appropriate&nbsp;for&nbsp;the&nbsp;provided&nbsp;HTTP&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;httpRequest<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;httpResponse<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;response.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;Returns&nbsp;a&nbsp;new&nbsp;synchronizer&nbsp;appropriate&nbsp;for&nbsp;the&nbsp;HTTP&nbsp;request.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;ServletSynchronizer&nbsp;createServletSynchronizer(HttpServletRequest&nbsp;httpRequest,&nbsp;HttpServletResponse&nbsp;httpResponse);<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/ServletVersionAdapter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainjavaorgforgerockhttpservletpackageinfojava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/package-info.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/package-info.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,23&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;*&nbsp;Portions&nbsp;Copyright&nbsp;2011-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Integrates&nbsp;with&nbsp;the&nbsp;Java&nbsp;Enterprise&nbsp;Edition&nbsp;Servlet&nbsp;API.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+package&nbsp;org.forgerock.http.servlet;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;\&nbsp;No&nbsp;newline&nbsp;at&nbsp;end&nbsp;of&nbsp;file<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/java/org/forgerock/http/servlet/package-info.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainresourcesMETAINFwebfragmentxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/web-fragment.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/web-fragment.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/web-fragment.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,16&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;web-fragment&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlns=&amp;quot;http://java.sun.com/xml/ns/javaee&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlns:web=&amp;quot;http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlns:webfragment=&amp;quot;http://java.sun.com/xml/ns/javaee/web-fragment_3_0.xsd&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://java.sun.com/xml/ns/javaee&nbsp;http://java.sun.com/xml/ns/javaee/web-fragment_3_0.xsd&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id=&amp;quot;WebFragment_ID&amp;quot;&nbsp;version=&amp;quot;3.0&amp;quot;&amp;gt;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;!--&amp;lt;name&amp;gt;HttpSerlvetFramework&amp;lt;/name&amp;gt;--&amp;gt;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;!--&amp;lt;servlet&amp;gt;--&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;!--&amp;lt;servlet-name&amp;gt;HttpFrameworkServlet&amp;lt;/servlet-name&amp;gt;--&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;!--&amp;lt;servlet-class&amp;gt;org.forgerock.http.servlet.HttpFrameworkServlet&amp;lt;/servlet-class&amp;gt;--&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;!--&amp;lt;/servlet&amp;gt;--&amp;gt;<br>
+<br>
+&amp;lt;/web-fragment&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;\&nbsp;No&nbsp;newline&nbsp;at&nbsp;end&nbsp;of&nbsp;file<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/resources/META-INF/web-fragment.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFglassfishwebxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/glassfish-web.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/glassfish-web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/glassfish-web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,5&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;!DOCTYPE&nbsp;glassfish-web-app&nbsp;PUBLIC&nbsp;&amp;quot;-//GlassFish.org//DTD<br>
+GlassFish&nbsp;Application&nbsp;Server&nbsp;3.1&nbsp;Servlet&nbsp;3.0//EN&amp;quot;&nbsp;&amp;quot;http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd&amp;quot;&amp;gt;<br>
+&amp;lt;glassfish-web-app&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;class-loader&nbsp;delegate=&amp;quot;false&amp;quot;/&amp;gt;<br>
+&amp;lt;/glassfish-web-app&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;\&nbsp;No&nbsp;newline&nbsp;at&nbsp;end&nbsp;of&nbsp;file<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/glassfish-web.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFsunwebxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/sun-web.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/sun-web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/sun-web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,7&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!DOCTYPE&nbsp;sun-web-app&nbsp;PUBLIC<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;-//Sun&nbsp;Microsystems,&nbsp;Inc.//DTD&nbsp;Application&nbsp;Server&nbsp;9.0&nbsp;Servlet&nbsp;2.5//EN&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;http://www.sun.com/software/appserver/dtds/sun-web-app_2_5-0.dtd&amp;quot;&amp;gt;<br>
+&amp;lt;sun-web-app&nbsp;error-url=&amp;quot;&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;class-loader&nbsp;delegate=&amp;quot;false&amp;quot;/&amp;gt;<br>
+&amp;lt;/sun-web-app&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;\&nbsp;No&nbsp;newline&nbsp;at&nbsp;end&nbsp;of&nbsp;file<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/sun-web.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttpservletsrcmainwebappWEBINFwebxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/web.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/web.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,19&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;web-app&nbsp;xmlns=&amp;quot;http://java.sun.com/xml/ns/javaee&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://java.sun.com/xml/ns/javaee&nbsp;http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version=&amp;quot;2.5&amp;quot;&amp;gt;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;display-name&amp;gt;Http&nbsp;Servlet&amp;lt;/display-name&amp;gt;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;servlet&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;servlet-name&amp;gt;HttpServlet&amp;lt;/servlet-name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;servlet-class&amp;gt;org.forgerock.http.servlet.HttpFrameworkServlet&amp;lt;/servlet-class&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;async-supported&amp;gt;true&amp;lt;/async-supported&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/servlet&amp;gt;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;servlet-mapping&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;servlet-name&amp;gt;HttpServlet&amp;lt;/servlet-name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url-pattern&amp;gt;/*&amp;lt;/url-pattern&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/servlet-mapping&amp;gt;<br>
+<br>
+&amp;lt;/web-app&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-servlet/src/main/webapp/WEB-INF/web.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttptest&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;propset&quot;&gt;&lt;h4&gt;Property&nbsp;changes:&nbsp;forgerock-http-framework/trunk/http-test&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svnignore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:ignore&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttptestpomxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-test/pom.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-test/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-test/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,35&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2014-2015&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;project&nbsp;xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;parent&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-http-framework&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/parent&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;http-test&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;packaging&amp;gt;jar&amp;lt;/packaging&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;name&amp;gt;HTTP&nbsp;Test&nbsp;library&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;dependencies&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;http-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;${project.version}&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/dependencies&amp;gt;<br>
+&amp;lt;/project&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-test/pom.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkhttptestsrcmainjavaorgforgerockhttptestHttpTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/HttpTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/HttpTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/HttpTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,28&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.http.test;<br>
+<br>
+import&nbsp;java.net.URI;<br>
+<br>
+import&nbsp;org.forgerock.http.Request;<br>
+<br>
+public&nbsp;final&nbsp;class&nbsp;HttpTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;Request&nbsp;newRequest()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Request().setUri(URI.create(&amp;quot;&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/http-test/src/main/java/org/forgerock/http/test/HttpTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunklegalCCBYNCNDtxt&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/legal/CC-BY-NC-ND.txt&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/legal/CC-BY-NC-ND.txt&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/legal/CC-BY-NC-ND.txt&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,296&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+Attribution-NonCommercial-NoDerivs&nbsp;3.0&nbsp;Unported<br>
+<br>
+CREATIVE&nbsp;COMMONS&nbsp;CORPORATION&nbsp;IS&nbsp;NOT&nbsp;A&nbsp;LAW&nbsp;FIRM&nbsp;AND&nbsp;DOES&nbsp;NOT&nbsp;PROVIDE&nbsp;LEGAL<br>
+SERVICES.&nbsp;DISTRIBUTION&nbsp;OF&nbsp;THIS&nbsp;LICENSE&nbsp;DOES&nbsp;NOT&nbsp;CREATE&nbsp;AN&nbsp;ATTORNEY-CLIENT<br>
+RELATIONSHIP.&nbsp;CREATIVE&nbsp;COMMONS&nbsp;PROVIDES&nbsp;THIS&nbsp;INFORMATION&nbsp;ON&nbsp;AN&nbsp;&amp;quot;AS-IS&amp;quot;&nbsp;BASIS.<br>
+CREATIVE&nbsp;COMMONS&nbsp;MAKES&nbsp;NO&nbsp;WARRANTIES&nbsp;REGARDING&nbsp;THE&nbsp;INFORMATION&nbsp;PROVIDED,&nbsp;AND<br>
+DISCLAIMS&nbsp;LIABILITY&nbsp;FOR&nbsp;DAMAGES&nbsp;RESULTING&nbsp;FROM&nbsp;ITS&nbsp;USE.<br>
+<br>
+License<br>
+THE&nbsp;WORK&nbsp;(AS&nbsp;DEFINED&nbsp;BELOW)&nbsp;IS&nbsp;PROVIDED&nbsp;UNDER&nbsp;THE&nbsp;TERMS&nbsp;OF&nbsp;THIS&nbsp;CREATIVE<br>
+COMMONS&nbsp;PUBLIC&nbsp;LICENSE&nbsp;(&amp;quot;CCPL&amp;quot;&nbsp;OR&nbsp;&amp;quot;LICENSE&amp;quot;).&nbsp;THE&nbsp;WORK&nbsp;IS&nbsp;PROTECTED&nbsp;BY<br>
+COPYRIGHT&nbsp;AND/OR&nbsp;OTHER&nbsp;APPLICABLE&nbsp;LAW.&nbsp;ANY&nbsp;USE&nbsp;OF&nbsp;THE&nbsp;WORK&nbsp;OTHER&nbsp;THAN&nbsp;AS<br>
+AUTHORIZED&nbsp;UNDER&nbsp;THIS&nbsp;LICENSE&nbsp;OR&nbsp;COPYRIGHT&nbsp;LAW&nbsp;IS&nbsp;PROHIBITED.<br>
+<br>
+BY&nbsp;EXERCISING&nbsp;ANY&nbsp;RIGHTS&nbsp;TO&nbsp;THE&nbsp;WORK&nbsp;PROVIDED&nbsp;HERE,&nbsp;YOU&nbsp;ACCEPT&nbsp;AND&nbsp;AGREE&nbsp;TO<br>
+BE&nbsp;BOUND&nbsp;BY&nbsp;THE&nbsp;TERMS&nbsp;OF&nbsp;THIS&nbsp;LICENSE.&nbsp;TO&nbsp;THE&nbsp;EXTENT&nbsp;THIS&nbsp;LICENSE&nbsp;MAY&nbsp;BE<br>
+CONSIDERED&nbsp;TO&nbsp;BE&nbsp;A&nbsp;CONTRACT,&nbsp;THE&nbsp;LICENSOR&nbsp;GRANTS&nbsp;YOU&nbsp;THE&nbsp;RIGHTS&nbsp;CONTAINED<br>
+HERE&nbsp;IN&nbsp;CONSIDERATION&nbsp;OF&nbsp;YOUR&nbsp;ACCEPTANCE&nbsp;OF&nbsp;SUCH&nbsp;TERMS&nbsp;AND&nbsp;CONDITIONS.<br>
+<br>
+1.&nbsp;Definitions<br>
+<br>
+&nbsp;a.&nbsp;&amp;quot;Adaptation&amp;quot;&nbsp;means&nbsp;a&nbsp;work&nbsp;based&nbsp;upon&nbsp;the&nbsp;Work,&nbsp;or&nbsp;upon&nbsp;the&nbsp;Work&nbsp;and&nbsp;other<br>
+&nbsp;pre-existing&nbsp;works,&nbsp;such&nbsp;as&nbsp;a&nbsp;translation,&nbsp;adaptation,&nbsp;derivative&nbsp;work,<br>
+&nbsp;arrangement&nbsp;of&nbsp;music&nbsp;or&nbsp;other&nbsp;alterations&nbsp;of&nbsp;a&nbsp;literary&nbsp;or&nbsp;artistic&nbsp;work,<br>
+&nbsp;or&nbsp;phonogram&nbsp;or&nbsp;performance&nbsp;and&nbsp;includes&nbsp;cinematographic&nbsp;adaptations&nbsp;or&nbsp;any<br>
+&nbsp;other&nbsp;form&nbsp;in&nbsp;which&nbsp;the&nbsp;Work&nbsp;may&nbsp;be&nbsp;recast,&nbsp;transformed,&nbsp;or&nbsp;adapted&nbsp;including<br>
+&nbsp;in&nbsp;any&nbsp;form&nbsp;recognizably&nbsp;derived&nbsp;from&nbsp;the&nbsp;original,&nbsp;except&nbsp;that&nbsp;a&nbsp;work&nbsp;that<br>
+&nbsp;constitutes&nbsp;a&nbsp;Collection&nbsp;will&nbsp;not&nbsp;be&nbsp;considered&nbsp;an&nbsp;Adaptation&nbsp;for&nbsp;the&nbsp;purpose<br>
+&nbsp;of&nbsp;this&nbsp;License.&nbsp;For&nbsp;the&nbsp;avoidance&nbsp;of&nbsp;doubt,&nbsp;where&nbsp;the&nbsp;Work&nbsp;is&nbsp;a&nbsp;musical&nbsp;work,<br>
+&nbsp;performance&nbsp;or&nbsp;phonogram,&nbsp;the&nbsp;synchronization&nbsp;of&nbsp;the&nbsp;Work&nbsp;in&nbsp;timed-relation<br>
+&nbsp;with&nbsp;a&nbsp;moving&nbsp;image&nbsp;(&amp;quot;synching&amp;quot;)&nbsp;will&nbsp;be&nbsp;considered&nbsp;an&nbsp;Adaptation&nbsp;for&nbsp;the<br>
+&nbsp;purpose&nbsp;of&nbsp;this&nbsp;License.<br>
+&nbsp;<br>
+&nbsp;b.&nbsp;&amp;quot;Collection&amp;quot;&nbsp;means&nbsp;a&nbsp;collection&nbsp;of&nbsp;literary&nbsp;or&nbsp;artistic&nbsp;works,&nbsp;such&nbsp;as<br>
+&nbsp;encyclopedias&nbsp;and&nbsp;anthologies,&nbsp;or&nbsp;performances,&nbsp;phonograms&nbsp;or&nbsp;broadcasts,<br>
+&nbsp;or&nbsp;other&nbsp;works&nbsp;or&nbsp;subject&nbsp;matter&nbsp;other&nbsp;than&nbsp;works&nbsp;listed&nbsp;in&nbsp;Section&nbsp;1(f)<br>
+&nbsp;below,&nbsp;which,&nbsp;by&nbsp;reason&nbsp;of&nbsp;the&nbsp;selection&nbsp;and&nbsp;arrangement&nbsp;of&nbsp;their&nbsp;contents,<br>
+&nbsp;constitute&nbsp;intellectual&nbsp;creations,&nbsp;in&nbsp;which&nbsp;the&nbsp;Work&nbsp;is&nbsp;included&nbsp;in&nbsp;its<br>
+&nbsp;entirety&nbsp;in&nbsp;unmodified&nbsp;form&nbsp;along&nbsp;with&nbsp;one&nbsp;or&nbsp;more&nbsp;other&nbsp;contributions,<br>
+&nbsp;each&nbsp;constituting&nbsp;separate&nbsp;and&nbsp;independent&nbsp;works&nbsp;in&nbsp;themselves,&nbsp;which<br>
+&nbsp;together&nbsp;are&nbsp;assembled&nbsp;into&nbsp;a&nbsp;collective&nbsp;whole.&nbsp;A&nbsp;work&nbsp;that&nbsp;constitutes&nbsp;a<br>
+&nbsp;Collection&nbsp;will&nbsp;not&nbsp;be&nbsp;considered&nbsp;an&nbsp;Adaptation&nbsp;(as&nbsp;defined&nbsp;above)&nbsp;for&nbsp;the<br>
+&nbsp;purposes&nbsp;of&nbsp;this&nbsp;License.<br>
+&nbsp;<br>
+&nbsp;c.&nbsp;&amp;quot;Distribute&amp;quot;&nbsp;means&nbsp;to&nbsp;make&nbsp;available&nbsp;to&nbsp;the&nbsp;public&nbsp;the&nbsp;original&nbsp;and<br>
+&nbsp;copies&nbsp;of&nbsp;the&nbsp;Work&nbsp;through&nbsp;sale&nbsp;or&nbsp;other&nbsp;transfer&nbsp;of&nbsp;ownership.<br>
+&nbsp;<br>
+&nbsp;d.&nbsp;&amp;quot;Licensor&amp;quot;&nbsp;means&nbsp;the&nbsp;individual,&nbsp;individuals,&nbsp;entity&nbsp;or&nbsp;entities&nbsp;that<br>
+&nbsp;offer(s)&nbsp;the&nbsp;Work&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.<br>
+&nbsp;<br>
+&nbsp;e.&nbsp;&amp;quot;Original&nbsp;Author&amp;quot;&nbsp;means,&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;literary&nbsp;or&nbsp;artistic&nbsp;work,&nbsp;the<br>
+&nbsp;individual,&nbsp;individuals,&nbsp;entity&nbsp;or&nbsp;entities&nbsp;who&nbsp;created&nbsp;the&nbsp;Work&nbsp;or&nbsp;if&nbsp;no<br>
+&nbsp;individual&nbsp;or&nbsp;entity&nbsp;can&nbsp;be&nbsp;identified,&nbsp;the&nbsp;publisher;&nbsp;and&nbsp;in&nbsp;addition&nbsp;(i)<br>
+&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;performance&nbsp;the&nbsp;actors,&nbsp;singers,&nbsp;musicians,&nbsp;dancers,&nbsp;and<br>
+&nbsp;other&nbsp;persons&nbsp;who&nbsp;act,&nbsp;sing,&nbsp;deliver,&nbsp;declaim,&nbsp;play&nbsp;in,&nbsp;interpret&nbsp;or&nbsp;otherwise<br>
+&nbsp;perform&nbsp;literary&nbsp;or&nbsp;artistic&nbsp;works&nbsp;or&nbsp;expressions&nbsp;of&nbsp;folklore;&nbsp;(ii)&nbsp;in&nbsp;the<br>
+&nbsp;case&nbsp;of&nbsp;a&nbsp;phonogram&nbsp;the&nbsp;producer&nbsp;being&nbsp;the&nbsp;person&nbsp;or&nbsp;legal&nbsp;entity&nbsp;who&nbsp;first<br>
+&nbsp;fixes&nbsp;the&nbsp;sounds&nbsp;of&nbsp;a&nbsp;performance&nbsp;or&nbsp;other&nbsp;sounds;&nbsp;and,&nbsp;(iii)&nbsp;in&nbsp;the&nbsp;case&nbsp;of<br>
+&nbsp;broadcasts,&nbsp;the&nbsp;organization&nbsp;that&nbsp;transmits&nbsp;the&nbsp;broadcast.<br>
+&nbsp;<br>
+&nbsp;f.&nbsp;&amp;quot;Work&amp;quot;&nbsp;means&nbsp;the&nbsp;literary&nbsp;and/or&nbsp;artistic&nbsp;work&nbsp;offered&nbsp;under&nbsp;the&nbsp;terms&nbsp;of<br>
+&nbsp;this&nbsp;License&nbsp;including&nbsp;without&nbsp;limitation&nbsp;any&nbsp;production&nbsp;in&nbsp;the&nbsp;literary,<br>
+&nbsp;scientific&nbsp;and&nbsp;artistic&nbsp;domain,&nbsp;whatever&nbsp;may&nbsp;be&nbsp;the&nbsp;mode&nbsp;or&nbsp;form&nbsp;of&nbsp;its<br>
+&nbsp;expression&nbsp;including&nbsp;digital&nbsp;form,&nbsp;such&nbsp;as&nbsp;a&nbsp;book,&nbsp;pamphlet&nbsp;and&nbsp;other&nbsp;writing;<br>
+&nbsp;a&nbsp;lecture,&nbsp;address,&nbsp;sermon&nbsp;or&nbsp;other&nbsp;work&nbsp;of&nbsp;the&nbsp;same&nbsp;nature;&nbsp;a&nbsp;dramatic&nbsp;or<br>
+&nbsp;dramatico-musical&nbsp;work;&nbsp;a&nbsp;choreographic&nbsp;work&nbsp;or&nbsp;entertainment&nbsp;in&nbsp;dumb&nbsp;show;<br>
+&nbsp;a&nbsp;musical&nbsp;composition&nbsp;with&nbsp;or&nbsp;without&nbsp;words;&nbsp;a&nbsp;cinematographic&nbsp;work&nbsp;to&nbsp;which<br>
+&nbsp;are&nbsp;assimilated&nbsp;works&nbsp;expressed&nbsp;by&nbsp;a&nbsp;process&nbsp;analogous&nbsp;to&nbsp;cinematography;&nbsp;a<br>
+&nbsp;work&nbsp;of&nbsp;drawing,&nbsp;painting,&nbsp;architecture,&nbsp;sculpture,&nbsp;engraving&nbsp;or&nbsp;lithography;<br>
+&nbsp;a&nbsp;photographic&nbsp;work&nbsp;to&nbsp;which&nbsp;are&nbsp;assimilated&nbsp;works&nbsp;expressed&nbsp;by&nbsp;a&nbsp;process<br>
+&nbsp;analogous&nbsp;to&nbsp;photography;&nbsp;a&nbsp;work&nbsp;of&nbsp;applied&nbsp;art;&nbsp;an&nbsp;illustration,&nbsp;map,&nbsp;plan,<br>
+&nbsp;sketch&nbsp;or&nbsp;three-dimensional&nbsp;work&nbsp;relative&nbsp;to&nbsp;geography,&nbsp;topography,<br>
+&nbsp;architecture&nbsp;or&nbsp;science;&nbsp;a&nbsp;performance;&nbsp;a&nbsp;broadcast;&nbsp;a&nbsp;phonogram;&nbsp;a<br>
+&nbsp;compilation&nbsp;of&nbsp;data&nbsp;to&nbsp;the&nbsp;extent&nbsp;it&nbsp;is&nbsp;protected&nbsp;as&nbsp;a&nbsp;copyrightable&nbsp;work;<br>
+&nbsp;or&nbsp;a&nbsp;work&nbsp;performed&nbsp;by&nbsp;a&nbsp;variety&nbsp;or&nbsp;circus&nbsp;performer&nbsp;to&nbsp;the&nbsp;extent&nbsp;it&nbsp;is<br>
+&nbsp;not&nbsp;otherwise&nbsp;considered&nbsp;a&nbsp;literary&nbsp;or&nbsp;artistic&nbsp;work.<br>
+&nbsp;<br>
+&nbsp;g.&nbsp;&amp;quot;You&amp;quot;&nbsp;means&nbsp;an&nbsp;individual&nbsp;or&nbsp;entity&nbsp;exercising&nbsp;rights&nbsp;under&nbsp;this&nbsp;License<br>
+&nbsp;who&nbsp;has&nbsp;not&nbsp;previously&nbsp;violated&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License&nbsp;with&nbsp;respect&nbsp;to&nbsp;the<br>
+&nbsp;Work,&nbsp;or&nbsp;who&nbsp;has&nbsp;received&nbsp;express&nbsp;permission&nbsp;from&nbsp;the&nbsp;Licensor&nbsp;to&nbsp;exercise<br>
+&nbsp;rights&nbsp;under&nbsp;this&nbsp;License&nbsp;despite&nbsp;a&nbsp;previous&nbsp;violation.<br>
+&nbsp;<br>
+&nbsp;h.&nbsp;&amp;quot;Publicly&nbsp;Perform&amp;quot;&nbsp;means&nbsp;to&nbsp;perform&nbsp;public&nbsp;recitations&nbsp;of&nbsp;the&nbsp;Work&nbsp;and&nbsp;to<br>
+&nbsp;communicate&nbsp;to&nbsp;the&nbsp;public&nbsp;those&nbsp;public&nbsp;recitations,&nbsp;by&nbsp;any&nbsp;means&nbsp;or&nbsp;process,<br>
+&nbsp;including&nbsp;by&nbsp;wire&nbsp;or&nbsp;wireless&nbsp;means&nbsp;or&nbsp;public&nbsp;digital&nbsp;performances;&nbsp;to&nbsp;make<br>
+&nbsp;available&nbsp;to&nbsp;the&nbsp;public&nbsp;Works&nbsp;in&nbsp;such&nbsp;a&nbsp;way&nbsp;that&nbsp;members&nbsp;of&nbsp;the&nbsp;public&nbsp;may<br>
+&nbsp;access&nbsp;these&nbsp;Works&nbsp;from&nbsp;a&nbsp;place&nbsp;and&nbsp;at&nbsp;a&nbsp;place&nbsp;individually&nbsp;chosen&nbsp;by&nbsp;them;<br>
+&nbsp;to&nbsp;perform&nbsp;the&nbsp;Work&nbsp;to&nbsp;the&nbsp;public&nbsp;by&nbsp;any&nbsp;means&nbsp;or&nbsp;process&nbsp;and&nbsp;the<br>
+&nbsp;communication&nbsp;to&nbsp;the&nbsp;public&nbsp;of&nbsp;the&nbsp;performances&nbsp;of&nbsp;the&nbsp;Work,&nbsp;including&nbsp;by<br>
+&nbsp;public&nbsp;digital&nbsp;performance;&nbsp;to&nbsp;broadcast&nbsp;and&nbsp;rebroadcast&nbsp;the&nbsp;Work&nbsp;by&nbsp;any<br>
+&nbsp;means&nbsp;including&nbsp;signs,&nbsp;sounds&nbsp;or&nbsp;images.<br>
+&nbsp;<br>
+&nbsp;i.&nbsp;&amp;quot;Reproduce&amp;quot;&nbsp;means&nbsp;to&nbsp;make&nbsp;copies&nbsp;of&nbsp;the&nbsp;Work&nbsp;by&nbsp;any&nbsp;means&nbsp;including&nbsp;without<br>
+&nbsp;limitation&nbsp;by&nbsp;sound&nbsp;or&nbsp;visual&nbsp;recordings&nbsp;and&nbsp;the&nbsp;right&nbsp;of&nbsp;fixation&nbsp;and<br>
+&nbsp;reproducing&nbsp;fixations&nbsp;of&nbsp;the&nbsp;Work,&nbsp;including&nbsp;storage&nbsp;of&nbsp;a&nbsp;protected<br>
+&nbsp;performance&nbsp;or&nbsp;phonogram&nbsp;in&nbsp;digital&nbsp;form&nbsp;or&nbsp;other&nbsp;electronic&nbsp;medium.<br>
+&nbsp;<br>
+2.&nbsp;Fair&nbsp;Dealing&nbsp;Rights.&nbsp;Nothing&nbsp;in&nbsp;this&nbsp;License&nbsp;is&nbsp;intended&nbsp;to&nbsp;reduce,&nbsp;limit,<br>
+or&nbsp;restrict&nbsp;any&nbsp;uses&nbsp;free&nbsp;from&nbsp;copyright&nbsp;or&nbsp;rights&nbsp;arising&nbsp;from&nbsp;limitations&nbsp;or<br>
+exceptions&nbsp;that&nbsp;are&nbsp;provided&nbsp;for&nbsp;in&nbsp;connection&nbsp;with&nbsp;the&nbsp;copyright&nbsp;protection<br>
+under&nbsp;copyright&nbsp;law&nbsp;or&nbsp;other&nbsp;applicable&nbsp;laws.<br>
+<br>
+3.&nbsp;License&nbsp;Grant.&nbsp;Subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;of&nbsp;this&nbsp;License,&nbsp;Licensor<br>
+hereby&nbsp;grants&nbsp;You&nbsp;a&nbsp;worldwide,&nbsp;royalty-free,&nbsp;non-exclusive,&nbsp;perpetual&nbsp;(for&nbsp;the<br>
+duration&nbsp;of&nbsp;the&nbsp;applicable&nbsp;copyright)&nbsp;license&nbsp;to&nbsp;exercise&nbsp;the&nbsp;rights&nbsp;in&nbsp;the<br>
+Work&nbsp;as&nbsp;stated&nbsp;below:<br>
+<br>
+&nbsp;a.&nbsp;to&nbsp;Reproduce&nbsp;the&nbsp;Work,&nbsp;to&nbsp;incorporate&nbsp;the&nbsp;Work&nbsp;into&nbsp;one&nbsp;or&nbsp;more<br>
+&nbsp;Collections,&nbsp;and&nbsp;to&nbsp;Reproduce&nbsp;the&nbsp;Work&nbsp;as&nbsp;incorporated&nbsp;in&nbsp;the&nbsp;Collections;&nbsp;and,<br>
+&nbsp;<br>
+&nbsp;b.&nbsp;to&nbsp;Distribute&nbsp;and&nbsp;Publicly&nbsp;Perform&nbsp;the&nbsp;Work&nbsp;including&nbsp;as&nbsp;incorporated&nbsp;in<br>
+&nbsp;Collections.<br>
+&nbsp;<br>
+The&nbsp;above&nbsp;rights&nbsp;may&nbsp;be&nbsp;exercised&nbsp;in&nbsp;all&nbsp;media&nbsp;and&nbsp;formats&nbsp;whether&nbsp;now&nbsp;known&nbsp;or<br>
+hereafter&nbsp;devised.&nbsp;The&nbsp;above&nbsp;rights&nbsp;include&nbsp;the&nbsp;right&nbsp;to&nbsp;make&nbsp;such<br>
+modifications&nbsp;as&nbsp;are&nbsp;technically&nbsp;necessary&nbsp;to&nbsp;exercise&nbsp;the&nbsp;rights&nbsp;in&nbsp;other<br>
+media&nbsp;and&nbsp;formats,&nbsp;but&nbsp;otherwise&nbsp;you&nbsp;have&nbsp;no&nbsp;rights&nbsp;to&nbsp;make&nbsp;Adaptations.<br>
+Subject&nbsp;to&nbsp;8(f),&nbsp;all&nbsp;rights&nbsp;not&nbsp;expressly&nbsp;granted&nbsp;by&nbsp;Licensor&nbsp;are&nbsp;hereby<br>
+reserved,&nbsp;including&nbsp;but&nbsp;not&nbsp;limited&nbsp;to&nbsp;the&nbsp;rights&nbsp;set&nbsp;forth&nbsp;in&nbsp;Section&nbsp;4(d).<br>
+<br>
+4.&nbsp;Restrictions.&nbsp;The&nbsp;license&nbsp;granted&nbsp;in&nbsp;Section&nbsp;3&nbsp;above&nbsp;is&nbsp;expressly&nbsp;made<br>
+subject&nbsp;to&nbsp;and&nbsp;limited&nbsp;by&nbsp;the&nbsp;following&nbsp;restrictions:<br>
+<br>
+&nbsp;a.&nbsp;You&nbsp;may&nbsp;Distribute&nbsp;or&nbsp;Publicly&nbsp;Perform&nbsp;the&nbsp;Work&nbsp;only&nbsp;under&nbsp;the&nbsp;terms&nbsp;of<br>
+&nbsp;this&nbsp;License.&nbsp;You&nbsp;must&nbsp;include&nbsp;a&nbsp;copy&nbsp;of,&nbsp;or&nbsp;the&nbsp;Uniform&nbsp;Resource&nbsp;Identifier<br>
+&nbsp;(URI)&nbsp;for,&nbsp;this&nbsp;License&nbsp;with&nbsp;every&nbsp;copy&nbsp;of&nbsp;the&nbsp;Work&nbsp;You&nbsp;Distribute&nbsp;or&nbsp;Publicly<br>
+&nbsp;Perform.&nbsp;You&nbsp;may&nbsp;not&nbsp;offer&nbsp;or&nbsp;impose&nbsp;any&nbsp;terms&nbsp;on&nbsp;the&nbsp;Work&nbsp;that&nbsp;restrict&nbsp;the<br>
+&nbsp;terms&nbsp;of&nbsp;this&nbsp;License&nbsp;or&nbsp;the&nbsp;ability&nbsp;of&nbsp;the&nbsp;recipient&nbsp;of&nbsp;the&nbsp;Work&nbsp;to&nbsp;exercise<br>
+&nbsp;the&nbsp;rights&nbsp;granted&nbsp;to&nbsp;that&nbsp;recipient&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;License.&nbsp;You&nbsp;may<br>
+&nbsp;not&nbsp;sublicense&nbsp;the&nbsp;Work.&nbsp;You&nbsp;must&nbsp;keep&nbsp;intact&nbsp;all&nbsp;notices&nbsp;that&nbsp;refer&nbsp;to&nbsp;this<br>
+&nbsp;License&nbsp;and&nbsp;to&nbsp;the&nbsp;disclaimer&nbsp;of&nbsp;warranties&nbsp;with&nbsp;every&nbsp;copy&nbsp;of&nbsp;the&nbsp;Work&nbsp;You<br>
+&nbsp;Distribute&nbsp;or&nbsp;Publicly&nbsp;Perform.&nbsp;When&nbsp;You&nbsp;Distribute&nbsp;or&nbsp;Publicly&nbsp;Perform&nbsp;the<br>
+&nbsp;Work,&nbsp;You&nbsp;may&nbsp;not&nbsp;impose&nbsp;any&nbsp;effective&nbsp;technological&nbsp;measures&nbsp;on&nbsp;the&nbsp;Work&nbsp;that<br>
+&nbsp;restrict&nbsp;the&nbsp;ability&nbsp;of&nbsp;a&nbsp;recipient&nbsp;of&nbsp;the&nbsp;Work&nbsp;from&nbsp;You&nbsp;to&nbsp;exercise&nbsp;the<br>
+&nbsp;rights&nbsp;granted&nbsp;to&nbsp;that&nbsp;recipient&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;License.&nbsp;This&nbsp;Section<br>
+&nbsp;4(a)&nbsp;applies&nbsp;to&nbsp;the&nbsp;Work&nbsp;as&nbsp;incorporated&nbsp;in&nbsp;a&nbsp;Collection,&nbsp;but&nbsp;this&nbsp;does&nbsp;not<br>
+&nbsp;require&nbsp;the&nbsp;Collection&nbsp;apart&nbsp;from&nbsp;the&nbsp;Work&nbsp;itself&nbsp;to&nbsp;be&nbsp;made&nbsp;subject&nbsp;to&nbsp;the<br>
+&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;If&nbsp;You&nbsp;create&nbsp;a&nbsp;Collection,&nbsp;upon&nbsp;notice&nbsp;from&nbsp;any<br>
+&nbsp;Licensor&nbsp;You&nbsp;must,&nbsp;to&nbsp;the&nbsp;extent&nbsp;practicable,&nbsp;remove&nbsp;from&nbsp;the&nbsp;Collection<br>
+&nbsp;any&nbsp;credit&nbsp;as&nbsp;required&nbsp;by&nbsp;Section&nbsp;4(c),&nbsp;as&nbsp;requested.<br>
+&nbsp;<br>
+&nbsp;b.&nbsp;You&nbsp;may&nbsp;not&nbsp;exercise&nbsp;any&nbsp;of&nbsp;the&nbsp;rights&nbsp;granted&nbsp;to&nbsp;You&nbsp;in&nbsp;Section&nbsp;3&nbsp;above<br>
+&nbsp;in&nbsp;any&nbsp;manner&nbsp;that&nbsp;is&nbsp;primarily&nbsp;intended&nbsp;for&nbsp;or&nbsp;directed&nbsp;toward&nbsp;commercial<br>
+&nbsp;advantage&nbsp;or&nbsp;private&nbsp;monetary&nbsp;compensation.&nbsp;The&nbsp;exchange&nbsp;of&nbsp;the&nbsp;Work&nbsp;for<br>
+&nbsp;other&nbsp;copyrighted&nbsp;works&nbsp;by&nbsp;means&nbsp;of&nbsp;digital&nbsp;file-sharing&nbsp;or&nbsp;otherwise&nbsp;shall<br>
+&nbsp;not&nbsp;be&nbsp;considered&nbsp;to&nbsp;be&nbsp;intended&nbsp;for&nbsp;or&nbsp;directed&nbsp;toward&nbsp;commercial&nbsp;advantage<br>
+&nbsp;or&nbsp;private&nbsp;monetary&nbsp;compensation,&nbsp;provided&nbsp;there&nbsp;is&nbsp;no&nbsp;payment&nbsp;of&nbsp;any&nbsp;monetary<br>
+&nbsp;compensation&nbsp;in&nbsp;connection&nbsp;with&nbsp;the&nbsp;exchange&nbsp;of&nbsp;copyrighted&nbsp;works.<br>
+&nbsp;<br>
+&nbsp;c.&nbsp;If&nbsp;You&nbsp;Distribute,&nbsp;or&nbsp;Publicly&nbsp;Perform&nbsp;the&nbsp;Work&nbsp;or&nbsp;Collections,&nbsp;You&nbsp;must,<br>
+&nbsp;unless&nbsp;a&nbsp;request&nbsp;has&nbsp;been&nbsp;made&nbsp;pursuant&nbsp;to&nbsp;Section&nbsp;4(a),&nbsp;keep&nbsp;intact&nbsp;all<br>
+&nbsp;copyright&nbsp;notices&nbsp;for&nbsp;the&nbsp;Work&nbsp;and&nbsp;provide,&nbsp;reasonable&nbsp;to&nbsp;the&nbsp;medium&nbsp;or&nbsp;means<br>
+&nbsp;You&nbsp;are&nbsp;utilizing:&nbsp;(i)&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;Original&nbsp;Author&nbsp;(or&nbsp;pseudonym,&nbsp;if<br>
+&nbsp;applicable)&nbsp;if&nbsp;supplied,&nbsp;and/or&nbsp;if&nbsp;the&nbsp;Original&nbsp;Author&nbsp;and/or&nbsp;Licensor<br>
+&nbsp;designate&nbsp;another&nbsp;party&nbsp;or&nbsp;parties&nbsp;(e.g.,&nbsp;a&nbsp;sponsor&nbsp;institute,&nbsp;publishing<br>
+&nbsp;entity,&nbsp;journal)&nbsp;for&nbsp;attribution&nbsp;(&amp;quot;Attribution&nbsp;Parties&amp;quot;)&nbsp;in&nbsp;Licensor's<br>
+&nbsp;copyright&nbsp;notice,&nbsp;terms&nbsp;of&nbsp;service&nbsp;or&nbsp;by&nbsp;other&nbsp;reasonable&nbsp;means,&nbsp;the&nbsp;name&nbsp;of<br>
+&nbsp;such&nbsp;party&nbsp;or&nbsp;parties;&nbsp;(ii)&nbsp;the&nbsp;title&nbsp;of&nbsp;the&nbsp;Work&nbsp;if&nbsp;supplied;&nbsp;(iii)&nbsp;to&nbsp;the<br>
+&nbsp;extent&nbsp;reasonably&nbsp;practicable,&nbsp;the&nbsp;URI,&nbsp;if&nbsp;any,&nbsp;that&nbsp;Licensor&nbsp;specifies&nbsp;to&nbsp;be<br>
+&nbsp;associated&nbsp;with&nbsp;the&nbsp;Work,&nbsp;unless&nbsp;such&nbsp;URI&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;the&nbsp;copyright<br>
+&nbsp;notice&nbsp;or&nbsp;licensing&nbsp;information&nbsp;for&nbsp;the&nbsp;Work.&nbsp;The&nbsp;credit&nbsp;required&nbsp;by&nbsp;this<br>
+&nbsp;Section&nbsp;4(c)&nbsp;may&nbsp;be&nbsp;implemented&nbsp;in&nbsp;any&nbsp;reasonable&nbsp;manner;&nbsp;provided,&nbsp;however,<br>
+&nbsp;that&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;a&nbsp;Collection,&nbsp;at&nbsp;a&nbsp;minimum&nbsp;such&nbsp;credit&nbsp;will&nbsp;appear,&nbsp;if&nbsp;a<br>
+&nbsp;credit&nbsp;for&nbsp;all&nbsp;contributing&nbsp;authors&nbsp;of&nbsp;Collection&nbsp;appears,&nbsp;then&nbsp;as&nbsp;part&nbsp;of<br>
+&nbsp;these&nbsp;credits&nbsp;and&nbsp;in&nbsp;a&nbsp;manner&nbsp;at&nbsp;least&nbsp;as&nbsp;prominent&nbsp;as&nbsp;the&nbsp;credits&nbsp;for&nbsp;the<br>
+&nbsp;other&nbsp;contributing&nbsp;authors.&nbsp;For&nbsp;the&nbsp;avoidance&nbsp;of&nbsp;doubt,&nbsp;You&nbsp;may&nbsp;only&nbsp;use&nbsp;the<br>
+&nbsp;credit&nbsp;required&nbsp;by&nbsp;this&nbsp;Section&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;attribution&nbsp;in&nbsp;the&nbsp;manner<br>
+&nbsp;set&nbsp;out&nbsp;above&nbsp;and,&nbsp;by&nbsp;exercising&nbsp;Your&nbsp;rights&nbsp;under&nbsp;this&nbsp;License,&nbsp;You&nbsp;may&nbsp;not<br>
+&nbsp;implicitly&nbsp;or&nbsp;explicitly&nbsp;assert&nbsp;or&nbsp;imply&nbsp;any&nbsp;connection&nbsp;with,&nbsp;sponsorship&nbsp;or<br>
+&nbsp;endorsement&nbsp;by&nbsp;the&nbsp;Original&nbsp;Author,&nbsp;Licensor&nbsp;and/or&nbsp;Attribution&nbsp;Parties,&nbsp;as<br>
+&nbsp;appropriate,&nbsp;of&nbsp;You&nbsp;or&nbsp;Your&nbsp;use&nbsp;of&nbsp;the&nbsp;Work,&nbsp;without&nbsp;the&nbsp;separate,&nbsp;express<br>
+&nbsp;prior&nbsp;written&nbsp;permission&nbsp;of&nbsp;the&nbsp;Original&nbsp;Author,&nbsp;Licensor&nbsp;and/or&nbsp;Attribution<br>
+&nbsp;Parties.<br>
+&nbsp;<br>
+&nbsp;d.&nbsp;For&nbsp;the&nbsp;avoidance&nbsp;of&nbsp;doubt:<br>
+&nbsp;<br>
+&nbsp;i.&nbsp;Non-waivable&nbsp;Compulsory&nbsp;License&nbsp;Schemes.&nbsp;In&nbsp;those&nbsp;jurisdictions&nbsp;in&nbsp;which<br>
+&nbsp;the&nbsp;right&nbsp;to&nbsp;collect&nbsp;royalties&nbsp;through&nbsp;any&nbsp;statutory&nbsp;or&nbsp;compulsory&nbsp;licensing<br>
+&nbsp;scheme&nbsp;cannot&nbsp;be&nbsp;waived,&nbsp;the&nbsp;Licensor&nbsp;reserves&nbsp;the&nbsp;exclusive&nbsp;right&nbsp;to&nbsp;collect<br>
+&nbsp;such&nbsp;royalties&nbsp;for&nbsp;any&nbsp;exercise&nbsp;by&nbsp;You&nbsp;of&nbsp;the&nbsp;rights&nbsp;granted&nbsp;under&nbsp;this<br>
+&nbsp;License;<br>
+&nbsp;<br>
+&nbsp;ii.&nbsp;Waivable&nbsp;Compulsory&nbsp;License&nbsp;Schemes.&nbsp;In&nbsp;those&nbsp;jurisdictions&nbsp;in&nbsp;which&nbsp;the<br>
+&nbsp;right&nbsp;to&nbsp;collect&nbsp;royalties&nbsp;through&nbsp;any&nbsp;statutory&nbsp;or&nbsp;compulsory&nbsp;licensing<br>
+&nbsp;scheme&nbsp;can&nbsp;be&nbsp;waived,&nbsp;the&nbsp;Licensor&nbsp;reserves&nbsp;the&nbsp;exclusive&nbsp;right&nbsp;to&nbsp;collect<br>
+&nbsp;such&nbsp;royalties&nbsp;for&nbsp;any&nbsp;exercise&nbsp;by&nbsp;You&nbsp;of&nbsp;the&nbsp;rights&nbsp;granted&nbsp;under&nbsp;this<br>
+&nbsp;License&nbsp;if&nbsp;Your&nbsp;exercise&nbsp;of&nbsp;such&nbsp;rights&nbsp;is&nbsp;for&nbsp;a&nbsp;purpose&nbsp;or&nbsp;use&nbsp;which&nbsp;is<br>
+&nbsp;otherwise&nbsp;than&nbsp;noncommercial&nbsp;as&nbsp;permitted&nbsp;under&nbsp;Section&nbsp;4(b)&nbsp;and&nbsp;otherwise<br>
+&nbsp;waives&nbsp;the&nbsp;right&nbsp;to&nbsp;collect&nbsp;royalties&nbsp;through&nbsp;any&nbsp;statutory&nbsp;or&nbsp;compulsory<br>
+&nbsp;licensing&nbsp;scheme;&nbsp;and,<br>
+<br>
+&nbsp;iii.&nbsp;Voluntary&nbsp;License&nbsp;Schemes.&nbsp;The&nbsp;Licensor&nbsp;reserves&nbsp;the&nbsp;right&nbsp;to&nbsp;collect<br>
+&nbsp;royalties,&nbsp;whether&nbsp;individually&nbsp;or,&nbsp;in&nbsp;the&nbsp;event&nbsp;that&nbsp;the&nbsp;Licensor&nbsp;is&nbsp;a&nbsp;member<br>
+&nbsp;of&nbsp;a&nbsp;collecting&nbsp;society&nbsp;that&nbsp;administers&nbsp;voluntary&nbsp;licensing&nbsp;schemes,&nbsp;via&nbsp;that<br>
+&nbsp;society,&nbsp;from&nbsp;any&nbsp;exercise&nbsp;by&nbsp;You&nbsp;of&nbsp;the&nbsp;rights&nbsp;granted&nbsp;under&nbsp;this&nbsp;License<br>
+&nbsp;that&nbsp;is&nbsp;for&nbsp;a&nbsp;purpose&nbsp;or&nbsp;use&nbsp;which&nbsp;is&nbsp;otherwise&nbsp;than&nbsp;noncommercial&nbsp;as<br>
+&nbsp;permitted&nbsp;under&nbsp;Section&nbsp;4(b).<br>
+&nbsp;<br>
+&nbsp;e.&nbsp;Except&nbsp;as&nbsp;otherwise&nbsp;agreed&nbsp;in&nbsp;writing&nbsp;by&nbsp;the&nbsp;Licensor&nbsp;or&nbsp;as&nbsp;may&nbsp;be<br>
+&nbsp;otherwise&nbsp;permitted&nbsp;by&nbsp;applicable&nbsp;law,&nbsp;if&nbsp;You&nbsp;Reproduce,&nbsp;Distribute&nbsp;or<br>
+&nbsp;Publicly&nbsp;Perform&nbsp;the&nbsp;Work&nbsp;either&nbsp;by&nbsp;itself&nbsp;or&nbsp;as&nbsp;part&nbsp;of&nbsp;any&nbsp;Collections,<br>
+&nbsp;You&nbsp;must&nbsp;not&nbsp;distort,&nbsp;mutilate,&nbsp;modify&nbsp;or&nbsp;take&nbsp;other&nbsp;derogatory&nbsp;action&nbsp;in<br>
+&nbsp;relation&nbsp;to&nbsp;the&nbsp;Work&nbsp;which&nbsp;would&nbsp;be&nbsp;prejudicial&nbsp;to&nbsp;the&nbsp;Original&nbsp;Author's<br>
+&nbsp;honor&nbsp;or&nbsp;reputation.<br>
+&nbsp;<br>
+5.&nbsp;Representations,&nbsp;Warranties&nbsp;and&nbsp;Disclaimer<br>
+UNLESS&nbsp;OTHERWISE&nbsp;MUTUALLY&nbsp;AGREED&nbsp;BY&nbsp;THE&nbsp;PARTIES&nbsp;IN&nbsp;WRITING,&nbsp;LICENSOR&nbsp;OFFERS<br>
+THE&nbsp;WORK&nbsp;AS-IS&nbsp;AND&nbsp;MAKES&nbsp;NO&nbsp;REPRESENTATIONS&nbsp;OR&nbsp;WARRANTIES&nbsp;OF&nbsp;ANY&nbsp;KIND<br>
+CONCERNING&nbsp;THE&nbsp;WORK,&nbsp;EXPRESS,&nbsp;IMPLIED,&nbsp;STATUTORY&nbsp;OR&nbsp;OTHERWISE,&nbsp;INCLUDING,<br>
+WITHOUT&nbsp;LIMITATION,&nbsp;WARRANTIES&nbsp;OF&nbsp;TITLE,&nbsp;MERCHANTIBILITY,&nbsp;FITNESS&nbsp;FOR&nbsp;A<br>
+PARTICULAR&nbsp;PURPOSE,&nbsp;NONINFRINGEMENT,&nbsp;OR&nbsp;THE&nbsp;ABSENCE&nbsp;OF&nbsp;LATENT&nbsp;OR&nbsp;OTHER&nbsp;DEFECTS,<br>
+ACCURACY,&nbsp;OR&nbsp;THE&nbsp;PRESENCE&nbsp;OF&nbsp;ABSENCE&nbsp;OF&nbsp;ERRORS,&nbsp;WHETHER&nbsp;OR&nbsp;NOT&nbsp;DISCOVERABLE.<br>
+SOME&nbsp;JURISDICTIONS&nbsp;DO&nbsp;NOT&nbsp;ALLOW&nbsp;THE&nbsp;EXCLUSION&nbsp;OF&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;SO&nbsp;SUCH<br>
+EXCLUSION&nbsp;MAY&nbsp;NOT&nbsp;APPLY&nbsp;TO&nbsp;YOU.<br>
+<br>
+6.&nbsp;Limitation&nbsp;on&nbsp;Liability.&nbsp;EXCEPT&nbsp;TO&nbsp;THE&nbsp;EXTENT&nbsp;REQUIRED&nbsp;BY&nbsp;APPLICABLE&nbsp;LAW,<br>
+IN&nbsp;NO&nbsp;EVENT&nbsp;WILL&nbsp;LICENSOR&nbsp;BE&nbsp;LIABLE&nbsp;TO&nbsp;YOU&nbsp;ON&nbsp;ANY&nbsp;LEGAL&nbsp;THEORY&nbsp;FOR&nbsp;ANY&nbsp;SPECIAL,<br>
+INCIDENTAL,&nbsp;CONSEQUENTIAL,&nbsp;PUNITIVE&nbsp;OR&nbsp;EXEMPLARY&nbsp;DAMAGES&nbsp;ARISING&nbsp;OUT&nbsp;OF&nbsp;THIS<br>
+LICENSE&nbsp;OR&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THE&nbsp;WORK,&nbsp;EVEN&nbsp;IF&nbsp;LICENSOR&nbsp;HAS&nbsp;BEEN&nbsp;ADVISED&nbsp;OF&nbsp;THE<br>
+POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGES.<br>
+<br>
+7.&nbsp;Termination<br>
+<br>
+&nbsp;a.&nbsp;This&nbsp;License&nbsp;and&nbsp;the&nbsp;rights&nbsp;granted&nbsp;hereunder&nbsp;will&nbsp;terminate&nbsp;automatically<br>
+&nbsp;upon&nbsp;any&nbsp;breach&nbsp;by&nbsp;You&nbsp;of&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;Individuals&nbsp;or&nbsp;entities<br>
+&nbsp;who&nbsp;have&nbsp;received&nbsp;Collections&nbsp;from&nbsp;You&nbsp;under&nbsp;this&nbsp;License,&nbsp;however,&nbsp;will&nbsp;not<br>
+&nbsp;have&nbsp;their&nbsp;licenses&nbsp;terminated&nbsp;provided&nbsp;such&nbsp;individuals&nbsp;or&nbsp;entities&nbsp;remain<br>
+&nbsp;in&nbsp;full&nbsp;compliance&nbsp;with&nbsp;those&nbsp;licenses.&nbsp;Sections&nbsp;1,&nbsp;2,&nbsp;5,&nbsp;6,&nbsp;7,&nbsp;and&nbsp;8&nbsp;will<br>
+&nbsp;survive&nbsp;any&nbsp;termination&nbsp;of&nbsp;this&nbsp;License.<br>
+&nbsp;<br>
+&nbsp;b.&nbsp;Subject&nbsp;to&nbsp;the&nbsp;above&nbsp;terms&nbsp;and&nbsp;conditions,&nbsp;the&nbsp;license&nbsp;granted&nbsp;here&nbsp;is<br>
+&nbsp;perpetual&nbsp;(for&nbsp;the&nbsp;duration&nbsp;of&nbsp;the&nbsp;applicable&nbsp;copyright&nbsp;in&nbsp;the&nbsp;Work).<br>
+&nbsp;Notwithstanding&nbsp;the&nbsp;above,&nbsp;Licensor&nbsp;reserves&nbsp;the&nbsp;right&nbsp;to&nbsp;release&nbsp;the&nbsp;Work<br>
+&nbsp;under&nbsp;different&nbsp;license&nbsp;terms&nbsp;or&nbsp;to&nbsp;stop&nbsp;distributing&nbsp;the&nbsp;Work&nbsp;at&nbsp;any&nbsp;time;<br>
+&nbsp;provided,&nbsp;however&nbsp;that&nbsp;any&nbsp;such&nbsp;election&nbsp;will&nbsp;not&nbsp;serve&nbsp;to&nbsp;withdraw&nbsp;this<br>
+&nbsp;License&nbsp;(or&nbsp;any&nbsp;other&nbsp;license&nbsp;that&nbsp;has&nbsp;been,&nbsp;or&nbsp;is&nbsp;required&nbsp;to&nbsp;be,&nbsp;granted<br>
+&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License),&nbsp;and&nbsp;this&nbsp;License&nbsp;will&nbsp;continue&nbsp;in&nbsp;full<br>
+&nbsp;force&nbsp;and&nbsp;effect&nbsp;unless&nbsp;terminated&nbsp;as&nbsp;stated&nbsp;above.<br>
+&nbsp;<br>
+8.&nbsp;Miscellaneous<br>
+<br>
+&nbsp;a.&nbsp;Each&nbsp;time&nbsp;You&nbsp;Distribute&nbsp;or&nbsp;Publicly&nbsp;Perform&nbsp;the&nbsp;Work&nbsp;or&nbsp;a&nbsp;Collection,<br>
+&nbsp;the&nbsp;Licensor&nbsp;offers&nbsp;to&nbsp;the&nbsp;recipient&nbsp;a&nbsp;license&nbsp;to&nbsp;the&nbsp;Work&nbsp;on&nbsp;the&nbsp;same&nbsp;terms<br>
+&nbsp;and&nbsp;conditions&nbsp;as&nbsp;the&nbsp;license&nbsp;granted&nbsp;to&nbsp;You&nbsp;under&nbsp;this&nbsp;License.<br>
+&nbsp;<br>
+&nbsp;b.&nbsp;If&nbsp;any&nbsp;provision&nbsp;of&nbsp;this&nbsp;License&nbsp;is&nbsp;invalid&nbsp;or&nbsp;unenforceable&nbsp;under<br>
+&nbsp;applicable&nbsp;law,&nbsp;it&nbsp;shall&nbsp;not&nbsp;affect&nbsp;the&nbsp;validity&nbsp;or&nbsp;enforceability&nbsp;of&nbsp;the<br>
+&nbsp;remainder&nbsp;of&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License,&nbsp;and&nbsp;without&nbsp;further&nbsp;action&nbsp;by&nbsp;the<br>
+&nbsp;parties&nbsp;to&nbsp;this&nbsp;agreement,&nbsp;such&nbsp;provision&nbsp;shall&nbsp;be&nbsp;reformed&nbsp;to&nbsp;the&nbsp;minimum<br>
+&nbsp;extent&nbsp;necessary&nbsp;to&nbsp;make&nbsp;such&nbsp;provision&nbsp;valid&nbsp;and&nbsp;enforceable.<br>
+&nbsp;<br>
+&nbsp;c.&nbsp;No&nbsp;term&nbsp;or&nbsp;provision&nbsp;of&nbsp;this&nbsp;License&nbsp;shall&nbsp;be&nbsp;deemed&nbsp;waived&nbsp;and&nbsp;no&nbsp;breach<br>
+&nbsp;consented&nbsp;to&nbsp;unless&nbsp;such&nbsp;waiver&nbsp;or&nbsp;consent&nbsp;shall&nbsp;be&nbsp;in&nbsp;writing&nbsp;and&nbsp;signed&nbsp;by<br>
+&nbsp;the&nbsp;party&nbsp;to&nbsp;be&nbsp;charged&nbsp;with&nbsp;such&nbsp;waiver&nbsp;or&nbsp;consent.<br>
+&nbsp;<br>
+&nbsp;d.&nbsp;This&nbsp;License&nbsp;constitutes&nbsp;the&nbsp;entire&nbsp;agreement&nbsp;between&nbsp;the&nbsp;parties&nbsp;with<br>
+&nbsp;respect&nbsp;to&nbsp;the&nbsp;Work&nbsp;licensed&nbsp;here.&nbsp;There&nbsp;are&nbsp;no&nbsp;understandings,&nbsp;agreements<br>
+&nbsp;or&nbsp;representations&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;Work&nbsp;not&nbsp;specified&nbsp;here.&nbsp;Licensor&nbsp;shall<br>
+&nbsp;not&nbsp;be&nbsp;bound&nbsp;by&nbsp;any&nbsp;additional&nbsp;provisions&nbsp;that&nbsp;may&nbsp;appear&nbsp;in&nbsp;any&nbsp;communication<br>
+&nbsp;from&nbsp;You.&nbsp;This&nbsp;License&nbsp;may&nbsp;not&nbsp;be&nbsp;modified&nbsp;without&nbsp;the&nbsp;mutual&nbsp;written<br>
+&nbsp;agreement&nbsp;of&nbsp;the&nbsp;Licensor&nbsp;and&nbsp;You.<br>
+&nbsp;<br>
+&nbsp;e.&nbsp;The&nbsp;rights&nbsp;granted&nbsp;under,&nbsp;and&nbsp;the&nbsp;subject&nbsp;matter&nbsp;referenced,&nbsp;in&nbsp;this<br>
+&nbsp;License&nbsp;were&nbsp;drafted&nbsp;utilizing&nbsp;the&nbsp;terminology&nbsp;of&nbsp;the&nbsp;Berne&nbsp;Convention&nbsp;for<br>
+&nbsp;the&nbsp;Protection&nbsp;of&nbsp;Literary&nbsp;and&nbsp;Artistic&nbsp;Works&nbsp;(as&nbsp;amended&nbsp;on&nbsp;September&nbsp;28,<br>
+&nbsp;1979),&nbsp;the&nbsp;Rome&nbsp;Convention&nbsp;of&nbsp;1961,&nbsp;the&nbsp;WIPO&nbsp;Copyright&nbsp;Treaty&nbsp;of&nbsp;1996,&nbsp;the<br>
+&nbsp;WIPO&nbsp;Performances&nbsp;and&nbsp;Phonograms&nbsp;Treaty&nbsp;of&nbsp;1996&nbsp;and&nbsp;the&nbsp;Universal&nbsp;Copyright<br>
+&nbsp;Convention&nbsp;(as&nbsp;revised&nbsp;on&nbsp;July&nbsp;24,&nbsp;1971).&nbsp;These&nbsp;rights&nbsp;and&nbsp;subject&nbsp;matter&nbsp;take<br>
+&nbsp;effect&nbsp;in&nbsp;the&nbsp;relevant&nbsp;jurisdiction&nbsp;in&nbsp;which&nbsp;the&nbsp;License&nbsp;terms&nbsp;are&nbsp;sought&nbsp;to<br>
+&nbsp;be&nbsp;enforced&nbsp;according&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;provisions&nbsp;of&nbsp;the&nbsp;implementation&nbsp;of<br>
+&nbsp;those&nbsp;treaty&nbsp;provisions&nbsp;in&nbsp;the&nbsp;applicable&nbsp;national&nbsp;law.&nbsp;If&nbsp;the&nbsp;standard&nbsp;suite<br>
+&nbsp;of&nbsp;rights&nbsp;granted&nbsp;under&nbsp;applicable&nbsp;copyright&nbsp;law&nbsp;includes&nbsp;additional&nbsp;rights<br>
+&nbsp;not&nbsp;granted&nbsp;under&nbsp;this&nbsp;License,&nbsp;such&nbsp;additional&nbsp;rights&nbsp;are&nbsp;deemed&nbsp;to&nbsp;be<br>
+&nbsp;included&nbsp;in&nbsp;the&nbsp;License;&nbsp;this&nbsp;License&nbsp;is&nbsp;not&nbsp;intended&nbsp;to&nbsp;restrict&nbsp;the&nbsp;license<br>
+&nbsp;of&nbsp;any&nbsp;rights&nbsp;under&nbsp;applicable&nbsp;law.<br>
+&nbsp;<br>
+Creative&nbsp;Commons&nbsp;Notice<br>
+<br>
+Creative&nbsp;Commons&nbsp;is&nbsp;not&nbsp;a&nbsp;party&nbsp;to&nbsp;this&nbsp;License,&nbsp;and&nbsp;makes&nbsp;no&nbsp;warranty<br>
+whatsoever&nbsp;in&nbsp;connection&nbsp;with&nbsp;the&nbsp;Work.&nbsp;Creative&nbsp;Commons&nbsp;will&nbsp;not&nbsp;be&nbsp;liable<br>
+to&nbsp;You&nbsp;or&nbsp;any&nbsp;party&nbsp;on&nbsp;any&nbsp;legal&nbsp;theory&nbsp;for&nbsp;any&nbsp;damages&nbsp;whatsoever,&nbsp;including<br>
+without&nbsp;limitation&nbsp;any&nbsp;general,&nbsp;special,&nbsp;incidental&nbsp;or&nbsp;consequential&nbsp;damages<br>
+arising&nbsp;in&nbsp;connection&nbsp;to&nbsp;this&nbsp;license.&nbsp;Notwithstanding&nbsp;the&nbsp;foregoing&nbsp;two&nbsp;(2)<br>
+sentences,&nbsp;if&nbsp;Creative&nbsp;Commons&nbsp;has&nbsp;expressly&nbsp;identified&nbsp;itself&nbsp;as&nbsp;the&nbsp;Licensor<br>
+hereunder,&nbsp;it&nbsp;shall&nbsp;have&nbsp;all&nbsp;rights&nbsp;and&nbsp;obligations&nbsp;of&nbsp;Licensor.<br>
+<br>
+Except&nbsp;for&nbsp;the&nbsp;limited&nbsp;purpose&nbsp;of&nbsp;indicating&nbsp;to&nbsp;the&nbsp;public&nbsp;that&nbsp;the&nbsp;Work&nbsp;is<br>
+licensed&nbsp;under&nbsp;the&nbsp;CCPL,&nbsp;Creative&nbsp;Commons&nbsp;does&nbsp;not&nbsp;authorize&nbsp;the&nbsp;use&nbsp;by&nbsp;either<br>
+party&nbsp;of&nbsp;the&nbsp;trademark&nbsp;&amp;quot;Creative&nbsp;Commons&amp;quot;&nbsp;or&nbsp;any&nbsp;related&nbsp;trademark&nbsp;or&nbsp;logo&nbsp;of<br>
+Creative&nbsp;Commons&nbsp;without&nbsp;the&nbsp;prior&nbsp;written&nbsp;consent&nbsp;of&nbsp;Creative&nbsp;Commons.&nbsp;Any<br>
+permitted&nbsp;use&nbsp;will&nbsp;be&nbsp;in&nbsp;compliance&nbsp;with&nbsp;Creative&nbsp;Commons'&nbsp;then-current<br>
+trademark&nbsp;usage&nbsp;guidelines,&nbsp;as&nbsp;may&nbsp;be&nbsp;published&nbsp;on&nbsp;its&nbsp;website&nbsp;or&nbsp;otherwise<br>
+made&nbsp;available&nbsp;upon&nbsp;request&nbsp;from&nbsp;time&nbsp;to&nbsp;time.&nbsp;For&nbsp;the&nbsp;avoidance&nbsp;of&nbsp;doubt,<br>
+this&nbsp;trademark&nbsp;restriction&nbsp;does&nbsp;not&nbsp;form&nbsp;part&nbsp;of&nbsp;this&nbsp;License.<br>
+<br>
+Creative&nbsp;Commons&nbsp;may&nbsp;be&nbsp;contacted&nbsp;at&nbsp;http://creativecommons.org/.<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/legal/CC-BY-NC-ND.txt<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunklegalCDDLv10txt&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/legal/CDDLv1.0.txt&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/legal/CDDLv1.0.txt&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/legal/CDDLv1.0.txt&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,286&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+COMMON&nbsp;DEVELOPMENT&nbsp;AND&nbsp;DISTRIBUTION&nbsp;LICENSE&nbsp;(CDDL)&nbsp;Version&nbsp;1.0&nbsp;<br>
+<br>
+1.&nbsp;Definitions.&nbsp;<br>
+<br>
+1.1.&nbsp;Contributor&nbsp;means&nbsp;each&nbsp;individual&nbsp;or&nbsp;entity&nbsp;that&nbsp;creates&nbsp;or&nbsp;contributes&nbsp;to&nbsp;<br>
+the&nbsp;creation&nbsp;of&nbsp;Modifications.&nbsp;<br>
+<br>
+1.2.&nbsp;Contributor&nbsp;Version&nbsp;means&nbsp;the&nbsp;combination&nbsp;of&nbsp;the&nbsp;Original&nbsp;Software,&nbsp;prior&nbsp;<br>
+Modifications&nbsp;used&nbsp;by&nbsp;a&nbsp;Contributor&nbsp;(if&nbsp;any),&nbsp;and&nbsp;the&nbsp;Modifications&nbsp;made&nbsp;by&nbsp;<br>
+that&nbsp;particular&nbsp;Contributor.&nbsp;<br>
+<br>
+1.3.&nbsp;Covered&nbsp;Software&nbsp;means&nbsp;(a)&nbsp;the&nbsp;Original&nbsp;Software,&nbsp;or&nbsp;(b)&nbsp;Modifications,&nbsp;or&nbsp;<br>
+(c)&nbsp;the&nbsp;combination&nbsp;of&nbsp;files&nbsp;containing&nbsp;Original&nbsp;Software&nbsp;with&nbsp;files&nbsp;containing&nbsp;<br>
+Modifications,&nbsp;in&nbsp;each&nbsp;case&nbsp;including&nbsp;portions&nbsp;thereof.&nbsp;<br>
+<br>
+1.4.&nbsp;Executable&nbsp;means&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;any&nbsp;form&nbsp;other&nbsp;than&nbsp;Source&nbsp;Code.&nbsp;<br>
+<br>
+1.5.&nbsp;Initial&nbsp;Developer&nbsp;means&nbsp;the&nbsp;individual&nbsp;or&nbsp;entity&nbsp;that&nbsp;first&nbsp;makes&nbsp;Original&nbsp;<br>
+Software&nbsp;available&nbsp;under&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+1.6.&nbsp;Larger&nbsp;Work&nbsp;means&nbsp;a&nbsp;work&nbsp;which&nbsp;combines&nbsp;Covered&nbsp;Software&nbsp;or&nbsp;portions&nbsp;<br>
+thereof&nbsp;with&nbsp;code&nbsp;not&nbsp;governed&nbsp;by&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+1.7.&nbsp;License&nbsp;means&nbsp;this&nbsp;document.&nbsp;<br>
+<br>
+1.8.&nbsp;Licensable&nbsp;means&nbsp;having&nbsp;the&nbsp;right&nbsp;to&nbsp;grant,&nbsp;to&nbsp;the&nbsp;maximum&nbsp;extent&nbsp;<br>
+possible,&nbsp;whether&nbsp;at&nbsp;the&nbsp;time&nbsp;of&nbsp;the&nbsp;initial&nbsp;grant&nbsp;or&nbsp;subsequently&nbsp;acquired,&nbsp;<br>
+any&nbsp;and&nbsp;all&nbsp;of&nbsp;the&nbsp;rights&nbsp;conveyed&nbsp;herein.&nbsp;<br>
+<br>
+1.9.&nbsp;Modifications&nbsp;means&nbsp;the&nbsp;Source&nbsp;Code&nbsp;and&nbsp;Executable&nbsp;form&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;<br>
+following:&nbsp;A.&nbsp;Any&nbsp;file&nbsp;that&nbsp;results&nbsp;from&nbsp;an&nbsp;addition&nbsp;to,&nbsp;deletion&nbsp;from&nbsp;or&nbsp;<br>
+modification&nbsp;of&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;file&nbsp;containing&nbsp;Original&nbsp;Software&nbsp;or&nbsp;previous&nbsp;<br>
+Modifications;&nbsp;B.&nbsp;Any&nbsp;new&nbsp;file&nbsp;that&nbsp;contains&nbsp;any&nbsp;part&nbsp;of&nbsp;the&nbsp;Original&nbsp;Software&nbsp;<br>
+or&nbsp;previous&nbsp;Modification;&nbsp;or&nbsp;C.&nbsp;Any&nbsp;new&nbsp;file&nbsp;that&nbsp;is&nbsp;contributed&nbsp;or&nbsp;otherwise&nbsp;<br>
+made&nbsp;available&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+1.10.&nbsp;Original&nbsp;Software&nbsp;means&nbsp;the&nbsp;Source&nbsp;Code&nbsp;and&nbsp;Executable&nbsp;form&nbsp;of&nbsp;computer&nbsp;<br>
+software&nbsp;code&nbsp;that&nbsp;is&nbsp;originally&nbsp;released&nbsp;under&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+1.11.&nbsp;Patent&nbsp;Claims&nbsp;means&nbsp;any&nbsp;patent&nbsp;claim(s),&nbsp;now&nbsp;owned&nbsp;or&nbsp;hereafter&nbsp;acquired,&nbsp;<br>
+including&nbsp;without&nbsp;limitation,&nbsp;method,&nbsp;process,&nbsp;and&nbsp;apparatus&nbsp;claims,&nbsp;in&nbsp;any&nbsp;<br>
+patent&nbsp;Licensable&nbsp;by&nbsp;grantor.&nbsp;<br>
+<br>
+1.12.&nbsp;Source&nbsp;Code&nbsp;means&nbsp;(a)&nbsp;the&nbsp;common&nbsp;form&nbsp;of&nbsp;computer&nbsp;software&nbsp;code&nbsp;in&nbsp;which&nbsp;<br>
+modifications&nbsp;are&nbsp;made&nbsp;and&nbsp;(b)&nbsp;associated&nbsp;documentation&nbsp;included&nbsp;in&nbsp;or&nbsp;with&nbsp;<br>
+such&nbsp;code.&nbsp;<br>
+<br>
+1.13.&nbsp;You&nbsp;(or&nbsp;Your)&nbsp;means&nbsp;an&nbsp;individual&nbsp;or&nbsp;a&nbsp;legal&nbsp;entity&nbsp;exercising&nbsp;rights&nbsp;<br>
+under,&nbsp;and&nbsp;complying&nbsp;with&nbsp;all&nbsp;of&nbsp;the&nbsp;terms&nbsp;of,&nbsp;this&nbsp;License.&nbsp;For&nbsp;legal&nbsp;<br>
+entities,&nbsp;You&nbsp;includes&nbsp;any&nbsp;entity&nbsp;which&nbsp;controls,&nbsp;is&nbsp;controlled&nbsp;by,&nbsp;or&nbsp;is&nbsp;under&nbsp;<br>
+common&nbsp;control&nbsp;with&nbsp;You.&nbsp;For&nbsp;purposes&nbsp;of&nbsp;this&nbsp;definition,&nbsp;control&nbsp;means&nbsp;(a)&nbsp;the&nbsp;<br>
+power,&nbsp;direct&nbsp;or&nbsp;indirect,&nbsp;to&nbsp;cause&nbsp;the&nbsp;direction&nbsp;or&nbsp;management&nbsp;of&nbsp;such&nbsp;entity,&nbsp;<br>
+whether&nbsp;by&nbsp;contract&nbsp;or&nbsp;otherwise,&nbsp;or&nbsp;(b)&nbsp;ownership&nbsp;of&nbsp;more&nbsp;than&nbsp;fifty&nbsp;percent&nbsp;<br>
+(50%)&nbsp;of&nbsp;the&nbsp;outstanding&nbsp;shares&nbsp;or&nbsp;beneficial&nbsp;ownership&nbsp;of&nbsp;such&nbsp;entity.&nbsp;<br>
+<br>
+2.&nbsp;License&nbsp;Grants.<br>
+<br>
+2.1.&nbsp;The&nbsp;Initial&nbsp;Developer&nbsp;Grant.&nbsp;Conditioned&nbsp;upon&nbsp;Your&nbsp;compliance&nbsp;with&nbsp;Section&nbsp;<br>
+3.1&nbsp;below&nbsp;and&nbsp;subject&nbsp;to&nbsp;third&nbsp;party&nbsp;intellectual&nbsp;property&nbsp;claims,&nbsp;the&nbsp;Initial&nbsp;<br>
+Developer&nbsp;hereby&nbsp;grants&nbsp;You&nbsp;a&nbsp;world-wide,&nbsp;royalty-free,&nbsp;non-exclusive&nbsp;license:&nbsp;<br>
+<br>
+(a)&nbsp;under&nbsp;intellectual&nbsp;property&nbsp;rights&nbsp;(other&nbsp;than&nbsp;patent&nbsp;or&nbsp;trademark)&nbsp;<br>
+Licensable&nbsp;by&nbsp;Initial&nbsp;Developer,&nbsp;to&nbsp;use,&nbsp;reproduce,&nbsp;modify,&nbsp;display,&nbsp;perform,&nbsp;<br>
+sublicense&nbsp;and&nbsp;distribute&nbsp;the&nbsp;Original&nbsp;Software&nbsp;(or&nbsp;portions&nbsp;thereof),&nbsp;with&nbsp;or&nbsp;<br>
+without&nbsp;Modifications,&nbsp;and/or&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;Larger&nbsp;Work;&nbsp;and&nbsp;<br>
+<br>
+(b)&nbsp;under&nbsp;Patent&nbsp;Claims&nbsp;infringed&nbsp;by&nbsp;the&nbsp;making,&nbsp;using&nbsp;or&nbsp;selling&nbsp;of&nbsp;Original&nbsp;<br>
+Software,&nbsp;to&nbsp;make,&nbsp;have&nbsp;made,&nbsp;use,&nbsp;practice,&nbsp;sell,&nbsp;and&nbsp;offer&nbsp;for&nbsp;sale,&nbsp;and/or&nbsp;<br>
+otherwise&nbsp;dispose&nbsp;of&nbsp;the&nbsp;Original&nbsp;Software&nbsp;(or&nbsp;portions&nbsp;thereof);<br>
+<br>
+(c)&nbsp;The&nbsp;licenses&nbsp;granted&nbsp;in&nbsp;Sections&nbsp;2.1(a)&nbsp;and&nbsp;(b)&nbsp;are&nbsp;effective&nbsp;on&nbsp;the&nbsp;date&nbsp;<br>
+Initial&nbsp;Developer&nbsp;first&nbsp;distributes&nbsp;or&nbsp;otherwise&nbsp;makes&nbsp;the&nbsp;Original&nbsp;Software&nbsp;<br>
+available&nbsp;to&nbsp;a&nbsp;third&nbsp;party&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License;<br>
+<br>
+(d)&nbsp;Notwithstanding&nbsp;Section&nbsp;2.1(b)&nbsp;above,&nbsp;no&nbsp;patent&nbsp;license&nbsp;is&nbsp;granted:&nbsp;(1)&nbsp;for&nbsp;<br>
+code&nbsp;that&nbsp;You&nbsp;delete&nbsp;from&nbsp;the&nbsp;Original&nbsp;Software,&nbsp;or&nbsp;(2)&nbsp;for&nbsp;infringements&nbsp;<br>
+caused&nbsp;by:&nbsp;(i)&nbsp;the&nbsp;modification&nbsp;of&nbsp;the&nbsp;Original&nbsp;Software,&nbsp;or&nbsp;(ii)&nbsp;the&nbsp;<br>
+combination&nbsp;of&nbsp;the&nbsp;Original&nbsp;Software&nbsp;with&nbsp;other&nbsp;software&nbsp;or&nbsp;devices.&nbsp;<br>
+<br>
+2.2.&nbsp;Contributor&nbsp;Grant.&nbsp;Conditioned&nbsp;upon&nbsp;Your&nbsp;compliance&nbsp;with&nbsp;Section&nbsp;3.1&nbsp;below&nbsp;<br>
+and&nbsp;subject&nbsp;to&nbsp;third&nbsp;party&nbsp;intellectual&nbsp;property&nbsp;claims,&nbsp;each&nbsp;Contributor&nbsp;<br>
+hereby&nbsp;grants&nbsp;You&nbsp;a&nbsp;world-wide,&nbsp;royalty-free,&nbsp;non-exclusive&nbsp;license:&nbsp;<br>
+<br>
+(a)&nbsp;under&nbsp;intellectual&nbsp;property&nbsp;rights&nbsp;(other&nbsp;than&nbsp;patent&nbsp;or&nbsp;trademark)&nbsp;<br>
+Licensable&nbsp;by&nbsp;Contributor&nbsp;to&nbsp;use,&nbsp;reproduce,&nbsp;modify,&nbsp;display,&nbsp;perform,&nbsp;<br>
+sublicense&nbsp;and&nbsp;distribute&nbsp;the&nbsp;Modifications&nbsp;created&nbsp;by&nbsp;such&nbsp;Contributor&nbsp;(or&nbsp;<br>
+portions&nbsp;thereof),&nbsp;either&nbsp;on&nbsp;an&nbsp;unmodified&nbsp;basis,&nbsp;with&nbsp;other&nbsp;Modifications,&nbsp;as&nbsp;<br>
+Covered&nbsp;Software&nbsp;and/or&nbsp;as&nbsp;part&nbsp;of&nbsp;a&nbsp;Larger&nbsp;Work;&nbsp;and&nbsp;<br>
+<br>
+(b)&nbsp;under&nbsp;Patent&nbsp;Claims&nbsp;infringed&nbsp;by&nbsp;the&nbsp;making,&nbsp;using,&nbsp;or&nbsp;selling&nbsp;of&nbsp;<br>
+Modifications&nbsp;made&nbsp;by&nbsp;that&nbsp;Contributor&nbsp;either&nbsp;alone&nbsp;and/or&nbsp;in&nbsp;combination&nbsp;with&nbsp;<br>
+its&nbsp;Contributor&nbsp;Version&nbsp;(or&nbsp;portions&nbsp;of&nbsp;such&nbsp;combination),&nbsp;to&nbsp;make,&nbsp;use,&nbsp;sell,&nbsp;<br>
+offer&nbsp;for&nbsp;sale,&nbsp;have&nbsp;made,&nbsp;and/or&nbsp;otherwise&nbsp;dispose&nbsp;of:&nbsp;(1)&nbsp;Modifications&nbsp;made&nbsp;<br>
+by&nbsp;that&nbsp;Contributor&nbsp;(or&nbsp;portions&nbsp;thereof);&nbsp;and&nbsp;(2)&nbsp;the&nbsp;combination&nbsp;of&nbsp;<br>
+Modifications&nbsp;made&nbsp;by&nbsp;that&nbsp;Contributor&nbsp;with&nbsp;its&nbsp;Contributor&nbsp;Version&nbsp;(or&nbsp;<br>
+portions&nbsp;of&nbsp;such&nbsp;combination).&nbsp;<br>
+<br>
+(c)&nbsp;The&nbsp;licenses&nbsp;granted&nbsp;in&nbsp;Sections&nbsp;2.2(a)&nbsp;and&nbsp;2.2(b)&nbsp;are&nbsp;effective&nbsp;on&nbsp;the&nbsp;<br>
+date&nbsp;Contributor&nbsp;first&nbsp;distributes&nbsp;or&nbsp;otherwise&nbsp;makes&nbsp;the&nbsp;Modifications&nbsp;<br>
+available&nbsp;to&nbsp;a&nbsp;third&nbsp;party.<br>
+<br>
+(d)&nbsp;Notwithstanding&nbsp;Section&nbsp;2.2(b)&nbsp;above,&nbsp;no&nbsp;patent&nbsp;license&nbsp;is&nbsp;granted:&nbsp;(1)&nbsp;for&nbsp;<br>
+any&nbsp;code&nbsp;that&nbsp;Contributor&nbsp;has&nbsp;deleted&nbsp;from&nbsp;the&nbsp;Contributor&nbsp;Version;&nbsp;(2)&nbsp;for&nbsp;<br>
+infringements&nbsp;caused&nbsp;by:&nbsp;(i)&nbsp;third&nbsp;party&nbsp;modifications&nbsp;of&nbsp;Contributor&nbsp;Version,&nbsp;<br>
+or&nbsp;(ii)&nbsp;the&nbsp;combination&nbsp;of&nbsp;Modifications&nbsp;made&nbsp;by&nbsp;that&nbsp;Contributor&nbsp;with&nbsp;other&nbsp;<br>
+software&nbsp;(except&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;Contributor&nbsp;Version)&nbsp;or&nbsp;other&nbsp;devices;&nbsp;or&nbsp;(3)&nbsp;<br>
+under&nbsp;Patent&nbsp;Claims&nbsp;infringed&nbsp;by&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;the&nbsp;absence&nbsp;of&nbsp;<br>
+Modifications&nbsp;made&nbsp;by&nbsp;that&nbsp;Contributor.&nbsp;<br>
+<br>
+3.&nbsp;Distribution&nbsp;Obligations.&nbsp;<br>
+<br>
+3.1.&nbsp;Availability&nbsp;of&nbsp;Source&nbsp;Code.&nbsp;Any&nbsp;Covered&nbsp;Software&nbsp;that&nbsp;You&nbsp;distribute&nbsp;or&nbsp;<br>
+otherwise&nbsp;make&nbsp;available&nbsp;in&nbsp;Executable&nbsp;form&nbsp;must&nbsp;also&nbsp;be&nbsp;made&nbsp;available&nbsp;in&nbsp;<br>
+Source&nbsp;Code&nbsp;form&nbsp;and&nbsp;that&nbsp;Source&nbsp;Code&nbsp;form&nbsp;must&nbsp;be&nbsp;distributed&nbsp;only&nbsp;under&nbsp;the&nbsp;<br>
+terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;You&nbsp;must&nbsp;include&nbsp;a&nbsp;copy&nbsp;of&nbsp;this&nbsp;License&nbsp;with&nbsp;every&nbsp;copy&nbsp;<br>
+of&nbsp;the&nbsp;Source&nbsp;Code&nbsp;form&nbsp;of&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;You&nbsp;distribute&nbsp;or&nbsp;otherwise&nbsp;<br>
+make&nbsp;available.&nbsp;You&nbsp;must&nbsp;inform&nbsp;recipients&nbsp;of&nbsp;any&nbsp;such&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;<br>
+Executable&nbsp;form&nbsp;as&nbsp;to&nbsp;how&nbsp;they&nbsp;can&nbsp;obtain&nbsp;such&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;Source&nbsp;Code&nbsp;<br>
+form&nbsp;in&nbsp;a&nbsp;reasonable&nbsp;manner&nbsp;on&nbsp;or&nbsp;through&nbsp;a&nbsp;medium&nbsp;customarily&nbsp;used&nbsp;for&nbsp;<br>
+software&nbsp;exchange.&nbsp;<br>
+<br>
+3.2.&nbsp;Modifications.&nbsp;The&nbsp;Modifications&nbsp;that&nbsp;You&nbsp;create&nbsp;or&nbsp;to&nbsp;which&nbsp;You&nbsp;<br>
+contribute&nbsp;are&nbsp;governed&nbsp;by&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License.&nbsp;You&nbsp;represent&nbsp;that&nbsp;You&nbsp;<br>
+believe&nbsp;Your&nbsp;Modifications&nbsp;are&nbsp;Your&nbsp;original&nbsp;creation(s)&nbsp;and/or&nbsp;You&nbsp;have&nbsp;<br>
+sufficient&nbsp;rights&nbsp;to&nbsp;grant&nbsp;the&nbsp;rights&nbsp;conveyed&nbsp;by&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+3.3.&nbsp;Required&nbsp;Notices.&nbsp;You&nbsp;must&nbsp;include&nbsp;a&nbsp;notice&nbsp;in&nbsp;each&nbsp;of&nbsp;Your&nbsp;Modifications&nbsp;<br>
+that&nbsp;identifies&nbsp;You&nbsp;as&nbsp;the&nbsp;Contributor&nbsp;of&nbsp;the&nbsp;Modification.&nbsp;You&nbsp;may&nbsp;not&nbsp;remove&nbsp;<br>
+or&nbsp;alter&nbsp;any&nbsp;copyright,&nbsp;patent&nbsp;or&nbsp;trademark&nbsp;notices&nbsp;contained&nbsp;within&nbsp;the&nbsp;<br>
+Covered&nbsp;Software,&nbsp;or&nbsp;any&nbsp;notices&nbsp;of&nbsp;licensing&nbsp;or&nbsp;any&nbsp;descriptive&nbsp;text&nbsp;giving&nbsp;<br>
+attribution&nbsp;to&nbsp;any&nbsp;Contributor&nbsp;or&nbsp;the&nbsp;Initial&nbsp;Developer.&nbsp;<br>
+<br>
+3.4.&nbsp;Application&nbsp;of&nbsp;Additional&nbsp;Terms.&nbsp;You&nbsp;may&nbsp;not&nbsp;offer&nbsp;or&nbsp;impose&nbsp;any&nbsp;terms&nbsp;on&nbsp;<br>
+any&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;Source&nbsp;Code&nbsp;form&nbsp;that&nbsp;alters&nbsp;or&nbsp;restricts&nbsp;the&nbsp;<br>
+applicable&nbsp;version&nbsp;of&nbsp;this&nbsp;License&nbsp;or&nbsp;the&nbsp;recipients&nbsp;rights&nbsp;hereunder.&nbsp;You&nbsp;may&nbsp;<br>
+choose&nbsp;to&nbsp;offer,&nbsp;and&nbsp;to&nbsp;charge&nbsp;a&nbsp;fee&nbsp;for,&nbsp;warranty,&nbsp;support,&nbsp;indemnity&nbsp;or&nbsp;<br>
+liability&nbsp;obligations&nbsp;to&nbsp;one&nbsp;or&nbsp;more&nbsp;recipients&nbsp;of&nbsp;Covered&nbsp;Software.&nbsp;However,&nbsp;<br>
+you&nbsp;may&nbsp;do&nbsp;so&nbsp;only&nbsp;on&nbsp;Your&nbsp;own&nbsp;behalf,&nbsp;and&nbsp;not&nbsp;on&nbsp;behalf&nbsp;of&nbsp;the&nbsp;Initial&nbsp;<br>
+Developer&nbsp;or&nbsp;any&nbsp;Contributor.&nbsp;You&nbsp;must&nbsp;make&nbsp;it&nbsp;absolutely&nbsp;clear&nbsp;that&nbsp;any&nbsp;such&nbsp;<br>
+warranty,&nbsp;support,&nbsp;indemnity&nbsp;or&nbsp;liability&nbsp;obligation&nbsp;is&nbsp;offered&nbsp;by&nbsp;You&nbsp;alone,&nbsp;<br>
+and&nbsp;You&nbsp;hereby&nbsp;agree&nbsp;to&nbsp;indemnify&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;and&nbsp;every&nbsp;Contributor&nbsp;<br>
+for&nbsp;any&nbsp;liability&nbsp;incurred&nbsp;by&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;or&nbsp;such&nbsp;Contributor&nbsp;as&nbsp;a&nbsp;<br>
+result&nbsp;of&nbsp;warranty,&nbsp;support,&nbsp;indemnity&nbsp;or&nbsp;liability&nbsp;terms&nbsp;You&nbsp;offer.<br>
+<br>
+3.5.&nbsp;Distribution&nbsp;of&nbsp;Executable&nbsp;Versions.&nbsp;You&nbsp;may&nbsp;distribute&nbsp;the&nbsp;Executable&nbsp;<br>
+form&nbsp;of&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License&nbsp;or&nbsp;under&nbsp;the&nbsp;terms&nbsp;<br>
+of&nbsp;a&nbsp;license&nbsp;of&nbsp;Your&nbsp;choice,&nbsp;which&nbsp;may&nbsp;contain&nbsp;terms&nbsp;different&nbsp;from&nbsp;this&nbsp;<br>
+License,&nbsp;provided&nbsp;that&nbsp;You&nbsp;are&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License&nbsp;and&nbsp;<br>
+that&nbsp;the&nbsp;license&nbsp;for&nbsp;the&nbsp;Executable&nbsp;form&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;limit&nbsp;or&nbsp;alter&nbsp;the&nbsp;<br>
+recipients&nbsp;rights&nbsp;in&nbsp;the&nbsp;Source&nbsp;Code&nbsp;form&nbsp;from&nbsp;the&nbsp;rights&nbsp;set&nbsp;forth&nbsp;in&nbsp;this&nbsp;<br>
+License.&nbsp;If&nbsp;You&nbsp;distribute&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;Executable&nbsp;form&nbsp;under&nbsp;a&nbsp;<br>
+different&nbsp;license,&nbsp;You&nbsp;must&nbsp;make&nbsp;it&nbsp;absolutely&nbsp;clear&nbsp;that&nbsp;any&nbsp;terms&nbsp;which&nbsp;<br>
+differ&nbsp;from&nbsp;this&nbsp;License&nbsp;are&nbsp;offered&nbsp;by&nbsp;You&nbsp;alone,&nbsp;not&nbsp;by&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;<br>
+or&nbsp;Contributor.&nbsp;You&nbsp;hereby&nbsp;agree&nbsp;to&nbsp;indemnify&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;and&nbsp;every&nbsp;<br>
+Contributor&nbsp;for&nbsp;any&nbsp;liability&nbsp;incurred&nbsp;by&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;or&nbsp;such&nbsp;<br>
+Contributor&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;any&nbsp;such&nbsp;terms&nbsp;You&nbsp;offer.&nbsp;<br>
+<br>
+3.6.&nbsp;Larger&nbsp;Works.&nbsp;You&nbsp;may&nbsp;create&nbsp;a&nbsp;Larger&nbsp;Work&nbsp;by&nbsp;combining&nbsp;Covered&nbsp;Software&nbsp;<br>
+with&nbsp;other&nbsp;code&nbsp;not&nbsp;governed&nbsp;by&nbsp;the&nbsp;terms&nbsp;of&nbsp;this&nbsp;License&nbsp;and&nbsp;distribute&nbsp;the&nbsp;<br>
+Larger&nbsp;Work&nbsp;as&nbsp;a&nbsp;single&nbsp;product.&nbsp;In&nbsp;such&nbsp;a&nbsp;case,&nbsp;You&nbsp;must&nbsp;make&nbsp;sure&nbsp;the&nbsp;<br>
+requirements&nbsp;of&nbsp;this&nbsp;License&nbsp;are&nbsp;fulfilled&nbsp;for&nbsp;the&nbsp;Covered&nbsp;Software.&nbsp;<br>
+<br>
+4.&nbsp;Versions&nbsp;of&nbsp;the&nbsp;License.&nbsp;<br>
+<br>
+4.1.&nbsp;New&nbsp;Versions.&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;is&nbsp;the&nbsp;initial&nbsp;license&nbsp;steward&nbsp;and&nbsp;<br>
+may&nbsp;publish&nbsp;revised&nbsp;and/or&nbsp;new&nbsp;versions&nbsp;of&nbsp;this&nbsp;License&nbsp;from&nbsp;time&nbsp;to&nbsp;time.&nbsp;Each&nbsp;<br>
+version&nbsp;will&nbsp;be&nbsp;given&nbsp;a&nbsp;distinguishing&nbsp;version&nbsp;number.&nbsp;Except&nbsp;as&nbsp;provided&nbsp;in&nbsp;<br>
+Section&nbsp;4.3,&nbsp;no&nbsp;one&nbsp;other&nbsp;than&nbsp;the&nbsp;license&nbsp;steward&nbsp;has&nbsp;the&nbsp;right&nbsp;to&nbsp;modify&nbsp;this&nbsp;<br>
+License.&nbsp;<br>
+<br>
+4.2.&nbsp;Effect&nbsp;of&nbsp;New&nbsp;Versions.&nbsp;You&nbsp;may&nbsp;always&nbsp;continue&nbsp;to&nbsp;use,&nbsp;distribute&nbsp;or&nbsp;<br>
+otherwise&nbsp;make&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;available&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;version&nbsp;of&nbsp;<br>
+the&nbsp;License&nbsp;under&nbsp;which&nbsp;You&nbsp;originally&nbsp;received&nbsp;the&nbsp;Covered&nbsp;Software.&nbsp;If&nbsp;the&nbsp;<br>
+Initial&nbsp;Developer&nbsp;includes&nbsp;a&nbsp;notice&nbsp;in&nbsp;the&nbsp;Original&nbsp;Software&nbsp;prohibiting&nbsp;it&nbsp;<br>
+from&nbsp;being&nbsp;distributed&nbsp;or&nbsp;otherwise&nbsp;made&nbsp;available&nbsp;under&nbsp;any&nbsp;subsequent&nbsp;version&nbsp;<br>
+of&nbsp;the&nbsp;License,&nbsp;You&nbsp;must&nbsp;distribute&nbsp;and&nbsp;make&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;available&nbsp;<br>
+under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;version&nbsp;of&nbsp;the&nbsp;License&nbsp;under&nbsp;which&nbsp;You&nbsp;originally&nbsp;<br>
+received&nbsp;the&nbsp;Covered&nbsp;Software.&nbsp;Otherwise,&nbsp;You&nbsp;may&nbsp;also&nbsp;choose&nbsp;to&nbsp;use,&nbsp;<br>
+distribute&nbsp;or&nbsp;otherwise&nbsp;make&nbsp;the&nbsp;Covered&nbsp;Software&nbsp;available&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;<br>
+any&nbsp;subsequent&nbsp;version&nbsp;of&nbsp;the&nbsp;License&nbsp;published&nbsp;by&nbsp;the&nbsp;license&nbsp;steward.&nbsp;<br>
+<br>
+4.3.&nbsp;Modified&nbsp;Versions.&nbsp;When&nbsp;You&nbsp;are&nbsp;an&nbsp;Initial&nbsp;Developer&nbsp;and&nbsp;You&nbsp;want&nbsp;to&nbsp;<br>
+create&nbsp;a&nbsp;new&nbsp;license&nbsp;for&nbsp;Your&nbsp;Original&nbsp;Software,&nbsp;You&nbsp;may&nbsp;create&nbsp;and&nbsp;use&nbsp;a&nbsp;<br>
+modified&nbsp;version&nbsp;of&nbsp;this&nbsp;License&nbsp;if&nbsp;You:&nbsp;(a)&nbsp;rename&nbsp;the&nbsp;license&nbsp;and&nbsp;remove&nbsp;any&nbsp;<br>
+references&nbsp;to&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;license&nbsp;steward&nbsp;(except&nbsp;to&nbsp;note&nbsp;that&nbsp;the&nbsp;license&nbsp;<br>
+differs&nbsp;from&nbsp;this&nbsp;License);&nbsp;and&nbsp;(b)&nbsp;otherwise&nbsp;make&nbsp;it&nbsp;clear&nbsp;that&nbsp;the&nbsp;license&nbsp;<br>
+contains&nbsp;terms&nbsp;which&nbsp;differ&nbsp;from&nbsp;this&nbsp;License.&nbsp;<br>
+<br>
+5.&nbsp;DISCLAIMER&nbsp;OF&nbsp;WARRANTY.&nbsp;COVERED&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;UNDER&nbsp;THIS&nbsp;LICENSE&nbsp;ON&nbsp;<br>
+AN&nbsp;AS&nbsp;IS&nbsp;BASIS,&nbsp;WITHOUT&nbsp;WARRANTY&nbsp;OF&nbsp;ANY&nbsp;KIND,&nbsp;EITHER&nbsp;EXPRESSED&nbsp;OR&nbsp;IMPLIED,&nbsp;<br>
+INCLUDING,&nbsp;WITHOUT&nbsp;LIMITATION,&nbsp;WARRANTIES&nbsp;THAT&nbsp;THE&nbsp;COVERED&nbsp;SOFTWARE&nbsp;IS&nbsp;FREE&nbsp;OF&nbsp;<br>
+DEFECTS,&nbsp;MERCHANTABLE,&nbsp;FIT&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;OR&nbsp;NON-INFRINGING.&nbsp;THE&nbsp;<br>
+ENTIRE&nbsp;RISK&nbsp;AS&nbsp;TO&nbsp;THE&nbsp;QUALITY&nbsp;AND&nbsp;PERFORMANCE&nbsp;OF&nbsp;THE&nbsp;COVERED&nbsp;SOFTWARE&nbsp;IS&nbsp;WITH&nbsp;<br>
+YOU.&nbsp;SHOULD&nbsp;ANY&nbsp;COVERED&nbsp;SOFTWARE&nbsp;PROVE&nbsp;DEFECTIVE&nbsp;IN&nbsp;ANY&nbsp;RESPECT,&nbsp;YOU&nbsp;(NOT&nbsp;THE&nbsp;<br>
+INITIAL&nbsp;DEVELOPER&nbsp;OR&nbsp;ANY&nbsp;OTHER&nbsp;CONTRIBUTOR)&nbsp;ASSUME&nbsp;THE&nbsp;COST&nbsp;OF&nbsp;ANY&nbsp;NECESSARY&nbsp;<br>
+SERVICING,&nbsp;REPAIR&nbsp;OR&nbsp;CORRECTION.&nbsp;THIS&nbsp;DISCLAIMER&nbsp;OF&nbsp;WARRANTY&nbsp;CONSTITUTES&nbsp;AN&nbsp;<br>
+ESSENTIAL&nbsp;PART&nbsp;OF&nbsp;THIS&nbsp;LICENSE.&nbsp;NO&nbsp;USE&nbsp;OF&nbsp;ANY&nbsp;COVERED&nbsp;SOFTWARE&nbsp;IS&nbsp;AUTHORIZED&nbsp;<br>
+HEREUNDER&nbsp;EXCEPT&nbsp;UNDER&nbsp;THIS&nbsp;DISCLAIMER.&nbsp;<br>
+<br>
+6.&nbsp;TERMINATION.&nbsp;<br>
+<br>
+6.1.&nbsp;This&nbsp;License&nbsp;and&nbsp;the&nbsp;rights&nbsp;granted&nbsp;hereunder&nbsp;will&nbsp;terminate&nbsp;automatically&nbsp;<br>
+if&nbsp;You&nbsp;fail&nbsp;to&nbsp;comply&nbsp;with&nbsp;terms&nbsp;herein&nbsp;and&nbsp;fail&nbsp;to&nbsp;cure&nbsp;such&nbsp;breach&nbsp;within&nbsp;30&nbsp;<br>
+days&nbsp;of&nbsp;becoming&nbsp;aware&nbsp;of&nbsp;the&nbsp;breach.&nbsp;Provisions&nbsp;which,&nbsp;by&nbsp;their&nbsp;nature,&nbsp;must&nbsp;<br>
+remain&nbsp;in&nbsp;effect&nbsp;beyond&nbsp;the&nbsp;termination&nbsp;of&nbsp;this&nbsp;License&nbsp;shall&nbsp;survive.&nbsp;<br>
+<br>
+6.2.&nbsp;If&nbsp;You&nbsp;assert&nbsp;a&nbsp;patent&nbsp;infringement&nbsp;claim&nbsp;(excluding&nbsp;declaratory&nbsp;judgment&nbsp;<br>
+actions)&nbsp;against&nbsp;Initial&nbsp;Developer&nbsp;or&nbsp;a&nbsp;Contributor&nbsp;(the&nbsp;Initial&nbsp;Developer&nbsp;or&nbsp;<br>
+Contributor&nbsp;against&nbsp;whom&nbsp;You&nbsp;assert&nbsp;such&nbsp;claim&nbsp;is&nbsp;referred&nbsp;to&nbsp;as&nbsp;Participant)&nbsp;<br>
+alleging&nbsp;that&nbsp;the&nbsp;Participant&nbsp;Software&nbsp;(meaning&nbsp;the&nbsp;Contributor&nbsp;Version&nbsp;where&nbsp;<br>
+the&nbsp;Participant&nbsp;is&nbsp;a&nbsp;Contributor&nbsp;or&nbsp;the&nbsp;Original&nbsp;Software&nbsp;where&nbsp;the&nbsp;Participant&nbsp;<br>
+is&nbsp;the&nbsp;Initial&nbsp;Developer)&nbsp;directly&nbsp;or&nbsp;indirectly&nbsp;infringes&nbsp;any&nbsp;patent,&nbsp;then&nbsp;any&nbsp;<br>
+and&nbsp;all&nbsp;rights&nbsp;granted&nbsp;directly&nbsp;or&nbsp;indirectly&nbsp;to&nbsp;You&nbsp;by&nbsp;such&nbsp;Participant,&nbsp;the&nbsp;<br>
+Initial&nbsp;Developer&nbsp;(if&nbsp;the&nbsp;Initial&nbsp;Developer&nbsp;is&nbsp;not&nbsp;the&nbsp;Participant)&nbsp;and&nbsp;all&nbsp;<br>
+Contributors&nbsp;under&nbsp;Sections&nbsp;2.1&nbsp;and/or&nbsp;2.2&nbsp;of&nbsp;this&nbsp;License&nbsp;shall,&nbsp;upon&nbsp;60&nbsp;days&nbsp;<br>
+notice&nbsp;from&nbsp;Participant&nbsp;terminate&nbsp;prospectively&nbsp;and&nbsp;automatically&nbsp;at&nbsp;the&nbsp;<br>
+expiration&nbsp;of&nbsp;such&nbsp;60&nbsp;day&nbsp;notice&nbsp;period,&nbsp;unless&nbsp;if&nbsp;within&nbsp;such&nbsp;60&nbsp;day&nbsp;period&nbsp;<br>
+You&nbsp;withdraw&nbsp;Your&nbsp;claim&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;Participant&nbsp;Software&nbsp;against&nbsp;such&nbsp;<br>
+Participant&nbsp;either&nbsp;unilaterally&nbsp;or&nbsp;pursuant&nbsp;to&nbsp;a&nbsp;written&nbsp;agreement&nbsp;with&nbsp;<br>
+Participant.&nbsp;<br>
+<br>
+6.3.&nbsp;In&nbsp;the&nbsp;event&nbsp;of&nbsp;termination&nbsp;under&nbsp;Sections&nbsp;6.1&nbsp;or&nbsp;6.2&nbsp;above,&nbsp;all&nbsp;end&nbsp;user&nbsp;<br>
+licenses&nbsp;that&nbsp;have&nbsp;been&nbsp;validly&nbsp;granted&nbsp;by&nbsp;You&nbsp;or&nbsp;any&nbsp;distributor&nbsp;hereunder&nbsp;<br>
+prior&nbsp;to&nbsp;termination&nbsp;(excluding&nbsp;licenses&nbsp;granted&nbsp;to&nbsp;You&nbsp;by&nbsp;any&nbsp;distributor)&nbsp;<br>
+shall&nbsp;survive&nbsp;termination.&nbsp;<br>
+<br>
+7.&nbsp;LIMITATION&nbsp;OF&nbsp;LIABILITY.&nbsp;UNDER&nbsp;NO&nbsp;CIRCUMSTANCES&nbsp;AND&nbsp;UNDER&nbsp;NO&nbsp;LEGAL&nbsp;THEORY,&nbsp;<br>
+WHETHER&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE),&nbsp;CONTRACT,&nbsp;OR&nbsp;OTHERWISE,&nbsp;SHALL&nbsp;YOU,&nbsp;THE&nbsp;<br>
+INITIAL&nbsp;DEVELOPER,&nbsp;ANY&nbsp;OTHER&nbsp;CONTRIBUTOR,&nbsp;OR&nbsp;ANY&nbsp;DISTRIBUTOR&nbsp;OF&nbsp;COVERED&nbsp;<br>
+SOFTWARE,&nbsp;OR&nbsp;ANY&nbsp;SUPPLIER&nbsp;OF&nbsp;ANY&nbsp;OF&nbsp;SUCH&nbsp;PARTIES,&nbsp;BE&nbsp;LIABLE&nbsp;TO&nbsp;ANY&nbsp;PERSON&nbsp;FOR&nbsp;<br>
+ANY&nbsp;INDIRECT,&nbsp;SPECIAL,&nbsp;INCIDENTAL,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;OF&nbsp;ANY&nbsp;CHARACTER&nbsp;<br>
+INCLUDING,&nbsp;WITHOUT&nbsp;LIMITATION,&nbsp;DAMAGES&nbsp;FOR&nbsp;LOST&nbsp;PROFITS,&nbsp;LOSS&nbsp;OF&nbsp;GOODWILL,&nbsp;WORK&nbsp;<br>
+STOPPAGE,&nbsp;COMPUTER&nbsp;FAILURE&nbsp;OR&nbsp;MALFUNCTION,&nbsp;OR&nbsp;ANY&nbsp;AND&nbsp;ALL&nbsp;OTHER&nbsp;COMMERCIAL&nbsp;<br>
+DAMAGES&nbsp;OR&nbsp;LOSSES,&nbsp;EVEN&nbsp;IF&nbsp;SUCH&nbsp;PARTY&nbsp;SHALL&nbsp;HAVE&nbsp;BEEN&nbsp;INFORMED&nbsp;OF&nbsp;THE&nbsp;<br>
+POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGES.&nbsp;THIS&nbsp;LIMITATION&nbsp;OF&nbsp;LIABILITY&nbsp;SHALL&nbsp;NOT&nbsp;APPLY&nbsp;TO&nbsp;<br>
+LIABILITY&nbsp;FOR&nbsp;DEATH&nbsp;OR&nbsp;PERSONAL&nbsp;INJURY&nbsp;RESULTING&nbsp;FROM&nbsp;SUCH&nbsp;PARTYS&nbsp;NEGLIGENCE&nbsp;TO&nbsp;<br>
+THE&nbsp;EXTENT&nbsp;APPLICABLE&nbsp;LAW&nbsp;PROHIBITS&nbsp;SUCH&nbsp;LIMITATION.&nbsp;SOME&nbsp;JURISDICTIONS&nbsp;DO&nbsp;NOT&nbsp;<br>
+ALLOW&nbsp;THE&nbsp;EXCLUSION&nbsp;OR&nbsp;LIMITATION&nbsp;OF&nbsp;INCIDENTAL&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES,&nbsp;SO&nbsp;<br>
+THIS&nbsp;EXCLUSION&nbsp;AND&nbsp;LIMITATION&nbsp;MAY&nbsp;NOT&nbsp;APPLY&nbsp;TO&nbsp;YOU.&nbsp;<br>
+<br>
+8.&nbsp;U.S.&nbsp;GOVERNMENT&nbsp;END&nbsp;USERS.&nbsp;The&nbsp;Covered&nbsp;Software&nbsp;is&nbsp;a&nbsp;commercial&nbsp;item,&nbsp;as&nbsp;<br>
+that&nbsp;term&nbsp;is&nbsp;defined&nbsp;in&nbsp;48&nbsp;C.F.R.&nbsp;2.101&nbsp;(Oct.&nbsp;1995),&nbsp;consisting&nbsp;of&nbsp;commercial&nbsp;<br>
+computer&nbsp;software&nbsp;(as&nbsp;that&nbsp;term&nbsp;is&nbsp;defined&nbsp;at&nbsp;48&nbsp;C.F.R.&nbsp;252.227-7014(a)(1))&nbsp;and&nbsp;<br>
+commercial&nbsp;computer&nbsp;software&nbsp;documentation&nbsp;as&nbsp;such&nbsp;terms&nbsp;are&nbsp;used&nbsp;in&nbsp;48&nbsp;C.F.R.&nbsp;<br>
+12.212&nbsp;(Sept.&nbsp;1995).&nbsp;Consistent&nbsp;with&nbsp;48&nbsp;C.F.R.&nbsp;12.212&nbsp;and&nbsp;48&nbsp;C.F.R.&nbsp;227.7202-1&nbsp;<br>
+through&nbsp;227.7202-4&nbsp;(June&nbsp;1995),&nbsp;all&nbsp;U.S.&nbsp;Government&nbsp;End&nbsp;Users&nbsp;acquire&nbsp;Covered&nbsp;<br>
+Software&nbsp;with&nbsp;only&nbsp;those&nbsp;rights&nbsp;set&nbsp;forth&nbsp;herein.&nbsp;This&nbsp;U.S.&nbsp;Government&nbsp;Rights&nbsp;<br>
+clause&nbsp;is&nbsp;in&nbsp;lieu&nbsp;of,&nbsp;and&nbsp;supersedes,&nbsp;any&nbsp;other&nbsp;FAR,&nbsp;DFAR,&nbsp;or&nbsp;other&nbsp;clause&nbsp;or&nbsp;<br>
+provision&nbsp;that&nbsp;addresses&nbsp;Government&nbsp;rights&nbsp;in&nbsp;computer&nbsp;software&nbsp;under&nbsp;this&nbsp;<br>
+License.&nbsp;<br>
+<br>
+9.&nbsp;MISCELLANEOUS.&nbsp;This&nbsp;License&nbsp;represents&nbsp;the&nbsp;complete&nbsp;agreement&nbsp;concerning&nbsp;<br>
+subject&nbsp;matter&nbsp;hereof.&nbsp;If&nbsp;any&nbsp;provision&nbsp;of&nbsp;this&nbsp;License&nbsp;is&nbsp;held&nbsp;to&nbsp;be&nbsp;<br>
+unenforceable,&nbsp;such&nbsp;provision&nbsp;shall&nbsp;be&nbsp;reformed&nbsp;only&nbsp;to&nbsp;the&nbsp;extent&nbsp;necessary&nbsp;to&nbsp;<br>
+make&nbsp;it&nbsp;enforceable.&nbsp;This&nbsp;License&nbsp;shall&nbsp;be&nbsp;governed&nbsp;by&nbsp;the&nbsp;law&nbsp;of&nbsp;the&nbsp;<br>
+jurisdiction&nbsp;specified&nbsp;in&nbsp;a&nbsp;notice&nbsp;contained&nbsp;within&nbsp;the&nbsp;Original&nbsp;Software&nbsp;<br>
+(except&nbsp;to&nbsp;the&nbsp;extent&nbsp;applicable&nbsp;law,&nbsp;if&nbsp;any,&nbsp;provides&nbsp;otherwise),&nbsp;excluding&nbsp;<br>
+such&nbsp;jurisdictions&nbsp;conflict-of-law&nbsp;provisions.&nbsp;Any&nbsp;litigation&nbsp;relating&nbsp;to&nbsp;this&nbsp;<br>
+License&nbsp;shall&nbsp;be&nbsp;subject&nbsp;to&nbsp;the&nbsp;jurisdiction&nbsp;of&nbsp;the&nbsp;courts&nbsp;located&nbsp;in&nbsp;the&nbsp;<br>
+jurisdiction&nbsp;and&nbsp;venue&nbsp;specified&nbsp;in&nbsp;a&nbsp;notice&nbsp;contained&nbsp;within&nbsp;the&nbsp;Original&nbsp;<br>
+Software,&nbsp;with&nbsp;the&nbsp;losing&nbsp;party&nbsp;responsible&nbsp;for&nbsp;costs,&nbsp;including,&nbsp;without&nbsp;<br>
+limitation,&nbsp;court&nbsp;costs&nbsp;and&nbsp;reasonable&nbsp;attorneys&nbsp;fees&nbsp;and&nbsp;expenses.&nbsp;The&nbsp;<br>
+application&nbsp;of&nbsp;the&nbsp;United&nbsp;Nations&nbsp;Convention&nbsp;on&nbsp;Contracts&nbsp;for&nbsp;the&nbsp;International&nbsp;<br>
+Sale&nbsp;of&nbsp;Goods&nbsp;is&nbsp;expressly&nbsp;excluded.&nbsp;Any&nbsp;law&nbsp;or&nbsp;regulation&nbsp;which&nbsp;provides&nbsp;that&nbsp;<br>
+the&nbsp;language&nbsp;of&nbsp;a&nbsp;contract&nbsp;shall&nbsp;be&nbsp;construed&nbsp;against&nbsp;the&nbsp;drafter&nbsp;shall&nbsp;not&nbsp;<br>
+apply&nbsp;to&nbsp;this&nbsp;License.&nbsp;You&nbsp;agree&nbsp;that&nbsp;You&nbsp;alone&nbsp;are&nbsp;responsible&nbsp;for&nbsp;compliance&nbsp;<br>
+with&nbsp;the&nbsp;United&nbsp;States&nbsp;export&nbsp;administration&nbsp;regulations&nbsp;(and&nbsp;the&nbsp;export&nbsp;<br>
+control&nbsp;laws&nbsp;and&nbsp;regulation&nbsp;of&nbsp;any&nbsp;other&nbsp;countries)&nbsp;when&nbsp;You&nbsp;use,&nbsp;distribute&nbsp;or&nbsp;<br>
+otherwise&nbsp;make&nbsp;available&nbsp;any&nbsp;Covered&nbsp;Software.<br>
+<br>
+10.&nbsp;RESPONSIBILITY&nbsp;FOR&nbsp;CLAIMS.&nbsp;As&nbsp;between&nbsp;Initial&nbsp;Developer&nbsp;and&nbsp;the&nbsp;<br>
+Contributors,&nbsp;each&nbsp;party&nbsp;is&nbsp;responsible&nbsp;for&nbsp;claims&nbsp;and&nbsp;damages&nbsp;arising,&nbsp;<br>
+directly&nbsp;or&nbsp;indirectly,&nbsp;out&nbsp;of&nbsp;its&nbsp;utilization&nbsp;of&nbsp;rights&nbsp;under&nbsp;this&nbsp;License&nbsp;and&nbsp;<br>
+You&nbsp;agree&nbsp;to&nbsp;work&nbsp;with&nbsp;Initial&nbsp;Developer&nbsp;and&nbsp;Contributors&nbsp;to&nbsp;distribute&nbsp;such&nbsp;<br>
+responsibility&nbsp;on&nbsp;an&nbsp;equitable&nbsp;basis.&nbsp;Nothing&nbsp;herein&nbsp;is&nbsp;intended&nbsp;or&nbsp;shall&nbsp;be&nbsp;<br>
+deemed&nbsp;to&nbsp;constitute&nbsp;any&nbsp;admission&nbsp;of&nbsp;liability.&nbsp;<br>
+<br>
+NOTICE&nbsp;PURSUANT&nbsp;TO&nbsp;SECTION&nbsp;9&nbsp;OF&nbsp;THE&nbsp;COMMON&nbsp;DEVELOPMENT&nbsp;AND&nbsp;DISTRIBUTION&nbsp;LICENSE&nbsp;<br>
+(CDDL)<br>
+<br>
+For&nbsp;Covered&nbsp;Software&nbsp;in&nbsp;this&nbsp;distribution,&nbsp;this&nbsp;License&nbsp;shall&nbsp;be&nbsp;governed&nbsp;by&nbsp;<br>
+the&nbsp;laws&nbsp;of&nbsp;the&nbsp;State&nbsp;of&nbsp;California&nbsp;(excluding&nbsp;conflict-of-law&nbsp;provisions).<br>
+<br>
+Any&nbsp;litigation&nbsp;relating&nbsp;to&nbsp;this&nbsp;License&nbsp;shall&nbsp;be&nbsp;subject&nbsp;to&nbsp;the&nbsp;jurisdiction&nbsp;of&nbsp;<br>
+the&nbsp;Federal&nbsp;Courts&nbsp;of&nbsp;the&nbsp;Northern&nbsp;District&nbsp;of&nbsp;California&nbsp;and&nbsp;the&nbsp;state&nbsp;courts&nbsp;<br>
+of&nbsp;the&nbsp;State&nbsp;of&nbsp;California,&nbsp;with&nbsp;venue&nbsp;lying&nbsp;in&nbsp;Santa&nbsp;Clara&nbsp;County,&nbsp;California.<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/legal/CDDLv1.0.txt<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkpomxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/pom.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,128&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;project&nbsp;xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;parent&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-parent&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;1.2.7&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/parent&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-http-framework&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;packaging&amp;gt;pom&amp;lt;/packaging&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;name&amp;gt;Commons&nbsp;HTTP&nbsp;Framework&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;description&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HTTP&nbsp;framework&nbsp;provides&nbsp;a&nbsp;uniform&nbsp;client/server&nbsp;HTTP&nbsp;API,&nbsp;which&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;script&nbsp;friendly,&nbsp;and&nbsp;includes&nbsp;adapters&nbsp;for&nbsp;various&nbsp;common&nbsp;HTTP&nbsp;libraries<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;such&nbsp;as&nbsp;Servlet,&nbsp;Apache&nbsp;HTTP&nbsp;Clients,&nbsp;and&nbsp;Grizzly.<br>
+&nbsp;&nbsp;&amp;lt;/description&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;url&amp;gt;http://commons.forgerock.org/forgerock-http-framework&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modules&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;module&amp;gt;resource-core&amp;lt;/module&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;module&amp;gt;http-core&amp;lt;/module&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;module&amp;gt;http-servlet&amp;lt;/module&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;module&amp;gt;http-test&amp;lt;/module&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/modules&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;properties&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;maven.compiler.target&amp;gt;1.6&amp;lt;/maven.compiler.target&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;maven.compiler.source&amp;gt;1.6&amp;lt;/maven.compiler.source&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/properties&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;dependencyManagement&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependencies&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.testng&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;testng&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;6.8.8&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.mockito&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;mockito-all&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;1.9.5&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.assertj&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;assertj-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;1.6.1&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.commons&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-util&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;1.3.4&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;com.fasterxml.jackson.core&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;jackson-databind&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;2.4.3&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.slf4j&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;slf4j-api&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;1.7.5&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependencies&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/dependencyManagement&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;repositories&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;repository&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;id&amp;gt;forgerock-staging-repository&amp;lt;/id&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;name&amp;gt;ForgeRock&nbsp;Release&nbsp;Repository&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;http://maven.forgerock.org/repo/releases&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;snapshots&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;enabled&amp;gt;false&amp;lt;/enabled&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/snapshots&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/repository&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/repositories&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;issueManagement&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;system&amp;gt;jira&amp;lt;/system&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;https://bugster.forgerock.org/jira/browse/CHF&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/issueManagement&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;licenses&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;license&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;name&amp;gt;CDDL-1.0&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;http://www.opensource.org/licenses/CDDL-1.0&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;comments&amp;gt;Common&nbsp;Development&nbsp;and&nbsp;Distribution&nbsp;License&nbsp;(CDDL)&nbsp;1.0.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;license&nbsp;applies&nbsp;to&nbsp;OpenIG&nbsp;source&nbsp;code&nbsp;as&nbsp;indicated&nbsp;in&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source&nbsp;code.&amp;lt;/comments&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;distribution&amp;gt;repo&amp;lt;/distribution&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/license&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;license&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;name&amp;gt;CC&nbsp;BY-NC-ND&nbsp;3.0&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;http://creativecommons.org/licenses/by-nc-nd/3.0/&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;comments&amp;gt;Creative&nbsp;Commons&nbsp;Attribution-NonCommercial-NoDerivs&nbsp;3.0<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unported.&nbsp;This&nbsp;license&nbsp;applies&nbsp;to&nbsp;the&nbsp;site&nbsp;content,&nbsp;and&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentation&nbsp;as&nbsp;indicated&nbsp;in&nbsp;the&nbsp;documentation&nbsp;source&nbsp;code.&amp;lt;/comments&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;distribution&amp;gt;repo&amp;lt;/distribution&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/license&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/licenses&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;scm&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;https://svn.forgerock.org/commons/forgerock-http-framework/trunk/&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;connection&amp;gt;scm:svn:https://svn.forgerock.org/commons/forgerock-http-framework/trunk/&amp;lt;/connection&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;developerConnection&amp;gt;scm:svn:https://svn.forgerock.org/commons/forgerock-http-framework/trunk/&amp;lt;/developerConnection&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/scm&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;distributionManagement&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;site&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;id&amp;gt;forgerock.org&amp;lt;/id&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;name&amp;gt;ForgeRock&nbsp;Community&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;url&amp;gt;scp://forgerock.org/var/www/vhosts/commons.forgerock.org/httpdocs/forgerock-http-framework&amp;lt;/url&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/site&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/distributionManagement&amp;gt;<br>
+&amp;lt;/project&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/pom.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;propset&quot;&gt;&lt;h4&gt;Property&nbsp;changes:&nbsp;forgerock-http-framework/trunk/resource-core&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svnignore&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:ignore&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecorepomxml&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/pom.xml&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/pom.xml&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,59&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+&amp;lt;?xml&nbsp;version=&amp;quot;1.0&amp;quot;&nbsp;encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br>
+&amp;lt;!--<br>
+&nbsp;&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+<br>
+&nbsp;&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+<br>
+&nbsp;&nbsp;Copyright&nbsp;2010–2011&nbsp;ApexIdentity&nbsp;Inc.<br>
+&nbsp;&nbsp;Portions&nbsp;Copyright&nbsp;2011-2015&nbsp;ForgeRock&nbsp;AS.<br>
+--&amp;gt;<br>
+&amp;lt;project&nbsp;xmlns=&amp;quot;http://maven.apache.org/POM/4.0.0&amp;quot;&nbsp;xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;<br>
+&nbsp;&nbsp;xsi:schemaLocation=&amp;quot;http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd&amp;quot;&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;parent&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.http&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-http-framework&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/parent&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;resource-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;packaging&amp;gt;bundle&amp;lt;/packaging&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;name&amp;gt;Common&nbsp;HTTP&nbsp;and&nbsp;CREST&nbsp;APIs&amp;lt;/name&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;dependencies&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.forgerock.commons&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;forgerock-util&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.assertj&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;assertj-core&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.mockito&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;mockito-all&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;dependency&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.testng&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;testng&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/dependency&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/dependencies&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;build&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugins&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;extensions&amp;gt;true&amp;lt;/extensions&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugin&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;/plugins&amp;gt;<br>
+&nbsp;&nbsp;&amp;lt;/build&amp;gt;<br>
+&amp;lt;/project&amp;gt;<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/pom.xml<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreAbstractContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/AbstractContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/AbstractContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/AbstractContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,167&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core;<br>
+<br>
+import&nbsp;org.forgerock.util.Reject;<br>
+<br>
+import&nbsp;java.util.Iterator;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;base&nbsp;implementation&nbsp;of&nbsp;the&nbsp;context&nbsp;associated&nbsp;with&nbsp;a&nbsp;request&nbsp;currently<br>
+&nbsp;*&nbsp;being&nbsp;processed&nbsp;by&nbsp;a&nbsp;{@code&nbsp;Handler}.&nbsp;A&nbsp;request&nbsp;context&nbsp;can&nbsp;be&nbsp;used&nbsp;to<br>
+&nbsp;*&nbsp;query&nbsp;state&nbsp;information&nbsp;about&nbsp;the&nbsp;request.&nbsp;Implementations&nbsp;may&nbsp;provide<br>
+&nbsp;*&nbsp;additional&nbsp;information,&nbsp;time-stamp&nbsp;information,&nbsp;HTTP&nbsp;headers,&nbsp;etc.&nbsp;Contexts<br>
+&nbsp;*&nbsp;are&nbsp;linked&nbsp;together&nbsp;to&nbsp;form&nbsp;a&nbsp;parent-child&nbsp;chain&nbsp;of&nbsp;context,&nbsp;whose&nbsp;root&nbsp;is&nbsp;a<br>
+&nbsp;*&nbsp;{@link&nbsp;RootContext}.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;abstract&nbsp;class&nbsp;AbstractContext&nbsp;implements&nbsp;Context&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;id;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Context&nbsp;parent;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;{@code&nbsp;AbstractContext}&nbsp;with&nbsp;a&nbsp;{@code&nbsp;null}&nbsp;{@code&nbsp;id}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;AbstractContext(Context&nbsp;parent,&nbsp;String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(null,&nbsp;name,&nbsp;parent);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;{@code&nbsp;AbstractContext}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;id&nbsp;The&nbsp;id&nbsp;of&nbsp;the&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;AbstractContext(String&nbsp;id,&nbsp;String&nbsp;name,&nbsp;Context&nbsp;parent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.id&nbsp;=&nbsp;id;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.name&nbsp;=&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.parent&nbsp;=&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;String&nbsp;getContextName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;name;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;&amp;lt;T&nbsp;extends&nbsp;Context&amp;gt;&nbsp;T&nbsp;asContext(Class&amp;lt;T&amp;gt;&nbsp;clazz)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reject.ifNull(clazz,&nbsp;&amp;quot;clazz&nbsp;cannot&nbsp;be&nbsp;null&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;context&nbsp;=&nbsp;asContext0(clazz);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(context&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;No&nbsp;context&nbsp;of&nbsp;type&nbsp;&amp;quot;&nbsp;+&nbsp;clazz.getName()&nbsp;+&nbsp;&amp;quot;&nbsp;found.&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;Context&nbsp;getContext(String&nbsp;contextName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;context&nbsp;=&nbsp;getContext0(contextName);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(context&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;No&nbsp;context&nbsp;of&nbsp;named&nbsp;&amp;quot;&nbsp;+&nbsp;contextName&nbsp;+&nbsp;&amp;quot;&nbsp;found.&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;boolean&nbsp;containsContext(Class&amp;lt;?&nbsp;extends&nbsp;Context&amp;gt;&nbsp;clazz)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;asContext0(clazz)&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;boolean&nbsp;containsContext(String&nbsp;contextName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getContext0(contextName)&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;String&nbsp;getId()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(id&nbsp;==&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;!isRootContext())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getParent().getId();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;id;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;Context&nbsp;getParent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;parent;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;boolean&nbsp;isRootContext()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getParent()&nbsp;==&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;&amp;lt;T&nbsp;extends&nbsp;Context&amp;gt;&nbsp;T&nbsp;asContext0(final&nbsp;Class&amp;lt;T&amp;gt;&nbsp;clazz)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Context&nbsp;context&nbsp;=&nbsp;this;&nbsp;context&nbsp;!=&nbsp;null;&nbsp;context&nbsp;=&nbsp;context.getParent())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Class&amp;lt;?&amp;gt;&nbsp;contextClass&nbsp;=&nbsp;context.getClass();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(clazz.isAssignableFrom(contextClass))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;contextClass.asSubclass(clazz).cast(context);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Context&nbsp;getContext0(final&nbsp;String&nbsp;contextName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Context&nbsp;context&nbsp;=&nbsp;this;&nbsp;context&nbsp;!=&nbsp;null;&nbsp;context&nbsp;=&nbsp;context.getParent())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(context.getContextName().equals(contextName))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Iterator&amp;lt;Context&amp;gt;&nbsp;iterator()&nbsp;{&nbsp;//TODO&nbsp;to&nbsp;implement<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Iterator&amp;lt;Context&amp;gt;()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;hasNext()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+//<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Context&nbsp;next()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;&amp;lt;T&nbsp;extends&nbsp;Context&amp;gt;&nbsp;Iterator&amp;lt;T&amp;gt;&nbsp;iterator(Class&amp;lt;T&amp;gt;&nbsp;clazz)&nbsp;{&nbsp;//TODO&nbsp;to&nbsp;implement<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Iterator&amp;lt;T&amp;gt;()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;hasNext()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+//<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;T&nbsp;next()&nbsp;{<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/AbstractContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/Context.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/Context.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/Context.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,135&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;Copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core;<br>
+<br>
+import&nbsp;java.util.Iterator;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;The&nbsp;context&nbsp;associated&nbsp;with&nbsp;a&nbsp;request&nbsp;currently&nbsp;being&nbsp;processed&nbsp;by&nbsp;a&nbsp;{@code&nbsp;Handler}.<br>
+&nbsp;*&nbsp;A&nbsp;request&nbsp;context&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;query&nbsp;state&nbsp;information<br>
+&nbsp;*&nbsp;about&nbsp;the&nbsp;request.&nbsp;Implementations&nbsp;may&nbsp;provide&nbsp;additional&nbsp;information,<br>
+&nbsp;*&nbsp;time-stamp&nbsp;information,&nbsp;HTTP&nbsp;headers,&nbsp;etc.&nbsp;Contexts&nbsp;are&nbsp;linked&nbsp;together&nbsp;to<br>
+&nbsp;*&nbsp;form&nbsp;a&nbsp;parent-child&nbsp;chain&nbsp;of&nbsp;context,&nbsp;whose&nbsp;root&nbsp;is&nbsp;a&nbsp;{@link&nbsp;RootContext}.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;interface&nbsp;Context&nbsp;extends&nbsp;Iterable&amp;lt;Context&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Get&nbsp;this&nbsp;Context's&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;this&nbsp;object's&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getContextName();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;first&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;type&nbsp;is&nbsp;a&nbsp;sub-type&nbsp;of&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;{@code&nbsp;Context}&nbsp;class.&nbsp;The&nbsp;method&nbsp;first&nbsp;checks&nbsp;this&nbsp;context&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;see&nbsp;if&nbsp;it&nbsp;has&nbsp;the&nbsp;required&nbsp;type,&nbsp;before&nbsp;proceeding&nbsp;to&nbsp;the&nbsp;parent&nbsp;context,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;then&nbsp;continuing&nbsp;up&nbsp;the&nbsp;chain&nbsp;of&nbsp;parents&nbsp;until&nbsp;the&nbsp;root&nbsp;context&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;reached.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;context&nbsp;type.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;clazz<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;class&nbsp;of&nbsp;context&nbsp;to&nbsp;be&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;first&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;type&nbsp;is&nbsp;a&nbsp;sub-type&nbsp;of&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided&nbsp;{@code&nbsp;Context}&nbsp;class.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;no&nbsp;matching&nbsp;context&nbsp;was&nbsp;found&nbsp;in&nbsp;this&nbsp;context's&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;T&nbsp;extends&nbsp;Context&amp;gt;&nbsp;T&nbsp;asContext(Class&amp;lt;T&amp;gt;&nbsp;clazz);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;first&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;context&nbsp;name&nbsp;matches&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;contextName<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;context&nbsp;to&nbsp;be&nbsp;returned.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;first&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;name&nbsp;matches&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided&nbsp;context&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;no&nbsp;matching&nbsp;context&nbsp;was&nbsp;found&nbsp;in&nbsp;this&nbsp;context's&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;getContext(String&nbsp;contextName);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;type&nbsp;is&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;sub-type&nbsp;of&nbsp;the&nbsp;provided&nbsp;{@code&nbsp;Context}&nbsp;class.&nbsp;The&nbsp;method&nbsp;first&nbsp;checks<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;context&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;has&nbsp;the&nbsp;required&nbsp;type,&nbsp;before&nbsp;proceeding&nbsp;to&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;parent&nbsp;context,&nbsp;and&nbsp;then&nbsp;continuing&nbsp;up&nbsp;the&nbsp;chain&nbsp;of&nbsp;parents&nbsp;until&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;root&nbsp;context&nbsp;is&nbsp;reached.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;clazz<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;class&nbsp;of&nbsp;context&nbsp;to&nbsp;be&nbsp;checked.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;type&nbsp;is&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub-type&nbsp;of&nbsp;the&nbsp;provided&nbsp;{@code&nbsp;Context}&nbsp;class.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;containsContext(Class&amp;lt;?&nbsp;extends&nbsp;Context&amp;gt;&nbsp;clazz);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;matches&nbsp;the&nbsp;provided&nbsp;context&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;contextName<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;context&nbsp;to&nbsp;locate.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;context&nbsp;in&nbsp;the&nbsp;chain&nbsp;whose&nbsp;context&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;{@code&nbsp;contextName}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;containsContext(String&nbsp;contextName);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;unique&nbsp;ID&nbsp;identifying&nbsp;this&nbsp;context,&nbsp;usually&nbsp;a&nbsp;UUID.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;unique&nbsp;ID&nbsp;identifying&nbsp;this&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;getId();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;parent&nbsp;of&nbsp;this&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;parent&nbsp;of&nbsp;this&nbsp;context,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;context&nbsp;is&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;getParent();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;context&nbsp;is&nbsp;a&nbsp;root&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;context&nbsp;is&nbsp;a&nbsp;root&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isRootContext();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;iterator&nbsp;that&nbsp;iterates&nbsp;over&nbsp;the&nbsp;context&nbsp;hierarchy&nbsp;from&nbsp;child&nbsp;to&nbsp;the&nbsp;root&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;context&nbsp;iterator.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;Iterator&amp;lt;Context&amp;gt;&nbsp;iterator();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;iterator&nbsp;that&nbsp;iterates&nbsp;over&nbsp;the&nbsp;context&nbsp;hierarchy&nbsp;from&nbsp;child&nbsp;to&nbsp;the&nbsp;root&nbsp;context,&nbsp;for&nbsp;all&nbsp;contexts<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;that&nbsp;are&nbsp;of&nbsp;the&nbsp;given&nbsp;type.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;clazz&nbsp;The&nbsp;class&nbsp;of&nbsp;the&nbsp;context&nbsp;to&nbsp;iterate&nbsp;over.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;context&nbsp;to&nbsp;iterate&nbsp;over.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;context&nbsp;iterator.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&amp;lt;T&nbsp;extends&nbsp;Context&amp;gt;&nbsp;Iterator&amp;lt;T&amp;gt;&nbsp;iterator(Class&amp;lt;T&amp;gt;&nbsp;clazz);<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/Context.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreResourceNamejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ResourceName.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ResourceName.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ResourceName.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,750&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2013-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core;<br>
+<br>
+import&nbsp;static&nbsp;java.util.Arrays.asList;<br>
+<br>
+import&nbsp;java.nio.charset.Charset;<br>
+import&nbsp;java.util.BitSet;<br>
+import&nbsp;java.util.Collection;<br>
+import&nbsp;java.util.Iterator;<br>
+import&nbsp;java.util.Locale;<br>
+import&nbsp;java.util.NoSuchElementException;<br>
+import&nbsp;java.util.regex.Pattern;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;relative&nbsp;path,&nbsp;or&nbsp;URL,&nbsp;to&nbsp;a&nbsp;resource.&nbsp;A&nbsp;resource&nbsp;name&nbsp;is&nbsp;an&nbsp;ordered&nbsp;list&nbsp;of<br>
+&nbsp;*&nbsp;zero&nbsp;or&nbsp;more&nbsp;path&nbsp;elements&nbsp;in&nbsp;big-endian&nbsp;order.&nbsp;The&nbsp;string&nbsp;representation&nbsp;of<br>
+&nbsp;*&nbsp;a&nbsp;resource&nbsp;name&nbsp;conforms&nbsp;to&nbsp;the&nbsp;URL&nbsp;path&nbsp;encoding&nbsp;rules&nbsp;defined&nbsp;in&nbsp;&amp;lt;a<br>
+&nbsp;*&nbsp;href=&amp;quot;http://tools.ietf.org/html/rfc3986#section-3.3&amp;quot;&amp;gt;RFC&nbsp;3986&nbsp;section<br>
+&nbsp;*&nbsp;3.3&amp;lt;/a&amp;gt;:<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;path-abempty&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;begins&nbsp;with&nbsp;&amp;quot;/&amp;quot;&nbsp;or&nbsp;is&nbsp;empty<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;...<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;path-abempty&nbsp;&nbsp;=&nbsp;*(&nbsp;&amp;quot;/&amp;quot;&nbsp;segment&nbsp;)<br>
+&nbsp;*&nbsp;segment&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*pchar<br>
+&nbsp;*&nbsp;pchar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;unreserved&nbsp;/&nbsp;pct-encoded&nbsp;/&nbsp;sub-delims&nbsp;/&nbsp;&amp;quot;:&amp;quot;&nbsp;/&nbsp;&amp;quot;@&amp;quot;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;unreserved&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ALPHA&nbsp;/&nbsp;DIGIT&nbsp;/&nbsp;&amp;quot;-&amp;quot;&nbsp;/&nbsp;&amp;quot;.&amp;quot;&nbsp;/&nbsp;&amp;quot;_&amp;quot;&nbsp;/&nbsp;&amp;quot;~&amp;quot;<br>
+&nbsp;*&nbsp;pct-encoded&nbsp;&nbsp;&nbsp;=&nbsp;&amp;quot;%&amp;quot;&nbsp;HEXDIG&nbsp;HEXDIG<br>
+&nbsp;*&nbsp;sub-delims&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&amp;quot;!&amp;quot;&nbsp;/&nbsp;&amp;quot;$&amp;quot;&nbsp;/&nbsp;&amp;quot;&amp;amp;&amp;quot;&nbsp;/&nbsp;&amp;quot;'&amp;quot;&nbsp;/&nbsp;&amp;quot;(&amp;quot;&nbsp;/&nbsp;&amp;quot;)&amp;quot;<br>
+&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&amp;quot;*&amp;quot;&nbsp;/&nbsp;&amp;quot;+&amp;quot;&nbsp;/&nbsp;&amp;quot;,&amp;quot;&nbsp;/&nbsp;&amp;quot;;&amp;quot;&nbsp;/&nbsp;&amp;quot;=&amp;quot;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;HEXDIG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;DIGIT&nbsp;/&nbsp;&amp;quot;A&amp;quot;&nbsp;/&nbsp;&amp;quot;B&amp;quot;&nbsp;/&nbsp;&amp;quot;C&amp;quot;&nbsp;/&nbsp;&amp;quot;D&amp;quot;&nbsp;/&nbsp;&amp;quot;E&amp;quot;&nbsp;/&nbsp;&amp;quot;F&amp;quot;<br>
+&nbsp;*&nbsp;ALPHA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;%x41-5A&nbsp;/&nbsp;%x61-7A&nbsp;&nbsp;&nbsp;;&nbsp;A-Z&nbsp;/&nbsp;a-z<br>
+&nbsp;*&nbsp;DIGIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;%x30-39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;0-9<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;The&nbsp;empty&nbsp;resource&nbsp;name&nbsp;having&nbsp;zero&nbsp;path&nbsp;elements&nbsp;may&nbsp;be&nbsp;obtained&nbsp;by&nbsp;calling<br>
+&nbsp;*&nbsp;{@link&nbsp;#empty()}.&nbsp;Resource&nbsp;names&nbsp;are&nbsp;case&nbsp;insensitive&nbsp;and&nbsp;empty&nbsp;path&nbsp;elements<br>
+&nbsp;*&nbsp;are&nbsp;not&nbsp;allowed.&nbsp;In&nbsp;addition,&nbsp;resource&nbsp;names&nbsp;will&nbsp;be&nbsp;automatically&nbsp;trimmed<br>
+&nbsp;*&nbsp;such&nbsp;that&nbsp;any&nbsp;leading&nbsp;or&nbsp;trailing&nbsp;slashes&nbsp;are&nbsp;removed.&nbsp;In&nbsp;other&nbsp;words,&nbsp;all<br>
+&nbsp;*&nbsp;resource&nbsp;names&nbsp;will&nbsp;be&nbsp;considered&nbsp;to&nbsp;be&nbsp;&amp;quot;relative&amp;quot;.&nbsp;At&nbsp;the&nbsp;moment&nbsp;the<br>
+&nbsp;*&nbsp;relative&nbsp;path&nbsp;elements&nbsp;&amp;quot;.&amp;quot;&nbsp;and&nbsp;&amp;quot;..&amp;quot;&nbsp;are&nbsp;not&nbsp;supported.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;New&nbsp;resource&nbsp;names&nbsp;can&nbsp;be&nbsp;created&nbsp;from&nbsp;their&nbsp;string&nbsp;representation&nbsp;using<br>
+&nbsp;*&nbsp;{@link&nbsp;#valueOf(String)},&nbsp;or&nbsp;by&nbsp;deriving&nbsp;new&nbsp;resource&nbsp;names&nbsp;from&nbsp;existing<br>
+&nbsp;*&nbsp;values,&nbsp;e.g.&nbsp;using&nbsp;{@link&nbsp;#parent()}&nbsp;or&nbsp;{@link&nbsp;#child(Object)}.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;Example:<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;ResourceName&nbsp;base&nbsp;=&nbsp;ResourceName.valueOf(&amp;amp;quot;commons/rest&amp;amp;quot;);<br>
+&nbsp;*&nbsp;ResourceName&nbsp;child&nbsp;=&nbsp;base.child(&amp;amp;quot;hello&nbsp;world&amp;amp;quot;);<br>
+&nbsp;*&nbsp;child.toString();&nbsp;//&nbsp;commons/rest/hello%20world<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;ResourceName&nbsp;user&nbsp;=&nbsp;base.child(&amp;amp;quot;users&amp;amp;quot;).child(123);<br>
+&nbsp;*&nbsp;user.toString();&nbsp;//&nbsp;commons/rest/users/123<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;ResourceName&nbsp;implements&nbsp;Comparable&amp;lt;ResourceName&amp;gt;,&nbsp;Iterable&amp;lt;String&amp;gt;&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;ResourceName&nbsp;EMPTY&nbsp;=&nbsp;new&nbsp;ResourceName();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Non-safe&nbsp;characters&nbsp;are&nbsp;escaped&nbsp;as&nbsp;UTF-8&nbsp;octets&nbsp;using&nbsp;&amp;quot;%&amp;quot;&nbsp;HEXDIG&nbsp;HEXDIG<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;production.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;char&nbsp;URL_ESCAPE_CHAR&nbsp;=&nbsp;'%';<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Look&nbsp;up&nbsp;table&nbsp;for&nbsp;characters&nbsp;which&nbsp;do&nbsp;not&nbsp;need&nbsp;URL&nbsp;encoding.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;BitSet&nbsp;SAFE_URL_CHARS&nbsp;=&nbsp;new&nbsp;BitSet(128);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;These&nbsp;characters&nbsp;do&nbsp;not&nbsp;need&nbsp;encoding.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(char&nbsp;c&nbsp;:&nbsp;&amp;quot;-._~!$&amp;amp;'()*+,;=:@&amp;quot;.toCharArray())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAFE_URL_CHARS.set(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;ASCII&nbsp;alphanumeric&nbsp;characters&nbsp;are&nbsp;ok&nbsp;as&nbsp;well.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAFE_URL_CHARS.set('0',&nbsp;'9'&nbsp;+&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAFE_URL_CHARS.set('a',&nbsp;'z'&nbsp;+&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAFE_URL_CHARS.set('A',&nbsp;'Z'&nbsp;+&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;empty&nbsp;resource&nbsp;name&nbsp;whose&nbsp;string&nbsp;representation&nbsp;is&nbsp;the&nbsp;empty<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;string&nbsp;and&nbsp;which&nbsp;has&nbsp;zero&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;empty&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ResourceName&nbsp;empty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EMPTY;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;using&nbsp;the&nbsp;provided&nbsp;name&nbsp;template&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;unencoded&nbsp;path&nbsp;elements.&nbsp;This&nbsp;method&nbsp;first&nbsp;URL&nbsp;encodes&nbsp;each&nbsp;of&nbsp;the&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;elements&nbsp;and&nbsp;then&nbsp;substitutes&nbsp;them&nbsp;into&nbsp;the&nbsp;template&nbsp;using<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@link&nbsp;String#format(String,&nbsp;Object...)}.&nbsp;Finally,&nbsp;the&nbsp;formatted&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;parsed&nbsp;as&nbsp;a&nbsp;resource&nbsp;name&nbsp;using&nbsp;{@link&nbsp;#valueOf(String)}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;This&nbsp;method&nbsp;may&nbsp;be&nbsp;useful&nbsp;in&nbsp;cases&nbsp;where&nbsp;the&nbsp;structure&nbsp;of&nbsp;a&nbsp;resource&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;not&nbsp;known&nbsp;at&nbsp;compile&nbsp;time,&nbsp;for&nbsp;example,&nbsp;it&nbsp;may&nbsp;be&nbsp;obtained&nbsp;from&nbsp;a<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;configuration&nbsp;file.&nbsp;Example&nbsp;usage:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;String&nbsp;template&nbsp;=&nbsp;&amp;quot;rest/users/%s&amp;quot;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;ResourceName&nbsp;name&nbsp;=&nbsp;ResourceName.format(template,&nbsp;&amp;amp;quot;bjensen&amp;amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;template<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resource&nbsp;name&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pathElements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;path&nbsp;elements&nbsp;to&nbsp;be&nbsp;URL&nbsp;encoded&nbsp;and&nbsp;then&nbsp;substituted&nbsp;into<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;formatted&nbsp;template&nbsp;parsed&nbsp;as&nbsp;a&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;formatted&nbsp;template&nbsp;contains&nbsp;empty&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;#urlEncode(Object)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ResourceName&nbsp;format(final&nbsp;String&nbsp;template,&nbsp;final&nbsp;Object...&nbsp;pathElements)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String[]&nbsp;encodedPathElements&nbsp;=&nbsp;new&nbsp;String[pathElements.length];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;pathElements.length;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encodedPathElements[i]&nbsp;=&nbsp;urlEncode(pathElements[i]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;valueOf(String.format(template,&nbsp;(Object[])&nbsp;encodedPathElements));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;path&nbsp;decoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;object's&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;representation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;be&nbsp;URL&nbsp;path&nbsp;decoded.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;URL&nbsp;path&nbsp;decoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;object's&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;representation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;urlDecode(final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;First&nbsp;try&nbsp;fast-path&nbsp;decode&nbsp;of&nbsp;simple&nbsp;ASCII.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;value.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;size&nbsp;=&nbsp;s.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;size;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isUrlEscapeChar(s.charAt(i)))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Slow&nbsp;path.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;urlDecode0(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;UTF-8&nbsp;character&nbsp;set&nbsp;which&nbsp;will&nbsp;be&nbsp;used&nbsp;for&nbsp;percent&nbsp;encoding.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Charset&nbsp;UTF8&nbsp;=&nbsp;Charset.forName(&amp;quot;UTF-8&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;urlDecode0(String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder(s.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;size&nbsp;=&nbsp;s.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;byte[]&nbsp;buffer&nbsp;=&nbsp;new&nbsp;byte[size&nbsp;/&nbsp;3];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;size;)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;char&nbsp;c&nbsp;=&nbsp;s.charAt(i);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isUrlEscapeChar(c))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(c);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;bufferPos&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(;&nbsp;i&nbsp;&amp;lt;&nbsp;size&nbsp;&amp;amp;&amp;amp;&nbsp;isUrlEscapeChar(s.charAt(i));&nbsp;i&nbsp;+=&nbsp;3)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((i&nbsp;+&nbsp;2)&nbsp;&amp;gt;=&nbsp;size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;Path&nbsp;contains&nbsp;an&nbsp;incomplete&nbsp;percent&nbsp;encoding&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;hexPair&nbsp;=&nbsp;s.substring(i&nbsp;+&nbsp;1,&nbsp;i&nbsp;+&nbsp;3);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;octet&nbsp;=&nbsp;Integer.parseInt(hexPair,&nbsp;16);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(octet&nbsp;&amp;lt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;Path&nbsp;contains&nbsp;an&nbsp;invalid&nbsp;percent&nbsp;encoding&nbsp;'&amp;quot;&nbsp;+&nbsp;hexPair&nbsp;+&nbsp;&amp;quot;'&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer[bufferPos++]&nbsp;=&nbsp;(byte)&nbsp;octet;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(NumberFormatException&nbsp;e)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;quot;Path&nbsp;contains&nbsp;an&nbsp;invalid&nbsp;percent&nbsp;encoding&nbsp;'&amp;quot;&nbsp;+&nbsp;hexPair&nbsp;+&nbsp;&amp;quot;'&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(new&nbsp;String(buffer,&nbsp;0,&nbsp;bufferPos,&nbsp;UTF8));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;builder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;path&nbsp;encoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;object's&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;representation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;value&nbsp;to&nbsp;be&nbsp;URL&nbsp;path&nbsp;encoded.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;URL&nbsp;path&nbsp;encoding&nbsp;of&nbsp;the&nbsp;provided&nbsp;object's&nbsp;string<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;representation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;urlEncode(final&nbsp;Object&nbsp;value)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;First&nbsp;try&nbsp;fast-path&nbsp;encode&nbsp;of&nbsp;simple&nbsp;ASCII.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;value.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;size&nbsp;=&nbsp;s.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;size;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;c&nbsp;=&nbsp;s.charAt(i);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!SAFE_URL_CHARS.get(c))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Slow&nbsp;path.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;urlEncode0(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Fast&nbsp;lookup&nbsp;for&nbsp;encoding&nbsp;octets&nbsp;as&nbsp;hex.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;String[]&nbsp;byteToHex&nbsp;=&nbsp;new&nbsp;String[256];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;byteToHex.length;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byteToHex[i]&nbsp;=&nbsp;String.format(Locale.ENGLISH,&nbsp;&amp;quot;%02X&amp;quot;,&nbsp;i);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;urlEncode0(String&nbsp;s)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;byte[]&nbsp;utf8&nbsp;=&nbsp;s.getBytes(UTF8);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;size&nbsp;=&nbsp;utf8.length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder(size&nbsp;+&nbsp;16);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;size;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;octet&nbsp;=&nbsp;utf8[i]&nbsp;&amp;amp;&nbsp;0xff;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SAFE_URL_CHARS.get(octet))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append((char)&nbsp;octet);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(URL_ESCAPE_CHAR);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(byteToHex[octet]);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;builder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Compiled&nbsp;regular&nbsp;expression&nbsp;for&nbsp;splitting&nbsp;resource&nbsp;names&nbsp;into&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;Pattern&nbsp;PATH_SPLITTER&nbsp;=&nbsp;Pattern.compile(&amp;quot;/&amp;quot;);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Parses&nbsp;the&nbsp;provided&nbsp;string&nbsp;representation&nbsp;of&nbsp;a&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;URL-encoded&nbsp;resource&nbsp;name&nbsp;to&nbsp;be&nbsp;parsed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;provided&nbsp;string&nbsp;representation&nbsp;of&nbsp;a&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;resource&nbsp;name&nbsp;contains&nbsp;empty&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;#toString()<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ResourceName&nbsp;valueOf(final&nbsp;String&nbsp;path)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(path.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Fast-path.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EMPTY;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Split&nbsp;on&nbsp;path&nbsp;separators&nbsp;and&nbsp;trim&nbsp;leading&nbsp;slash&nbsp;or&nbsp;trailing&nbsp;slash.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String[]&nbsp;elements&nbsp;=&nbsp;PATH_SPLITTER.split(path,&nbsp;-1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;sz&nbsp;=&nbsp;elements.length;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;startIndex&nbsp;=&nbsp;elements[0].isEmpty()&nbsp;?&nbsp;1&nbsp;:&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;endIndex&nbsp;=&nbsp;sz&nbsp;&amp;gt;&nbsp;1&nbsp;&amp;amp;&amp;amp;&nbsp;elements[sz&nbsp;-&nbsp;1].isEmpty()&nbsp;?&nbsp;sz&nbsp;-&nbsp;1&nbsp;:&nbsp;sz;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(startIndex&nbsp;==&nbsp;endIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EMPTY;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Normalize&nbsp;the&nbsp;path&nbsp;elements&nbsp;checking&nbsp;for&nbsp;empty&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;trimmedPath&nbsp;=&nbsp;new&nbsp;StringBuilder(path.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;normalizedPath&nbsp;=&nbsp;new&nbsp;StringBuilder(path.length());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;startIndex;&nbsp;i&nbsp;&amp;lt;&nbsp;endIndex;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;element&nbsp;=&nbsp;elements[i];<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(element.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;Resource&nbsp;name&nbsp;'&amp;quot;&nbsp;+&nbsp;path<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;'&nbsp;contains&nbsp;empty&nbsp;path&nbsp;elements&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;normalizedElement&nbsp;=&nbsp;normalizePathElement(element,&nbsp;true);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;!=&nbsp;startIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trimmedPath.append('/');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizedPath.append('/');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trimmedPath.append(element);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizedPath.append(normalizedElement);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(trimmedPath.toString(),&nbsp;normalizedPath.toString(),&nbsp;endIndex<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;startIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;boolean&nbsp;isUrlEscapeChar(final&nbsp;char&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c&nbsp;==&nbsp;URL_ESCAPE_CHAR;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;String&nbsp;normalizePathElement(final&nbsp;String&nbsp;element,&nbsp;final&nbsp;boolean&nbsp;needsDecoding)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(needsDecoding)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;urlEncode(urlDecode(element).toLowerCase(Locale.ENGLISH));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;element.toLowerCase(Locale.ENGLISH);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;path;&nbsp;//&nbsp;uri&nbsp;encoded<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;normalizedPath;&nbsp;//&nbsp;uri&nbsp;encoded<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;size;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;empty&nbsp;resource&nbsp;name&nbsp;whose&nbsp;string&nbsp;representation&nbsp;is&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;empty&nbsp;string&nbsp;and&nbsp;which&nbsp;has&nbsp;zero&nbsp;path&nbsp;elements.&nbsp;This&nbsp;method&nbsp;is&nbsp;provided&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;order&nbsp;to&nbsp;comply&nbsp;with&nbsp;the&nbsp;Java&nbsp;Collections&nbsp;Framework&nbsp;recommendations.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;However,&nbsp;it&nbsp;is&nbsp;recommended&nbsp;that&nbsp;applications&nbsp;use&nbsp;{@link&nbsp;#empty()}&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;order&nbsp;to&nbsp;avoid&nbsp;unnecessary&nbsp;memory&nbsp;allocation.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.path&nbsp;=&nbsp;this.normalizedPath&nbsp;=&nbsp;&amp;quot;&amp;quot;;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.size&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;having&nbsp;the&nbsp;provided&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pathElements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;unencoded&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName(final&nbsp;Collection&amp;lt;?&nbsp;extends&nbsp;Object&amp;gt;&nbsp;pathElements)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;pathBuilder&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;normalizedPathBuilder&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(final&nbsp;Object&nbsp;element&nbsp;:&nbsp;pathElements)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;element.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathBuilder.append('/');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizedPathBuilder.append('/');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;encodedPathElement&nbsp;=&nbsp;urlEncode(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pathBuilder.append(encodedPathElement);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;normalizedPathElement&nbsp;=&nbsp;normalizePathElement(s,&nbsp;false);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizedPathBuilder.append(urlEncode(normalizedPathElement));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.path&nbsp;=&nbsp;pathBuilder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.normalizedPath&nbsp;=&nbsp;normalizedPathBuilder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.size&nbsp;=&nbsp;pathElements.size();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;having&nbsp;the&nbsp;provided&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pathElements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;unencoded&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName(final&nbsp;Object...&nbsp;pathElements)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(asList(pathElements));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ResourceName(final&nbsp;String&nbsp;path,&nbsp;final&nbsp;String&nbsp;normalizedPath,&nbsp;final&nbsp;int&nbsp;size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.path&nbsp;=&nbsp;path;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.normalizedPath&nbsp;=&nbsp;normalizedPath;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.size&nbsp;=&nbsp;size;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;child&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.&nbsp;The<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;returned&nbsp;resource&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;same&nbsp;path&nbsp;elements&nbsp;as&nbsp;this&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;name&nbsp;and,&nbsp;in&nbsp;addition,&nbsp;the&nbsp;provided&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;pathElement<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;unencoded&nbsp;child&nbsp;path&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;child&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;child(final&nbsp;Object&nbsp;pathElement)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;s&nbsp;=&nbsp;pathElement.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;encodedPathElement&nbsp;=&nbsp;urlEncode(s);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;normalizedPathElement&nbsp;=&nbsp;normalizePathElement(s,&nbsp;false);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;normalizedEncodedPathElement&nbsp;=&nbsp;urlEncode(normalizedPathElement);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(encodedPathElement,&nbsp;normalizedEncodedPathElement,&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newPath&nbsp;=&nbsp;path&nbsp;+&nbsp;&amp;quot;/&amp;quot;&nbsp;+&nbsp;encodedPathElement;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newNormalizedPath&nbsp;=&nbsp;normalizedPath&nbsp;+&nbsp;&amp;quot;/&amp;quot;&nbsp;+&nbsp;normalizedEncodedPathElement;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(newPath,&nbsp;newNormalizedPath,&nbsp;size&nbsp;+&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Compares&nbsp;this&nbsp;resource&nbsp;name&nbsp;with&nbsp;the&nbsp;provided&nbsp;resource&nbsp;name.&nbsp;Resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;names&nbsp;are&nbsp;compared&nbsp;case&nbsp;sensitively&nbsp;and&nbsp;ancestors&nbsp;sort&nbsp;before<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;descendants.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;o<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@inheritDoc}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;compareTo(final&nbsp;ResourceName&nbsp;o)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;normalizedPath.compareTo(o.normalizedPath);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;descendant&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;returned&nbsp;resource&nbsp;name&nbsp;will&nbsp;have&nbsp;be&nbsp;formed&nbsp;of&nbsp;the&nbsp;concatenation&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;resource&nbsp;name&nbsp;and&nbsp;the&nbsp;provided&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;suffix<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resource&nbsp;name&nbsp;to&nbsp;be&nbsp;appended&nbsp;to&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;descendant&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;concat(final&nbsp;ResourceName&nbsp;suffix)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;suffix;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(suffix.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newPath&nbsp;=&nbsp;path&nbsp;+&nbsp;&amp;quot;/&amp;quot;&nbsp;+&nbsp;suffix.path;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newNormalizedPath&nbsp;=&nbsp;normalizedPath&nbsp;+&nbsp;&amp;quot;/&amp;quot;&nbsp;+&nbsp;suffix.normalizedPath;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(newPath,&nbsp;newNormalizedPath,&nbsp;size&nbsp;+&nbsp;suffix.size);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;descendant&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;returned&nbsp;resource&nbsp;name&nbsp;will&nbsp;have&nbsp;be&nbsp;formed&nbsp;of&nbsp;the&nbsp;concatenation&nbsp;of<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;resource&nbsp;name&nbsp;and&nbsp;the&nbsp;provided&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;suffix<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resource&nbsp;name&nbsp;to&nbsp;be&nbsp;appended&nbsp;to&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;new&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;descendant&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;the&nbsp;suffix&nbsp;contains&nbsp;empty&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;concat(final&nbsp;String&nbsp;suffix)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;concat(valueOf(suffix));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;{@code&nbsp;obj}&nbsp;is&nbsp;a&nbsp;resource&nbsp;name&nbsp;having&nbsp;the&nbsp;exact<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;same&nbsp;elements&nbsp;as&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;obj<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;to&nbsp;be&nbsp;compared.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;{@code&nbsp;obj}&nbsp;is&nbsp;a&nbsp;resource&nbsp;name&nbsp;having&nbsp;the&nbsp;exact<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same&nbsp;elements&nbsp;as&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;equals(final&nbsp;Object&nbsp;obj)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this&nbsp;==&nbsp;obj)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(obj&nbsp;instanceof&nbsp;ResourceName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;normalizedPath.equals(((ResourceName)&nbsp;obj).normalizedPath);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;path&nbsp;element&nbsp;at&nbsp;the&nbsp;specified&nbsp;position&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;path&nbsp;element&nbsp;at&nbsp;position&nbsp;0&nbsp;is&nbsp;the&nbsp;top&nbsp;level&nbsp;element&nbsp;(closest&nbsp;to<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;root).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;index<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;index&nbsp;of&nbsp;the&nbsp;path&nbsp;element&nbsp;to&nbsp;be&nbsp;returned,&nbsp;where&nbsp;0&nbsp;is&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top&nbsp;level&nbsp;element.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;path&nbsp;element&nbsp;at&nbsp;the&nbsp;specified&nbsp;position&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IndexOutOfBoundsException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;(index&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;index&nbsp;&amp;gt;=&nbsp;size()).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;get(final&nbsp;int&nbsp;index)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(index&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;index&nbsp;&amp;gt;=&nbsp;size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;startIndex&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;endIndex&nbsp;=&nbsp;nextElementEndIndex(path,&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;index;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startIndex&nbsp;=&nbsp;endIndex&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endIndex&nbsp;=&nbsp;nextElementEndIndex(path,&nbsp;startIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;urlDecode(path.substring(startIndex,&nbsp;endIndex));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;hash&nbsp;code&nbsp;for&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;hash&nbsp;code&nbsp;for&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;hashCode()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;normalizedPath.hashCode();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name&nbsp;beginning&nbsp;with&nbsp;the&nbsp;first&nbsp;element&nbsp;(0)&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;ending&nbsp;with&nbsp;the&nbsp;element&nbsp;at&nbsp;position&nbsp;{@code&nbsp;endIndex-1}.&nbsp;The&nbsp;returned<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;resource&nbsp;name&nbsp;will&nbsp;therefore&nbsp;have&nbsp;the&nbsp;size&nbsp;{@code&nbsp;endIndex}.&nbsp;Calling&nbsp;this<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;subSequence(0,&nbsp;endIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;endIndex<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;end&nbsp;index,&nbsp;exclusive.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IndexOutOfBoundsException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;{@code&nbsp;endIndex}&nbsp;is&nbsp;bigger&nbsp;than&nbsp;{@code&nbsp;size()}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;head(final&nbsp;int&nbsp;endIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;subSequence(0,&nbsp;endIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;isEmpty()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;size&nbsp;==&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;iterator&nbsp;over&nbsp;the&nbsp;path&nbsp;elements&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.&nbsp;The<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;returned&nbsp;iterator&nbsp;will&nbsp;not&nbsp;support&nbsp;the&nbsp;{@link&nbsp;Iterator#remove()}&nbsp;method<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;and&nbsp;will&nbsp;return&nbsp;path&nbsp;elements&nbsp;starting&nbsp;with&nbsp;index&nbsp;0,&nbsp;then&nbsp;1,&nbsp;then&nbsp;2,&nbsp;etc.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;iterator&nbsp;over&nbsp;the&nbsp;path&nbsp;elements&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Iterator&amp;lt;String&amp;gt;&nbsp;iterator()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Iterator&amp;lt;String&amp;gt;()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;startIndex&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;endIndex&nbsp;=&nbsp;nextElementEndIndex(path,&nbsp;0);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;hasNext()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;startIndex&nbsp;&amp;lt;&nbsp;path.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;next()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!hasNext())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;NoSuchElementException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;element&nbsp;=&nbsp;path.substring(startIndex,&nbsp;endIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startIndex&nbsp;=&nbsp;endIndex&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endIndex&nbsp;=&nbsp;nextElementEndIndex(path,&nbsp;startIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;urlDecode(element);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;remove()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;UnsupportedOperationException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;last&nbsp;path&nbsp;element&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.&nbsp;Calling&nbsp;this&nbsp;method<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;equivalent&nbsp;to:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;resourceName.get(resourceName.size()&nbsp;-&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;last&nbsp;path&nbsp;element&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;leaf()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;get(size()&nbsp;-&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;the&nbsp;immediate&nbsp;parent&nbsp;of&nbsp;this&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;name,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;the&nbsp;immediate&nbsp;parent&nbsp;of&nbsp;this&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name,&nbsp;or&nbsp;{@code&nbsp;null}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;parent()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(size())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;0:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EMPTY;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newPath&nbsp;=&nbsp;path.substring(0,&nbsp;path.lastIndexOf('/')&nbsp;/*&nbsp;safe&nbsp;*/);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;newNormalizedPath&nbsp;=<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizedPath.substring(0,&nbsp;normalizedPath.lastIndexOf('/')&nbsp;/*&nbsp;safe&nbsp;*/);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(newPath,&nbsp;newNormalizedPath,&nbsp;size&nbsp;-&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;this&nbsp;resource&nbsp;name,&nbsp;or&nbsp;0&nbsp;if&nbsp;it&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;this&nbsp;resource&nbsp;name,&nbsp;or&nbsp;0&nbsp;if&nbsp;it&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;empty.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;int&nbsp;size()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;size;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;begins&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;resource&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;prefix<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resource&nbsp;name&nbsp;prefix.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;begins&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided&nbsp;resource&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;startsWith(final&nbsp;ResourceName&nbsp;prefix)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(size&nbsp;==&nbsp;prefix.size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;equals(prefix);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(size&nbsp;&amp;lt;&nbsp;prefix.size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(prefix.size&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;normalizedPath.startsWith(prefix.normalizedPath)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;amp;&amp;amp;&nbsp;normalizedPath.charAt(prefix.normalizedPath.length())&nbsp;==&nbsp;'/';<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;begins&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;resource&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;prefix<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;resource&nbsp;name&nbsp;prefix.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;this&nbsp;resource&nbsp;name&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;begins&nbsp;with&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided&nbsp;resource&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalArgumentException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;the&nbsp;prefix&nbsp;contains&nbsp;empty&nbsp;path&nbsp;elements.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;startsWith(final&nbsp;String&nbsp;prefix)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;startsWith(valueOf(prefix));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name&nbsp;beginning&nbsp;with&nbsp;the&nbsp;element&nbsp;at&nbsp;position<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;beginIndex}&nbsp;and&nbsp;ending&nbsp;with&nbsp;the&nbsp;element&nbsp;at&nbsp;position<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;endIndex-1}.&nbsp;The&nbsp;returned&nbsp;resource&nbsp;name&nbsp;will&nbsp;therefore&nbsp;have&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;size&nbsp;{@code&nbsp;endIndex&nbsp;-&nbsp;beginIndex}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;beginIndex<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;beginning&nbsp;index,&nbsp;inclusive.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;endIndex<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;end&nbsp;index,&nbsp;exclusive.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IndexOutOfBoundsException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;{@code&nbsp;beginIndex}&nbsp;is&nbsp;negative,&nbsp;or&nbsp;{@code&nbsp;endIndex}&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigger&nbsp;than&nbsp;{@code&nbsp;size()},&nbsp;or&nbsp;if&nbsp;{@code&nbsp;beginIndex}&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bigger&nbsp;than&nbsp;{@code&nbsp;endIndex}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;subSequence(final&nbsp;int&nbsp;beginIndex,&nbsp;final&nbsp;int&nbsp;endIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(beginIndex&nbsp;&amp;lt;&nbsp;0&nbsp;||&nbsp;endIndex&nbsp;&amp;gt;&nbsp;size&nbsp;||&nbsp;beginIndex&nbsp;&amp;gt;&nbsp;endIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfBoundsException();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(beginIndex&nbsp;==&nbsp;0&nbsp;&amp;amp;&amp;amp;&nbsp;endIndex&nbsp;==&nbsp;size)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(endIndex&nbsp;-&nbsp;beginIndex&nbsp;==&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EMPTY;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;subPath&nbsp;=&nbsp;subPath(path,&nbsp;beginIndex,&nbsp;endIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;subNormalizedPath&nbsp;=&nbsp;subPath(normalizedPath,&nbsp;beginIndex,&nbsp;endIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;ResourceName(subPath,&nbsp;subNormalizedPath,&nbsp;endIndex&nbsp;-&nbsp;beginIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name&nbsp;beginning&nbsp;with&nbsp;the&nbsp;element&nbsp;at&nbsp;position<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;beginIndex}&nbsp;and&nbsp;ending&nbsp;with&nbsp;the&nbsp;last&nbsp;element&nbsp;in&nbsp;this&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;name.&nbsp;The&nbsp;returned&nbsp;resource&nbsp;name&nbsp;will&nbsp;therefore&nbsp;have&nbsp;the&nbsp;size<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;size()&nbsp;-&nbsp;beginIndex}.&nbsp;Calling&nbsp;this&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;subSequence(beginIndex,&nbsp;size());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;beginIndex<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;beginning&nbsp;index,&nbsp;inclusive.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;resource&nbsp;name&nbsp;which&nbsp;is&nbsp;a&nbsp;subsequence&nbsp;of&nbsp;the&nbsp;path&nbsp;elements<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contained&nbsp;in&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IndexOutOfBoundsException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;{@code&nbsp;beginIndex}&nbsp;is&nbsp;negative,&nbsp;or&nbsp;if&nbsp;{@code&nbsp;beginIndex}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;bigger&nbsp;than&nbsp;{@code&nbsp;size()}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ResourceName&nbsp;tail(final&nbsp;int&nbsp;beginIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;subSequence(beginIndex,&nbsp;size);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;URL&nbsp;path&nbsp;encoded&nbsp;string&nbsp;representation&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;URL&nbsp;path&nbsp;encoded&nbsp;string&nbsp;representation&nbsp;of&nbsp;this&nbsp;resource&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@see&nbsp;#valueOf(String)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;path;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;nextElementEndIndex(final&nbsp;String&nbsp;s,&nbsp;final&nbsp;int&nbsp;startIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;int&nbsp;index&nbsp;=&nbsp;s.indexOf('/',&nbsp;startIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;index&nbsp;&amp;lt;&nbsp;0&nbsp;?&nbsp;s.length()&nbsp;:&nbsp;index;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;subPath(final&nbsp;String&nbsp;s,&nbsp;final&nbsp;int&nbsp;beginIndex,&nbsp;final&nbsp;int&nbsp;endIndex)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;startCharIndex&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;endCharIndex&nbsp;=&nbsp;nextElementEndIndex(s,&nbsp;0);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;beginIndex;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;startCharIndex&nbsp;=&nbsp;endCharIndex&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endCharIndex&nbsp;=&nbsp;nextElementEndIndex(s,&nbsp;startCharIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tmpStartCharIndex;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;beginIndex&nbsp;+&nbsp;1;&nbsp;i&nbsp;&amp;lt;&nbsp;endIndex;&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpStartCharIndex&nbsp;=&nbsp;endCharIndex&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endCharIndex&nbsp;=&nbsp;nextElementEndIndex(s,&nbsp;tmpStartCharIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s.substring(startCharIndex,&nbsp;endCharIndex);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ResourceName.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreRootContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/RootContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/RootContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/RootContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,47&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core;<br>
+<br>
+import&nbsp;java.util.UUID;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;{@link&nbsp;Context}&nbsp;which&nbsp;has&nbsp;an&nbsp;an&nbsp;ID&nbsp;but&nbsp;no&nbsp;parent.&nbsp;All&nbsp;request&nbsp;context<br>
+&nbsp;*&nbsp;chains&nbsp;are&nbsp;terminated&nbsp;by&nbsp;a&nbsp;root&nbsp;context&nbsp;as&nbsp;the&nbsp;top-most&nbsp;context.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;RootContext&nbsp;extends&nbsp;AbstractContext&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;final&nbsp;ThreadLocal&amp;lt;String&amp;gt;&nbsp;ID_CACHE&nbsp;=&nbsp;new&nbsp;ThreadLocal&amp;lt;String&amp;gt;()&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;baseId&nbsp;=&nbsp;UUID.randomUUID().toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;long&nbsp;count&nbsp;=&nbsp;0;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;String&nbsp;initialValue()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;baseId&nbsp;+&nbsp;count;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RootContext()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this(ID_CACHE.get());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RootContext(String&nbsp;id)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(id,&nbsp;&amp;quot;root&amp;quot;,&nbsp;null);&nbsp;//&nbsp;No&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/RootContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreServerContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ServerContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ServerContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ServerContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,80&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.util.Reject.checkNotNull;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.AbstractContext;<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;The&nbsp;context&nbsp;associated&nbsp;with&nbsp;a&nbsp;request&nbsp;currently&nbsp;being&nbsp;processed&nbsp;by&nbsp;a&nbsp;{@code&nbsp;Handler}<br>
+&nbsp;*&nbsp;within&nbsp;a&nbsp;server.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+//TODO&nbsp;not&nbsp;sure&nbsp;if&nbsp;this&nbsp;is&nbsp;needed?<br>
+public&nbsp;class&nbsp;ServerContext&nbsp;extends&nbsp;AbstractContext&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;server&nbsp;context&nbsp;having&nbsp;the&nbsp;provided&nbsp;parent,&nbsp;an&nbsp;ID<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;automatically&nbsp;generated&nbsp;using&nbsp;{@code&nbsp;UUID.randomUUID()},&nbsp;and&nbsp;an&nbsp;internal<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;connection&nbsp;inherited&nbsp;from&nbsp;a&nbsp;parent&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalStateException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&nbsp;was&nbsp;not&nbsp;possible&nbsp;to&nbsp;inherit&nbsp;a&nbsp;connection&nbsp;from&nbsp;a&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServerContext(final&nbsp;Context&nbsp;parent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(parent,&nbsp;&amp;quot;server&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;server&nbsp;context&nbsp;having&nbsp;the&nbsp;provided&nbsp;parent,&nbsp;an&nbsp;ID<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;automatically&nbsp;generated&nbsp;using&nbsp;{@code&nbsp;UUID.randomUUID()},&nbsp;and&nbsp;an&nbsp;internal<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;connection&nbsp;inherited&nbsp;from&nbsp;a&nbsp;parent&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;name<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;client-friendly&nbsp;name&nbsp;of&nbsp;the&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalStateException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&nbsp;was&nbsp;not&nbsp;possible&nbsp;to&nbsp;inherit&nbsp;a&nbsp;connection&nbsp;from&nbsp;a&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServerContext(final&nbsp;Context&nbsp;parent,&nbsp;final&nbsp;String&nbsp;name)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(parent,&nbsp;name);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;API&nbsp;information&nbsp;context&nbsp;having&nbsp;the&nbsp;provided&nbsp;ID,&nbsp;parent,&nbsp;and<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;an&nbsp;internal&nbsp;connection&nbsp;inherited&nbsp;from&nbsp;a&nbsp;parent&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;id<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;context&nbsp;ID.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parent&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;IllegalStateException<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&nbsp;was&nbsp;not&nbsp;possible&nbsp;to&nbsp;inherit&nbsp;a&nbsp;connection&nbsp;from&nbsp;a&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServerContext(final&nbsp;String&nbsp;id,&nbsp;final&nbsp;Context&nbsp;parent)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(id,&nbsp;&amp;quot;server&amp;quot;,&nbsp;checkNotNull(parent,&nbsp;&amp;quot;Cannot&nbsp;instantiate&nbsp;ServerContext&nbsp;with&nbsp;null&nbsp;parent&nbsp;Context&amp;quot;));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/ServerContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingAbstractUriRouterjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/AbstractUriRouter.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/AbstractUriRouter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/AbstractUriRouter.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,233&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;java.util.Set;<br>
+import&nbsp;java.util.concurrent.CopyOnWriteArraySet;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;request&nbsp;handler&nbsp;which&nbsp;routes&nbsp;requests&nbsp;using&nbsp;URI&nbsp;template&nbsp;matching&nbsp;against<br>
+&nbsp;*&nbsp;the&nbsp;request's&nbsp;resource&nbsp;name.&nbsp;Examples&nbsp;of&nbsp;valid&nbsp;URI&nbsp;templates&nbsp;include:<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;users<br>
+&nbsp;*&nbsp;users/{userId}<br>
+&nbsp;*&nbsp;users/{userId}/devices<br>
+&nbsp;*&nbsp;users/{userId}/devices/{deviceId}<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Routes&nbsp;may&nbsp;be&nbsp;added&nbsp;and&nbsp;removed&nbsp;from&nbsp;a&nbsp;router&nbsp;as&nbsp;follows:<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;RequestHandler&nbsp;users&nbsp;=&nbsp;...;<br>
+&nbsp;*&nbsp;Router&nbsp;router&nbsp;=&nbsp;new&nbsp;Router();<br>
+&nbsp;*&nbsp;Route&nbsp;r1&nbsp;=&nbsp;router.addRoute(EQUALS,&nbsp;&amp;amp;quot;users&amp;amp;quot;,&nbsp;users);<br>
+&nbsp;*&nbsp;Route&nbsp;r2&nbsp;=&nbsp;router.addRoute(EQUALS,&nbsp;&amp;amp;quot;users/{userId}&amp;amp;quot;,&nbsp;users);<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;//&nbsp;Deregister&nbsp;a&nbsp;route.<br>
+&nbsp;*&nbsp;router.removeRoute(r1,&nbsp;r2);<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;A&nbsp;request&nbsp;handler&nbsp;receiving&nbsp;a&nbsp;routed&nbsp;request&nbsp;may&nbsp;access&nbsp;the&nbsp;associated<br>
+&nbsp;*&nbsp;route's&nbsp;URI&nbsp;template&nbsp;variables&nbsp;via<br>
+&nbsp;*&nbsp;{@link&nbsp;org.forgerock.resource.core.routing.RouterContext#getUriTemplateVariables()}.&nbsp;For&nbsp;example,&nbsp;a&nbsp;request<br>
+&nbsp;*&nbsp;handler&nbsp;processing&nbsp;requests&nbsp;for&nbsp;the&nbsp;route&nbsp;users/{userId}&nbsp;may&nbsp;obtain&nbsp;the&nbsp;value<br>
+&nbsp;*&nbsp;of&nbsp;{@code&nbsp;userId}&nbsp;as&nbsp;follows:<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;&amp;lt;pre&amp;gt;<br>
+&nbsp;*&nbsp;String&nbsp;userId&nbsp;=&nbsp;context.asContext(RouterContext.class).getUriTemplateVariables().get(&amp;amp;quot;userId&amp;amp;quot;);<br>
+&nbsp;*&nbsp;&amp;lt;/pre&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;During&nbsp;routing&nbsp;resource&nbsp;names&nbsp;are&nbsp;&amp;quot;relativized&amp;quot;&nbsp;by&nbsp;removing&nbsp;the&nbsp;leading&nbsp;path<br>
+&nbsp;*&nbsp;components&nbsp;which&nbsp;matched&nbsp;the&nbsp;template.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for<br>
+&nbsp;*&nbsp;{@link&nbsp;org.forgerock.resource.core.routing.RouterContext}&nbsp;for&nbsp;more&nbsp;information.<br>
+&nbsp;*&nbsp;&amp;lt;p&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;b&amp;gt;NOTE:&amp;lt;/b&amp;gt;&nbsp;for&nbsp;simplicity&nbsp;this&nbsp;implementation&nbsp;only&nbsp;supports&nbsp;a&nbsp;small&nbsp;sub-set<br>
+&nbsp;*&nbsp;of&nbsp;the&nbsp;functionality&nbsp;described&nbsp;in&nbsp;RFC&nbsp;6570.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;RouterContext<br>
+&nbsp;*&nbsp;@see&nbsp;&amp;lt;a&nbsp;href=&amp;quot;http://tools.ietf.org/html/rfc6570&amp;quot;&amp;gt;RFC&nbsp;6570&nbsp;-&nbsp;URI&nbsp;Template&amp;lt;/a&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;T&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;router.<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;H&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;handler&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;handle&nbsp;routing&nbsp;requests.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;abstract&nbsp;class&nbsp;AbstractUriRouter&amp;lt;T&nbsp;extends&nbsp;AbstractUriRouter&amp;lt;T,&nbsp;H&amp;gt;,&nbsp;H&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;volatile&nbsp;H&nbsp;defaultRoute&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Set&amp;lt;UriRoute&amp;lt;H&amp;gt;&amp;gt;&nbsp;routes&nbsp;=&nbsp;new&nbsp;CopyOnWriteArraySet&amp;lt;UriRoute&amp;lt;H&amp;gt;&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;router&nbsp;with&nbsp;no&nbsp;routes&nbsp;defined.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;AbstractUriRouter()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Nothing&nbsp;to&nbsp;do.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;router&nbsp;containing&nbsp;the&nbsp;same&nbsp;routes&nbsp;and&nbsp;default&nbsp;route&nbsp;as&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;provided&nbsp;router.&nbsp;Changes&nbsp;to&nbsp;the&nbsp;returned&nbsp;router's&nbsp;routing&nbsp;table&nbsp;will&nbsp;not<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;impact&nbsp;the&nbsp;provided&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;router<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;router&nbsp;to&nbsp;be&nbsp;copied.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;AbstractUriRouter(AbstractUriRouter&amp;lt;T,&nbsp;H&amp;gt;&nbsp;router)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultRoute&nbsp;=&nbsp;router.defaultRoute;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.routes.addAll(router.routes);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;this&nbsp;{@code&nbsp;AbstractUriRouter}&nbsp;instance,&nbsp;typed&nbsp;correctly.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;{@code&nbsp;AbstractUriRouter}&nbsp;instance.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;abstract&nbsp;T&nbsp;getThis();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;all&nbsp;registered&nbsp;routes&nbsp;on&nbsp;this&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;All&nbsp;registered&nbsp;routes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Set&amp;lt;UriRoute&amp;lt;H&amp;gt;&amp;gt;&nbsp;getRoutes()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;routes;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;all&nbsp;of&nbsp;the&nbsp;routes&nbsp;defined&nbsp;in&nbsp;the&nbsp;provided&nbsp;router&nbsp;to&nbsp;this&nbsp;router.&nbsp;New<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;routes&nbsp;may&nbsp;be&nbsp;added&nbsp;while&nbsp;this&nbsp;router&nbsp;is&nbsp;processing&nbsp;requests.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;router<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;router&nbsp;whose&nbsp;routes&nbsp;are&nbsp;to&nbsp;be&nbsp;copied&nbsp;into&nbsp;this&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;T&nbsp;addAllRoutes(T&nbsp;router)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this&nbsp;!=&nbsp;router)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routes.addAll(router.getRoutes());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getThis();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Adds&nbsp;a&nbsp;new&nbsp;route&nbsp;to&nbsp;this&nbsp;router&nbsp;for&nbsp;the&nbsp;provided&nbsp;request&nbsp;handler.&nbsp;New<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;routes&nbsp;may&nbsp;be&nbsp;added&nbsp;while&nbsp;this&nbsp;router&nbsp;is&nbsp;processing&nbsp;requests.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;mode<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indicates&nbsp;how&nbsp;the&nbsp;URI&nbsp;template&nbsp;should&nbsp;be&nbsp;matched&nbsp;against<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resource&nbsp;names.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uriTemplate<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;URI&nbsp;template&nbsp;which&nbsp;request&nbsp;resource&nbsp;names&nbsp;must&nbsp;match.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;handler<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;handler&nbsp;to&nbsp;which&nbsp;matching&nbsp;requests&nbsp;will&nbsp;be&nbsp;routed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;An&nbsp;opaque&nbsp;handle&nbsp;for&nbsp;the&nbsp;route&nbsp;which&nbsp;may&nbsp;be&nbsp;used&nbsp;for&nbsp;removing&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;route&nbsp;later.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;UriRoute&amp;lt;H&amp;gt;&nbsp;addRoute(RoutingMode&nbsp;mode,&nbsp;String&nbsp;uriTemplate,&nbsp;H&nbsp;handler)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;addRoute(new&nbsp;UriRoute&amp;lt;H&amp;gt;(mode,&nbsp;uriTemplate,&nbsp;handler));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;handler&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;the&nbsp;default&nbsp;route&nbsp;for&nbsp;requests<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;which&nbsp;do&nbsp;not&nbsp;match&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;defined&nbsp;routes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;handler&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;the&nbsp;default&nbsp;route.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;H&nbsp;getDefaultRoute()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;defaultRoute;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;all&nbsp;of&nbsp;the&nbsp;routes&nbsp;from&nbsp;this&nbsp;router.&nbsp;Routes&nbsp;may&nbsp;be&nbsp;removed&nbsp;while<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;router&nbsp;is&nbsp;processing&nbsp;requests.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;T&nbsp;removeAllRoutes()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routes.clear();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getThis();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Removes&nbsp;one&nbsp;or&nbsp;more&nbsp;routes&nbsp;from&nbsp;this&nbsp;router.&nbsp;Routes&nbsp;may&nbsp;be&nbsp;removed&nbsp;while<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;this&nbsp;router&nbsp;is&nbsp;processing&nbsp;requests.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;routes<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;routes&nbsp;to&nbsp;be&nbsp;removed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;{@code&nbsp;true}&nbsp;if&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;the&nbsp;routes&nbsp;was&nbsp;found&nbsp;and&nbsp;removed.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;boolean&nbsp;removeRoute(UriRoute&amp;lt;H&amp;gt;...&nbsp;routes)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isModified&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(UriRoute&nbsp;route&nbsp;:&nbsp;routes)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isModified&nbsp;|=&nbsp;this.routes.remove(route);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;isModified;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Sets&nbsp;the&nbsp;handler&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;the&nbsp;default&nbsp;route&nbsp;for&nbsp;requests<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;which&nbsp;do&nbsp;not&nbsp;match&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;defined&nbsp;routes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;handler<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;handler&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;the&nbsp;default&nbsp;route.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;This&nbsp;router.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;final&nbsp;T&nbsp;setDefaultRoute(H&nbsp;handler)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.defaultRoute&nbsp;=&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;getThis();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;UriRoute&amp;lt;H&amp;gt;&nbsp;addRoute(UriRoute&amp;lt;H&amp;gt;&nbsp;route)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routes.add(route);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;route;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Finds&nbsp;the&nbsp;best&nbsp;route&nbsp;that&nbsp;matches&nbsp;the&nbsp;given&nbsp;{@code&nbsp;uri}&nbsp;based&nbsp;on&nbsp;the&nbsp;uri&nbsp;templates&nbsp;of&nbsp;the&nbsp;registered&nbsp;routes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;no&nbsp;registered&nbsp;route&nbsp;matches&nbsp;at&nbsp;all&nbsp;then&nbsp;the&nbsp;default&nbsp;route&nbsp;is&nbsp;chosen,&nbsp;if&nbsp;present.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;context&nbsp;The&nbsp;request&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uri&nbsp;The&nbsp;request&nbsp;uri&nbsp;to&nbsp;be&nbsp;matched&nbsp;against&nbsp;the&nbsp;registered&nbsp;routes.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;A&nbsp;{@code&nbsp;RouteMatcher}&nbsp;containing&nbsp;the&nbsp;{@code&nbsp;UriRoute}&nbsp;which&nbsp;is&nbsp;the&nbsp;best&nbsp;match&nbsp;for&nbsp;the&nbsp;given&nbsp;{@code&nbsp;uri}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@throws&nbsp;RouteNotFoundException&nbsp;If&nbsp;no&nbsp;route&nbsp;matched&nbsp;the&nbsp;given&nbsp;{@code&nbsp;uri}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;final&nbsp;RouteMatcher&amp;lt;H&amp;gt;&nbsp;getBestRoute(Context&nbsp;context,&nbsp;String&nbsp;uri)&nbsp;throws&nbsp;RouteNotFoundException&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher&amp;lt;H&amp;gt;&nbsp;bestMatcher&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(UriRoute&amp;lt;H&amp;gt;&nbsp;route&nbsp;:&nbsp;routes)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher&amp;lt;H&amp;gt;&nbsp;matcher&nbsp;=&nbsp;route.getRouteMatcher(context,&nbsp;uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(matcher&nbsp;!=&nbsp;null&nbsp;&amp;amp;&amp;amp;&nbsp;matcher.isBetterMatchThan(bestMatcher))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bestMatcher&nbsp;=&nbsp;matcher;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bestMatcher&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;bestMatcher;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;handler&nbsp;=&nbsp;defaultRoute;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Passing&nbsp;the&nbsp;resourceName&nbsp;through&nbsp;explicitly&nbsp;means&nbsp;if&nbsp;an&nbsp;incorrect&nbsp;version&nbsp;was&nbsp;requested&nbsp;the&nbsp;error&nbsp;returned<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;specific&nbsp;to&nbsp;the&nbsp;endpoint&nbsp;requested.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(handler&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;RouteMatcher&amp;lt;H&amp;gt;(context,&nbsp;uri,&nbsp;handler);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;TODO:&nbsp;i18n<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;RouteNotFoundException(String.format(&amp;quot;Resource&nbsp;'%s'&nbsp;not&nbsp;found&amp;quot;,&nbsp;uri));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/AbstractUriRouter.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouteMatcherjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteMatcher.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteMatcher.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteMatcher.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,93&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;java.util.Collections;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.ServerContext;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;opaque&nbsp;handle&nbsp;for&nbsp;a&nbsp;route&nbsp;which&nbsp;has&nbsp;been&nbsp;registered&nbsp;in&nbsp;a&nbsp;{@link&nbsp;AbstractUriRouter<br>
+&nbsp;*&nbsp;router}.&nbsp;A&nbsp;reference&nbsp;to&nbsp;a&nbsp;route&nbsp;should&nbsp;be&nbsp;maintained&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;chance<br>
+&nbsp;*&nbsp;that&nbsp;the&nbsp;route&nbsp;will&nbsp;need&nbsp;to&nbsp;be&nbsp;removed&nbsp;from&nbsp;the&nbsp;router&nbsp;at&nbsp;a&nbsp;later&nbsp;time.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;AbstractUriRouter<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;H&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;handler&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;handle&nbsp;routing&nbsp;requests.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;RouteMatcher&amp;lt;H&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;RouterContext&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;match;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;remaining;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;UriRoute&amp;lt;H&amp;gt;&nbsp;route;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;H&nbsp;handler;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Constructor&nbsp;for&nbsp;default&nbsp;route.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher(Context&nbsp;context,&nbsp;String&nbsp;remaining,&nbsp;H&nbsp;handler)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.route&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.match&nbsp;=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remaining&nbsp;=&nbsp;remaining;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.context&nbsp;=&nbsp;new&nbsp;RouterContext(context,&nbsp;&amp;quot;&amp;quot;,&nbsp;Collections.&amp;lt;String,&nbsp;String&amp;gt;&nbsp;emptyMap());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.handler&nbsp;=&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Constructor&nbsp;for&nbsp;matching&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher(UriRoute&amp;lt;H&amp;gt;&nbsp;route,&nbsp;String&nbsp;match,&nbsp;String&nbsp;remaining,&nbsp;RouterContext&nbsp;context,&nbsp;H&nbsp;handler)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.route&nbsp;=&nbsp;route;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.match&nbsp;=&nbsp;match;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.remaining&nbsp;=&nbsp;remaining;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.context&nbsp;=&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.handler&nbsp;=&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getRemaining()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remaining;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ServerContext&nbsp;getContext()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;H&nbsp;getHandler()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isBetterMatchThan(RouteMatcher&nbsp;matcher)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(matcher&nbsp;==&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!match.equals(matcher.match))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;One&nbsp;template&nbsp;matched&nbsp;a&nbsp;greater&nbsp;proportion&nbsp;of&nbsp;the&nbsp;resource<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;name&nbsp;than&nbsp;the&nbsp;other.&nbsp;Use&nbsp;the&nbsp;template&nbsp;which&nbsp;matched&nbsp;the&nbsp;most.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;match.length()&nbsp;&amp;gt;&nbsp;matcher.match.length();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(route.getMode()&nbsp;!=&nbsp;matcher.route.getMode())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Prefer&nbsp;equality&nbsp;match&nbsp;over&nbsp;startsWith&nbsp;match.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;route.getMode()&nbsp;==&nbsp;RoutingMode.EQUALS;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Prefer&nbsp;a&nbsp;match&nbsp;with&nbsp;less&nbsp;variables.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;context.getUriTemplateVariables().size()&nbsp;&amp;lt;&nbsp;matcher.context<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getUriTemplateVariables().size();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;boolean&nbsp;wasRouted()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;remaining&nbsp;!=&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteMatcher.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouteNotFoundExceptionjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteNotFoundException.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteNotFoundException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteNotFoundException.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,37&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;java.io.IOException;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;exception&nbsp;that&nbsp;is&nbsp;thrown&nbsp;when&nbsp;a&nbsp;route&nbsp;to&nbsp;a&nbsp;specified&nbsp;URI&nbsp;cannot&nbsp;be&nbsp;found.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;class&nbsp;RouteNotFoundException&nbsp;extends&nbsp;IOException&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Constructs&nbsp;a&nbsp;new&nbsp;exception&nbsp;with&nbsp;the&nbsp;specified&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;message<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;detail&nbsp;message.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RouteNotFoundException(final&nbsp;String&nbsp;message)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(message);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouteNotFoundException.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRouterContextjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouterContext.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouterContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouterContext.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,113&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.util.Reject.checkNotNull;<br>
+<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.Map;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.forgerock.resource.core.ServerContext;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;A&nbsp;{@link&nbsp;org.forgerock.resource.core.Context}&nbsp;which&nbsp;is&nbsp;created&nbsp;when&nbsp;a&nbsp;request&nbsp;has&nbsp;been&nbsp;routed.&nbsp;The<br>
+&nbsp;*&nbsp;context&nbsp;includes:<br>
+&nbsp;*&nbsp;&amp;lt;ul&amp;gt;<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;request&nbsp;URI&nbsp;which&nbsp;matched&nbsp;the&nbsp;URI&nbsp;template<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;a&nbsp;method&nbsp;for&nbsp;obtaining&nbsp;the&nbsp;base&nbsp;URI,&nbsp;which&nbsp;represents&nbsp;the&nbsp;portion&nbsp;of&nbsp;the<br>
+&nbsp;*&nbsp;request&nbsp;URI&nbsp;which&nbsp;has&nbsp;been&nbsp;routed&nbsp;so&nbsp;far.&nbsp;This&nbsp;is&nbsp;obtained&nbsp;dynamically&nbsp;by<br>
+&nbsp;*&nbsp;concatenating&nbsp;the&nbsp;matched&nbsp;URI&nbsp;with&nbsp;matched&nbsp;URIs&nbsp;in&nbsp;parent&nbsp;router&nbsp;contexts<br>
+&nbsp;*&nbsp;&amp;lt;li&amp;gt;a&nbsp;map&nbsp;which&nbsp;contains&nbsp;the&nbsp;parsed&nbsp;URI&nbsp;template&nbsp;variables,&nbsp;keyed&nbsp;on&nbsp;the&nbsp;URI<br>
+&nbsp;*&nbsp;template&nbsp;variable&nbsp;name.<br>
+&nbsp;*&nbsp;&amp;lt;/ul&amp;gt;<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;RouterContext&nbsp;extends&nbsp;ServerContext&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;matchedUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;uriTemplateVariables;<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Creates&nbsp;a&nbsp;new&nbsp;routing&nbsp;context&nbsp;having&nbsp;the&nbsp;provided&nbsp;parent,&nbsp;URI&nbsp;template<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;variables,&nbsp;and&nbsp;an&nbsp;ID&nbsp;automatically&nbsp;generated&nbsp;using<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;UUID.randomUUID()}.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;parent<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;parent&nbsp;server&nbsp;context.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;uriTemplateVariables<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;{@code&nbsp;Map}&nbsp;containing&nbsp;the&nbsp;parsed&nbsp;URI&nbsp;template&nbsp;variables,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyed&nbsp;on&nbsp;the&nbsp;URI&nbsp;template&nbsp;variable&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;RouterContext(final&nbsp;Context&nbsp;parent,&nbsp;final&nbsp;String&nbsp;matchedUri,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;uriTemplateVariables)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(checkNotNull(parent,&nbsp;&amp;quot;Cannot&nbsp;instantiate&nbsp;RouterContext&nbsp;with&nbsp;null&nbsp;parent&nbsp;Context&amp;quot;),&nbsp;&amp;quot;router&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.matchedUri&nbsp;=&nbsp;matchedUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uriTemplateVariables&nbsp;=&nbsp;Collections.unmodifiableMap(uriTemplateVariables);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;request&nbsp;URI&nbsp;which&nbsp;has&nbsp;been&nbsp;routed&nbsp;so&nbsp;far.&nbsp;This<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;is&nbsp;obtained&nbsp;dynamically&nbsp;by&nbsp;concatenating&nbsp;the&nbsp;matched&nbsp;URI&nbsp;with&nbsp;the&nbsp;base<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;URI&nbsp;of&nbsp;the&nbsp;parent&nbsp;router&nbsp;context&nbsp;if&nbsp;present.&nbsp;The&nbsp;base&nbsp;URI&nbsp;is&nbsp;never<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{@code&nbsp;null}&nbsp;but&nbsp;may&nbsp;be&nbsp;&amp;quot;&amp;quot;&nbsp;(empty&nbsp;string).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;non-{@code&nbsp;null}&nbsp;portion&nbsp;of&nbsp;the&nbsp;request&nbsp;URI&nbsp;which&nbsp;has&nbsp;been<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;routed&nbsp;so&nbsp;far.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getBaseUri()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Context&nbsp;parent&nbsp;=&nbsp;getParent();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(parent.containsContext(RouterContext.class))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;baseUri&nbsp;=&nbsp;parent.asContext(RouterContext.class).getBaseUri();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(baseUri.length()&nbsp;&amp;gt;&nbsp;1)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(baseUri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;matchedUri&nbsp;=&nbsp;getMatchedUri();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(matchedUri.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(builder.length()&nbsp;&amp;gt;&nbsp;0)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append('/');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(matchedUri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;builder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;request&nbsp;URI&nbsp;which&nbsp;matched&nbsp;the&nbsp;URI&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;matched&nbsp;URI&nbsp;is&nbsp;never&nbsp;{@code&nbsp;null}&nbsp;but&nbsp;may&nbsp;be&nbsp;&amp;quot;&amp;quot;&nbsp;(empty&nbsp;string).<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;non-{@code&nbsp;null}&nbsp;portion&nbsp;of&nbsp;the&nbsp;request&nbsp;URI&nbsp;which&nbsp;matched&nbsp;the<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getMatchedUri()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;matchedUri;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;an&nbsp;unmodifiable&nbsp;{@code&nbsp;Map}&nbsp;containing&nbsp;the&nbsp;parsed&nbsp;URI&nbsp;template<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;variables,&nbsp;keyed&nbsp;on&nbsp;the&nbsp;URI&nbsp;template&nbsp;variable&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;The&nbsp;unmodifiable&nbsp;{@code&nbsp;Map}&nbsp;containing&nbsp;the&nbsp;parsed&nbsp;URI&nbsp;template<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variables,&nbsp;keyed&nbsp;on&nbsp;the&nbsp;URI&nbsp;template&nbsp;variable&nbsp;name.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;getUriTemplateVariables()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uriTemplateVariables;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RouterContext.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingRoutingModejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RoutingMode.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RoutingMode.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RoutingMode.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,38&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;The&nbsp;algorithm&nbsp;which&nbsp;should&nbsp;be&nbsp;used&nbsp;when&nbsp;matching&nbsp;URI&nbsp;templates&nbsp;against<br>
+&nbsp;*&nbsp;request&nbsp;resource&nbsp;names.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;enum&nbsp;RoutingMode&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;URI&nbsp;template&nbsp;must&nbsp;exactly&nbsp;match&nbsp;a&nbsp;request's&nbsp;resource&nbsp;name&nbsp;in&nbsp;order<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;for&nbsp;the&nbsp;route&nbsp;to&nbsp;be&nbsp;selected.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;EQUALS,<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;/**<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;URI&nbsp;template&nbsp;must&nbsp;match&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;request's&nbsp;resource&nbsp;name&nbsp;in<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;order&nbsp;for&nbsp;the&nbsp;route&nbsp;to&nbsp;be&nbsp;selected.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;STARTS_WITH<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/RoutingMode.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrcmainjavaorgforgerockresourcecoreroutingUriRoutejava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/UriRoute.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/UriRoute.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/UriRoute.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,180&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2012-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;static&nbsp;org.forgerock.resource.core.ResourceName.urlDecode;<br>
+import&nbsp;static&nbsp;org.forgerock.resource.core.routing.RoutingMode.EQUALS;<br>
+import&nbsp;static&nbsp;org.forgerock.resource.core.routing.RoutingMode.STARTS_WITH;<br>
+<br>
+import&nbsp;java.util.Collections;<br>
+import&nbsp;java.util.LinkedHashMap;<br>
+import&nbsp;java.util.LinkedList;<br>
+import&nbsp;java.util.List;<br>
+import&nbsp;java.util.Map;<br>
+import&nbsp;java.util.regex.Matcher;<br>
+import&nbsp;java.util.regex.Pattern;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;An&nbsp;opaque&nbsp;handle&nbsp;for&nbsp;a&nbsp;route&nbsp;which&nbsp;has&nbsp;been&nbsp;registered&nbsp;in&nbsp;a&nbsp;{@link&nbsp;AbstractUriRouter<br>
+&nbsp;*&nbsp;router}.&nbsp;A&nbsp;reference&nbsp;to&nbsp;a&nbsp;route&nbsp;should&nbsp;be&nbsp;maintained&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;chance<br>
+&nbsp;*&nbsp;that&nbsp;the&nbsp;route&nbsp;will&nbsp;need&nbsp;to&nbsp;be&nbsp;removed&nbsp;from&nbsp;the&nbsp;router&nbsp;at&nbsp;a&nbsp;later&nbsp;time.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@see&nbsp;AbstractUriRouter<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@param&nbsp;&amp;lt;H&amp;gt;&nbsp;The&nbsp;type&nbsp;of&nbsp;the&nbsp;handler&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;handle&nbsp;routing&nbsp;requests.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;@since&nbsp;1.0.0<br>
+&nbsp;*/<br>
+public&nbsp;final&nbsp;class&nbsp;UriRoute&amp;lt;H&amp;gt;&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;H&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;RoutingMode&nbsp;mode;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;Pattern&nbsp;regex;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;String&nbsp;uriTemplate;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;List&amp;lt;String&amp;gt;&nbsp;variables&nbsp;=&nbsp;new&nbsp;LinkedList&amp;lt;String&amp;gt;();<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;UriRoute(RoutingMode&nbsp;mode,&nbsp;String&nbsp;uriTemplate,&nbsp;H&nbsp;handler)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.handler&nbsp;=&nbsp;handler;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;t&nbsp;=&nbsp;removeTrailingSlash(removeLeadingSlash(uriTemplate));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder(t.length()&nbsp;+&nbsp;8);<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Parse&nbsp;the&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;isInVariable&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;elementStart&nbsp;=&nbsp;0;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append('(');&nbsp;//&nbsp;Group&nbsp;1&nbsp;does&nbsp;not&nbsp;include&nbsp;trailing&nbsp;portion&nbsp;for&nbsp;STARTS_WITH.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;t.length();&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;c&nbsp;=&nbsp;t.charAt(i);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isInVariable)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c&nbsp;==&nbsp;'}')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(elementStart&nbsp;==&nbsp;i)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;URI&nbsp;template&nbsp;&amp;quot;&nbsp;+&nbsp;t<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;&nbsp;contains&nbsp;zero-length&nbsp;template&nbsp;variable&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variables.add(t.substring(elementStart,&nbsp;i));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;([^/]+)&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isInVariable&nbsp;=&nbsp;false;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elementStart&nbsp;=&nbsp;i&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!isValidVariableCharacter(c))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;URI&nbsp;template&nbsp;&amp;quot;&nbsp;+&nbsp;t<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;&nbsp;contains&nbsp;an&nbsp;illegal&nbsp;character&nbsp;&amp;quot;&nbsp;+&nbsp;c&nbsp;+&nbsp;&amp;quot;&nbsp;in&nbsp;a&nbsp;template&nbsp;variable&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Continue&nbsp;counting&nbsp;characters&nbsp;in&nbsp;variable.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(c&nbsp;==&nbsp;'{')&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Escape&nbsp;and&nbsp;add&nbsp;literal&nbsp;substring.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(Pattern.quote(t.substring(elementStart,&nbsp;i)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isInVariable&nbsp;=&nbsp;true;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elementStart&nbsp;=&nbsp;i&nbsp;+&nbsp;1;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isInVariable)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;IllegalArgumentException(&amp;quot;URI&nbsp;template&nbsp;&amp;quot;&nbsp;+&nbsp;t<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&amp;quot;&nbsp;contains&nbsp;a&nbsp;trailing&nbsp;unclosed&nbsp;variable&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Escape&nbsp;and&nbsp;add&nbsp;remaining&nbsp;literal&nbsp;substring.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(Pattern.quote(t.substring(elementStart)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(')');<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(mode&nbsp;==&nbsp;STARTS_WITH)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;wild-card&nbsp;match&nbsp;for&nbsp;remaining&nbsp;unmatched&nbsp;path.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(uriTemplate.isEmpty())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Special&nbsp;case&nbsp;for&nbsp;empty&nbsp;template:&nbsp;the&nbsp;next&nbsp;path&nbsp;element&nbsp;is<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;not&nbsp;preceded&nbsp;by&nbsp;a&nbsp;slash.&nbsp;The&nbsp;redundant&nbsp;parentheses&nbsp;are<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;required&nbsp;in&nbsp;order&nbsp;to&nbsp;have&nbsp;consistent&nbsp;group&nbsp;numbering&nbsp;with<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;non-empty&nbsp;case.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;((.*))?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;(/(.*))?&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.uriTemplate&nbsp;=&nbsp;uriTemplate;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.mode&nbsp;=&nbsp;mode;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.regex&nbsp;=&nbsp;Pattern.compile(builder.toString());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;toString()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder&nbsp;builder&nbsp;=&nbsp;new&nbsp;StringBuilder();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(mode&nbsp;==&nbsp;EQUALS)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;equals(&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(&amp;quot;startsWith(&amp;quot;);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(uriTemplate);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.append(')');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;builder.toString();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher&amp;lt;H&amp;gt;&nbsp;getRouteMatcher(Context&nbsp;context,&nbsp;String&nbsp;uri)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matcher&nbsp;matcher&nbsp;=&nbsp;regex.matcher(uri);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!matcher.matches())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;null;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Map&amp;lt;String,&nbsp;String&amp;gt;&nbsp;variableMap;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(variables.size())&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;0:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variableMap&nbsp;=&nbsp;Collections.emptyMap();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;1:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Group&nbsp;0&nbsp;matches&nbsp;entire&nbsp;URL,&nbsp;group&nbsp;1&nbsp;matches&nbsp;entire&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variableMap&nbsp;=&nbsp;Collections.singletonMap(variables.get(0),&nbsp;urlDecode(matcher.group(2)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variableMap&nbsp;=&nbsp;new&nbsp;LinkedHashMap&amp;lt;String,&nbsp;String&amp;gt;(variables.size());<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;variables.size();&nbsp;i++)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Group&nbsp;0&nbsp;matches&nbsp;entire&nbsp;URL,&nbsp;group&nbsp;1&nbsp;matches&nbsp;entire&nbsp;template.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variableMap.put(variables.get(i),&nbsp;urlDecode(matcher.group(i&nbsp;+&nbsp;2)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;remaining&nbsp;=&nbsp;removeLeadingSlash(uri.substring(matcher.end(1)));<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;matched&nbsp;=&nbsp;matcher.group(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;RouteMatcher&amp;lt;H&amp;gt;(this,&nbsp;matcher.group(1),&nbsp;remaining,&nbsp;new&nbsp;RouterContext(context,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matched,&nbsp;variableMap),&nbsp;handler);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;RoutingMode&nbsp;getMode()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mode;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;removeLeadingSlash(String&nbsp;resourceName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resourceName.startsWith(&amp;quot;/&amp;quot;))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;resourceName.substring(1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;resourceName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;removeTrailingSlash(String&nbsp;resourceName)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resourceName.endsWith(&amp;quot;/&amp;quot;))&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;resourceName.substring(0,&nbsp;resourceName.length()&nbsp;-&nbsp;1);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;resourceName;<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;As&nbsp;per&nbsp;RFC.<br>
+&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;boolean&nbsp;isValidVariableCharacter(char&nbsp;c)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;((c&nbsp;&amp;gt;=&nbsp;'a')&nbsp;&amp;amp;&amp;amp;&nbsp;(c&nbsp;&amp;lt;=&nbsp;'z'))&nbsp;||&nbsp;((c&nbsp;&amp;gt;=&nbsp;'A')&nbsp;&amp;amp;&amp;amp;&nbsp;(c&nbsp;&amp;lt;=&nbsp;'Z'))<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;((c&nbsp;&amp;gt;=&nbsp;'0')&nbsp;&amp;amp;&amp;amp;&nbsp;(c&nbsp;&amp;lt;=&nbsp;'9'))&nbsp;||&nbsp;(c&nbsp;==&nbsp;'_');<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/main/java/org/forgerock/resource/core/routing/UriRoute.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;forgerockhttpframeworktrunkresourcecoresrctestjavaorgforgerockresourcecoreroutingUriRouteTestjava&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/UriRouteTest.java&nbsp;(0&nbsp;=&gt;&nbsp;2898)&lt;/h4&gt;<br>
&lt;pre&nbsp;class=&quot;diff&quot;&gt;&lt;span&gt;<br>
&lt;span&nbsp;class=&quot;info&quot;&gt;---&nbsp;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/UriRouteTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(rev&nbsp;0)<br>
+++&nbsp;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/UriRouteTest.java&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp2015-02-04&nbsp;17:48:07&nbsp;UTC&nbsp;(rev&nbsp;2898)<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;lines&quot;&gt;@@&nbsp;-0,0&nbsp;+1,76&nbsp;@@<br>
&lt;/span&gt;&lt;ins&gt;+/*<br>
+&nbsp;*&nbsp;The&nbsp;contents&nbsp;of&nbsp;this&nbsp;file&nbsp;are&nbsp;subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;Common&nbsp;Development&nbsp;and<br>
+&nbsp;*&nbsp;Distribution&nbsp;License&nbsp;(the&nbsp;License).&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the<br>
+&nbsp;*&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;You&nbsp;can&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the<br>
+&nbsp;*&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permission&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;When&nbsp;distributing&nbsp;Covered&nbsp;Software,&nbsp;include&nbsp;this&nbsp;CDDL&nbsp;Header&nbsp;Notice&nbsp;in&nbsp;each&nbsp;file&nbsp;and&nbsp;include<br>
+&nbsp;*&nbsp;the&nbsp;License&nbsp;file&nbsp;at&nbsp;legal/CDDLv1.0.txt.&nbsp;If&nbsp;applicable,&nbsp;add&nbsp;the&nbsp;following&nbsp;below&nbsp;the&nbsp;CDDL<br>
+&nbsp;*&nbsp;Header,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;[]&nbsp;replaced&nbsp;by&nbsp;your&nbsp;own&nbsp;identifying<br>
+&nbsp;*&nbsp;information:&nbsp;&amp;quot;Portions&nbsp;copyright&nbsp;[year]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]&amp;quot;.<br>
+&nbsp;*<br>
+&nbsp;*&nbsp;Copyright&nbsp;2013-2014&nbsp;ForgeRock&nbsp;AS.<br>
+&nbsp;*/<br>
+<br>
+package&nbsp;org.forgerock.resource.core.routing;<br>
+<br>
+import&nbsp;static&nbsp;org.assertj.core.api.Assertions.assertThat;<br>
+import&nbsp;static&nbsp;org.forgerock.resource.core.routing.RoutingMode.EQUALS;<br>
+import&nbsp;static&nbsp;org.forgerock.resource.core.routing.RoutingMode.STARTS_WITH;<br>
+import&nbsp;static&nbsp;org.mockito.Mockito.mock;<br>
+<br>
+import&nbsp;org.forgerock.resource.core.Context;<br>
+import&nbsp;org.testng.annotations.DataProvider;<br>
+import&nbsp;org.testng.annotations.Test;<br>
+<br>
+/**<br>
+&nbsp;*&nbsp;Tests&nbsp;{@link&nbsp;org.forgerock.resource.core.routing.UriRoute}.<br>
+&nbsp;*/<br>
+@SuppressWarnings(&amp;quot;javadoc&amp;quot;)<br>
+public&nbsp;final&nbsp;class&nbsp;UriRouteTest&nbsp;{<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@DataProvider<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;Object[][]&nbsp;testData()&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;new&nbsp;Object[][]&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;@formatter:off<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;mode,&nbsp;template,&nbsp;resourceName,&nbsp;remaining&nbsp;*/<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;EQUALS,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;EQUALS,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;EQUALS,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;testremaining&amp;quot;,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;EQUALS,&nbsp;&amp;quot;users/{id}&amp;quot;,&nbsp;&amp;quot;users/1&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;EQUALS,&nbsp;&amp;quot;users/{id}&amp;quot;,&nbsp;&amp;quot;users/1/devices/0&amp;quot;,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;users/{id}&amp;quot;,&nbsp;&amp;quot;users/1&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;users/{id}&amp;quot;,&nbsp;&amp;quot;users/1/devices/0&amp;quot;,&nbsp;&amp;quot;devices/0&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;test/remaining&amp;quot;,&nbsp;&amp;quot;remaining&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;testremaining&amp;quot;,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;test/remaining&amp;quot;,&nbsp;&amp;quot;remaining&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;testremaining&amp;quot;,&nbsp;null&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test{suffix}&amp;quot;,&nbsp;&amp;quot;testabc&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test{suffix}&amp;quot;,&nbsp;&amp;quot;testabc/&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test{suffix}&amp;quot;,&nbsp;&amp;quot;testabc/123&amp;quot;,&nbsp;&amp;quot;123&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;test&amp;quot;,&nbsp;&amp;quot;test/&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;&amp;quot;,&nbsp;&amp;quot;&amp;quot;,&nbsp;&amp;quot;&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;&amp;quot;,&nbsp;&amp;quot;123&amp;quot;,&nbsp;&amp;quot;123&amp;quot;&nbsp;},<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;STARTS_WITH,&nbsp;&amp;quot;&amp;quot;,&nbsp;&amp;quot;123/456&amp;quot;,&nbsp;&amp;quot;123/456&amp;quot;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;@formatter:on<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+<br>
+&nbsp;&nbsp;&nbsp;&nbsp;@Test(dataProvider&nbsp;=&nbsp;&amp;quot;testData&amp;quot;)<br>
+&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;testGetRouteMatcher(final&nbsp;RoutingMode&nbsp;mode,&nbsp;final&nbsp;String&nbsp;template,<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;String&nbsp;resourceName,&nbsp;final&nbsp;String&nbsp;expectedRemaining)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UriRoute&amp;lt;Void&amp;gt;&nbsp;uriRoute&nbsp;=&nbsp;new&nbsp;UriRoute&amp;lt;Void&amp;gt;(mode,&nbsp;template,&nbsp;null);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RouteMatcher&nbsp;matcher&nbsp;=&nbsp;uriRoute.getRouteMatcher(mock(Context.class),&nbsp;resourceName);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(expectedRemaining&nbsp;!=&nbsp;null)&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(matcher).isNotNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(matcher.getRemaining()).isEqualTo(expectedRemaining);<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertThat(matcher).isNull();<br>
+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+&nbsp;&nbsp;&nbsp;&nbsp;}<br>
+}<br>
&lt;/ins&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;Property&nbsp;changes&nbsp;on:&nbsp;forgerock-http-framework/trunk/resource-core/src/test/java/org/forgerock/resource/core/routing/UriRouteTest.java<br>
&lt;/span&gt;&lt;span&nbsp;class=&quot;cx&quot;&gt;___________________________________________________________________<br>
&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;<br>
&lt;a&nbsp;id=&quot;svneolstyle&quot;&gt;&lt;/a&gt;<br>
&lt;div&nbsp;class=&quot;addfile&quot;&gt;&lt;h4&gt;Added:&nbsp;svn:eol-style&lt;/h4&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;id=&quot;footer&quot;&gt;Copyright&nbsp;(c)&nbsp;by&nbsp;ForgeRock.&nbsp;All&nbsp;rights&nbsp;reserved.&lt;/div&gt;<br>
<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
