<tt>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;style&gt;<br>
/*&nbsp;Changing&nbsp;the&nbsp;layout&nbsp;to&nbsp;use&nbsp;less&nbsp;space&nbsp;for&nbsp;mobiles&nbsp;*/<br>
@media&nbsp;screen&nbsp;and&nbsp;(max-device-width:&nbsp;480px),&nbsp;screen&nbsp;and&nbsp;(-webkit-min-device-pixel-ratio:&nbsp;2)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-body&nbsp;{&nbsp;min-width:&nbsp;30em&nbsp;!important;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-page&nbsp;{&nbsp;padding:&nbsp;8px&nbsp;!important;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-banner&nbsp;{&nbsp;padding:&nbsp;8px&nbsp;8px&nbsp;0&nbsp;8px&nbsp;!important;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-avatar&nbsp;{&nbsp;margin:&nbsp;1px&nbsp;8px&nbsp;8px&nbsp;0&nbsp;!important;&nbsp;padding:&nbsp;0&nbsp;!important;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-fields&nbsp;{&nbsp;padding:&nbsp;0&nbsp;8px&nbsp;8px&nbsp;8px&nbsp;!important;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;#email-gutter&nbsp;{&nbsp;width:&nbsp;0&nbsp;!important;&nbsp;}<br>
}<br>
&lt;/style&gt;<br>
&lt;div&nbsp;id=&quot;email-body&quot;&gt;<br>
&lt;table&nbsp;id=&quot;email-wrap&quot;&nbsp;align=&quot;center&quot;&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;style=&quot;background-color:#f0f0f0;color:#000000;width:100%;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;email-page&quot;&nbsp;style=&quot;padding:16px&nbsp;!important;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;align=&quot;center&quot;&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;style=&quot;background-color:#ffffff;border:1px&nbsp;solid&nbsp;#bbbbbb;color:#000000;width:100%;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;style=&quot;background-color:#ffffff;color:#626d75;font-family:Arial,FreeSans,Helvetica,sans-serif;font-size:12px;line-height:1;&quot;&gt;&lt;img&nbsp;src=&quot;https://bugster.forgerock.org/jira/s/en_USwmww7y/731/23/_/jira-logo-scaled.png&quot;&nbsp;alt=&quot;&quot;&nbsp;style=&quot;vertical-align:top;&quot;&nbsp;/&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;email-banner&quot;&nbsp;style=&quot;padding:32px&nbsp;32px&nbsp;0&nbsp;32px;&quot;&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;align=&quot;left&quot;&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;width=&quot;100%&quot;&nbsp;style=&quot;width:100%;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;color:#505050;font-family:Arial,FreeSans,Helvetica,sans-serif;padding:0;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img&nbsp;id=&quot;email-avatar&quot;&nbsp;src=&quot;https://bugster.forgerock.org/jira/secure/useravatar?ownerId=matthew&amp;avatarId=10938&quot;&nbsp;alt=&quot;&quot;&nbsp;height=&quot;48&quot;&nbsp;width=&quot;48&quot;&nbsp;border=&quot;0&quot;&nbsp;align=&quot;left&quot;&nbsp;style=&quot;padding:0;margin:&nbsp;0&nbsp;16px&nbsp;16px&nbsp;0;&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;email-action&quot;&nbsp;style=&quot;padding:&nbsp;0&nbsp;0&nbsp;8px&nbsp;0;font-size:12px;line-height:18px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;user-hover&quot;&nbsp;rel=&quot;matthew&quot;&nbsp;id=&quot;email_matthew&quot;&nbsp;href=&quot;https://bugster.forgerock.org/jira/secure/ViewProfile.jspa?name=matthew&quot;&nbsp;style=&quot;color:#003366;&quot;&gt;Matthew&nbsp;Swift&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commented&nbsp;on&nbsp;&lt;img&nbsp;src=&quot;https://bugster.forgerock.org/jira/images/icons/newfeature.gif&quot;&nbsp;height=&quot;16&quot;&nbsp;width=&quot;16&quot;&nbsp;border=&quot;0&quot;&nbsp;align=&quot;absmiddle&quot;&nbsp;alt=&quot;New&nbsp;Feature&quot;&gt;&nbsp;&lt;a&nbsp;style='color:#003366;text-decoration:none;'&nbsp;href='https://bugster.forgerock.org/jira/browse/CREST-108'&gt;CREST-108&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;email-summary&quot;&nbsp;style=&quot;font-size:16px;line-height:20px;padding:2px&nbsp;0&nbsp;16px&nbsp;0;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;style='color:#003366;text-decoration:none;'&nbsp;href='https://bugster.forgerock.org/jira/browse/CREST-108'&gt;&lt;strong&gt;Support&nbsp;the&nbsp;ability&nbsp;to&nbsp;update&nbsp;multi-media&nbsp;resource&nbsp;content&nbsp;such&nbsp;as&nbsp;JPEGs&lt;/strong&gt;&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;email-fields&quot;&nbsp;style=&quot;padding:0&nbsp;32px&nbsp;32px&nbsp;32px;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;style=&quot;padding:0;text-align:left;width:100%;&quot;&nbsp;width=&quot;100%&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;email-gutter&quot;&nbsp;style=&quot;width:64px;white-space:nowrap;&quot;&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;width=&quot;100%&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan=&quot;2&quot;&nbsp;style=&quot;color:#000000;font-family:Arial,FreeSans,Helvetica,sans-serif;font-size:12px;padding:0&nbsp;0&nbsp;16px&nbsp;0;width:100%;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;comment-block&quot;&nbsp;style=&quot;background-color:#edf5ff;border:1px&nbsp;solid&nbsp;#dddddd;color:#000000;padding:12px;&quot;&gt;&lt;p&gt;This&nbsp;piece&nbsp;of&nbsp;code&nbsp;illustrates&nbsp;how&nbsp;Javax&nbsp;Mail&nbsp;can&nbsp;be&nbsp;used&nbsp;for&nbsp;parsing&nbsp;MIME&nbsp;content:&lt;/p&gt;<br>
<br>
&lt;div&nbsp;class=&quot;code&nbsp;panel&quot;&nbsp;style=&quot;border-width:&nbsp;1px;&quot;&gt;&lt;div&nbsp;class=&quot;codeContent&nbsp;panelContent&quot;&gt;<br>
&lt;pre&nbsp;class=&quot;code-java&quot;&gt;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&nbsp;com.example;<br>
<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;java.io.IOException;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;java.io.InputStream;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;java.io.InputStreamReader;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;java.io.OutputStream;<br>
<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.activation.DataSource;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.mail.MessagingException;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.mail.internet.ContentDisposition;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.mail.internet.MimeBodyPart;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.mail.internet.MimeMultipart;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.servlet.ServletException;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.servlet.http.HttpServlet;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.servlet.http.HttpServletRequest;<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;import&lt;/span&gt;&nbsp;javax.servlet.http.HttpServletResponse;<br>
<br>
&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;final&lt;/span&gt;&nbsp;class&nbsp;MyServlet&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt;&nbsp;HttpServlet&nbsp;{<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt;&nbsp;void&nbsp;doPost(&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;final&lt;/span&gt;&nbsp;HttpServletRequest&nbsp;req,&nbsp;HttpServletResponse&nbsp;resp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt;&nbsp;ServletException,&nbsp;IOException&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Handling&nbsp;POST&nbsp;request&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;req.getContentType());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;&nbsp;(req.getContentType().startsWith(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MimeMultipart&nbsp;parts&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;MimeMultipart(&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;DataSource()&nbsp;{<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&nbsp;OutputStream&nbsp;getOutputStream()&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt;&nbsp;IOException&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;IllegalStateException();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;String&lt;/span&gt;&nbsp;getName()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;IllegalStateException();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&nbsp;InputStream&nbsp;getInputStream()&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt;&nbsp;IOException&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;&nbsp;req.getInputStream();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;public&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;String&lt;/span&gt;&nbsp;getContentType()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;&nbsp;req.getContentType();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Matched&nbsp;form-data&nbsp;with&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;parts.getCount()&nbsp;+&nbsp;&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;&nbsp;parts&quot;&lt;/span&gt;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;&nbsp;(&lt;span&nbsp;class=&quot;code-object&quot;&gt;int&lt;/span&gt;&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;&nbsp;parts.getCount();&nbsp;i++)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Parsing&nbsp;part&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MimeBodyPart&nbsp;part&nbsp;=&nbsp;(MimeBodyPart)&nbsp;parts.getBodyPart(i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content&nbsp;type:&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;part.getContentType());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentDisposition&nbsp;disposition&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;ContentDisposition(part.getHeader(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content-Disposition&quot;&lt;/span&gt;,&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content&nbsp;disp:&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;disposition.getDisposition());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content&nbsp;name:&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;disposition.getParameter(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content&nbsp;file:&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;part.getFileName());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStreamReader&nbsp;content&nbsp;=&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;InputStreamReader(part.getInputStream());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;int&lt;/span&gt;&nbsp;length&nbsp;=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;&nbsp;(content.read()&nbsp;!=&nbsp;-1)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length++;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span&nbsp;class=&quot;code-quote&quot;&gt;&quot;Content&nbsp;length:&nbsp;&quot;&lt;/span&gt;&nbsp;+&nbsp;length);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;&nbsp;(MessagingException&nbsp;e)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt;&nbsp;&lt;span&nbsp;class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&nbsp;ServletException(e);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}&lt;/pre&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>
<br>
&lt;p&gt;Using&nbsp;the&nbsp;following&nbsp;curl&nbsp;command:&lt;/p&gt;<br>
<br>
&lt;div&nbsp;class=&quot;preformatted&nbsp;panel&quot;&nbsp;style=&quot;border-width:&nbsp;1px;&quot;&gt;&lt;div&nbsp;class=&quot;preformattedContent&nbsp;panelContent&quot;&gt;<br>
&lt;pre&gt;curl&nbsp;-X&nbsp;POST&nbsp;-F&nbsp;'json={&quot;picture&quot;:{&quot;$ref&quot;:&quot;cid:picture&quot;}};type=application/json'&nbsp;-F&nbsp;'picture=@picture.jpg;type=image/jpeg'&nbsp;'http://localhost:8080/users?_action=create'<br>
&lt;/pre&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>
<br>
&lt;p&gt;Produces&nbsp;the&nbsp;following&nbsp;output:&lt;/p&gt;<br>
<br>
&lt;div&nbsp;class=&quot;preformatted&nbsp;panel&quot;&nbsp;style=&quot;border-width:&nbsp;1px;&quot;&gt;&lt;div&nbsp;class=&quot;preformattedContent&nbsp;panelContent&quot;&gt;<br>
&lt;pre&gt;2014-02-13&nbsp;15:30:01.837:INFO:/:qtp830275683-29:&nbsp;Test:&nbsp;Handling&nbsp;POST&nbsp;request&nbsp;multipart/form-data;&nbsp;boundary=------------------------9e2d9d12345d4c29<br>
Matched&nbsp;form-data&nbsp;with&nbsp;2&nbsp;parts<br>
Parsing&nbsp;part&nbsp;0<br>
Content&nbsp;type:&nbsp;application/json<br>
Content&nbsp;disp:&nbsp;form-data<br>
Content&nbsp;name:&nbsp;json<br>
Content&nbsp;file:&nbsp;null<br>
Content&nbsp;length:&nbsp;34<br>
Parsing&nbsp;part&nbsp;1<br>
Content&nbsp;type:&nbsp;image/jpeg<br>
Content&nbsp;disp:&nbsp;form-data<br>
Content&nbsp;name:&nbsp;picture<br>
Content&nbsp;file:&nbsp;picture.jpg<br>
Content&nbsp;length:&nbsp;142053<br>
&lt;/pre&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;color:#505050;padding:4px&nbsp;0&nbsp;0&nbsp;0;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&lt;/tr&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;&lt;!--&nbsp;End&nbsp;#email-page&nbsp;--&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;valign=&quot;top&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;color:#505050;font-family:Arial,FreeSans,Helvetica,sans-serif;font-size:10px;line-height:14px;padding:&nbsp;0&nbsp;16px&nbsp;16px&nbsp;16px;text-align:center;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;message&nbsp;is&nbsp;automatically&nbsp;generated&nbsp;by&nbsp;JIRA.&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;think&nbsp;it&nbsp;was&nbsp;sent&nbsp;incorrectly,&nbsp;please&nbsp;contact&nbsp;your&nbsp;&lt;a&nbsp;style='color:#003366;'&nbsp;href='https://bugster.forgerock.org/jira/secure/ContactAdministrators!default.jspa'&gt;JIRA&nbsp;administrators&lt;/a&gt;.&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;more&nbsp;information&nbsp;on&nbsp;JIRA,&nbsp;see:&nbsp;&lt;a&nbsp;style='color:#003366;'&nbsp;href='http://www.atlassian.com/software/jira'&gt;http://www.atlassian.com/software/jira&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&lt;/table&gt;&lt;!--&nbsp;End&nbsp;#email-wrap&nbsp;--&gt;<br>
&lt;/div&gt;&lt;!--&nbsp;End&nbsp;#email-body&nbsp;--&gt;<br>

</tt>
